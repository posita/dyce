
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Simple Python tools for dice-based probabilities">
      
      
      
        <meta name="author" content="Matt Bogosian">
      
      
        <link rel="canonical" href="https://posita.github.io/dyce/0.2/dyce/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.8">
    
    
      
        <title>dyce - dyce</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ca7ac06f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.f1a3b89f.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    
      


    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
      <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dyce-package-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="dyce" class="md-header__button md-logo" aria-label="dyce" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dyce
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              <tt>dyce</tt>
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/posita/dyce/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="dyce" class="md-nav__button md-logo" aria-label="dyce" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    dyce
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/posita/dyce/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tutorial/" class="md-nav__link">
        Tutorial
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../translations/" class="md-nav__link">
        Applications & translations
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" checked>
      
      <label class="md-nav__link" for="__nav_4">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <tt>dyce</tt>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        <tt>dyce</tt>
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dyce" class="md-nav__link">
    dyce
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dyce.h.H" class="md-nav__link">
    H
  </a>
  
    <nav class="md-nav" aria-label="H">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__hash__" class="md-nav__link">
    __hash__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.accumulate" class="md-nav__link">
    accumulate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.counts" class="md-nav__link">
    counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.data" class="md-nav__link">
    data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.data_xy" class="md-nav__link">
    data_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.distribution" class="md-nav__link">
    distribution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.distribution_xy" class="md-nav__link">
    distribution_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.eq" class="md-nav__link">
    eq()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.even" class="md-nav__link">
    even()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.explode" class="md-nav__link">
    explode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.faces" class="md-nav__link">
    faces()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.format" class="md-nav__link">
    format()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.ge" class="md-nav__link">
    ge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.gt" class="md-nav__link">
    gt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.items" class="md-nav__link">
    items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.keys" class="md-nav__link">
    keys()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.le" class="md-nav__link">
    le()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.lowest_terms" class="md-nav__link">
    lowest_terms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.lt" class="md-nav__link">
    lt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.map" class="md-nav__link">
    map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.mean" class="md-nav__link">
    mean()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.ne" class="md-nav__link">
    ne()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.odd" class="md-nav__link">
    odd()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.outcomes" class="md-nav__link">
    outcomes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.roll" class="md-nav__link">
    roll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.stdev" class="md-nav__link">
    stdev()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.substitute" class="md-nav__link">
    substitute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.umap" class="md-nav__link">
    umap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.values" class="md-nav__link">
    values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.variance" class="md-nav__link">
    variance()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.vs" class="md-nav__link">
    vs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.within" class="md-nav__link">
    within()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dyce.p.P" class="md-nav__link">
    P
  </a>
  
    <nav class="md-nav" aria-label="P">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.appearances_in_rolls" class="md-nav__link">
    appearances_in_rolls()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.eq" class="md-nav__link">
    eq()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.even" class="md-nav__link">
    even()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.explode" class="md-nav__link">
    explode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.ge" class="md-nav__link">
    ge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.gt" class="md-nav__link">
    gt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.h" class="md-nav__link">
    h()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.le" class="md-nav__link">
    le()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.lt" class="md-nav__link">
    lt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.ne" class="md-nav__link">
    ne()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.odd" class="md-nav__link">
    odd()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.roll" class="md-nav__link">
    roll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.rolls_with_counts" class="md-nav__link">
    rolls_with_counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.substitute" class="md-nav__link">
    substitute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.within" class="md-nav__link">
    within()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dyce.h.HAbleT" class="md-nav__link">
    HAbleT
  </a>
  
    <nav class="md-nav" aria-label="HAbleT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleT.h" class="md-nav__link">
    h()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin" class="md-nav__link">
    HAbleBinOpsMixin
  </a>
  
    <nav class="md-nav" aria-label="HAbleBinOpsMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__and__" class="md-nav__link">
    __and__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__floordiv__" class="md-nav__link">
    __floordiv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__mod__" class="md-nav__link">
    __mod__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__mul__" class="md-nav__link">
    __mul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__or__" class="md-nav__link">
    __or__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__pow__" class="md-nav__link">
    __pow__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rand__" class="md-nav__link">
    __rand__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rfloordiv__" class="md-nav__link">
    __rfloordiv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rmod__" class="md-nav__link">
    __rmod__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rmul__" class="md-nav__link">
    __rmul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__ror__" class="md-nav__link">
    __ror__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rpow__" class="md-nav__link">
    __rpow__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rsub__" class="md-nav__link">
    __rsub__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rtruediv__" class="md-nav__link">
    __rtruediv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__rxor__" class="md-nav__link">
    __rxor__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__sub__" class="md-nav__link">
    __sub__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__truediv__" class="md-nav__link">
    __truediv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.HAbleBinOpsMixin.__xor__" class="md-nav__link">
    __xor__()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dyce.plt/" class="md-nav__link">
        <tt>dyce.plt</tt>
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contrib/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/posita/dyce/edit/master/docs/dyce.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <!--- -*- encoding: utf-8 -*-
  Copyright and other protections apply. Please see the accompanying LICENSE file for
  rights and restrictions governing use of this software. All rights not expressly
  waived or licensed are reserved. If that file is missing or appears to be modified
  from its original, then please contact the author before viewing or using this
  software in any capacity.

  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  !!!!!!!!!!!!!!! IMPORTANT: READ THIS BEFORE EDITING! !!!!!!!!!!!!!!!
  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  Please keep each sentence on its own unwrapped line.
  It looks like crap in a text editor, but it has no effect on rendering, and it allows much more useful diffs.
  Thank you!
-->

<h1 id="dyce-package-reference"><code>dyce</code> package reference</h1>


  <div class="doc doc-object doc-module">



<h2 id="dyce" class="doc doc-heading">
        <code>dyce</code>


  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h2>

    <div class="doc doc-contents first">



    </div>

  </div>

<p><code>dyce</code> provides two core primitives:</p>
<ul>
<li><a href="#dyce.h.H"><code>H</code></a> for histograms (outcomes or individual dice)</li>
<li><a href="#dyce.p.P"><code>P</code></a> for collections of histograms (pools)</li>
</ul>


  <div class="doc doc-object doc-class">



<h2 id="dyce.h.H" class="doc doc-heading">
        <code>H</code>



</h2>

    <div class="doc doc-contents first">

      <p>An immutable mapping for use as a histogram which supports arithmetic operations.
This is useful for modeling discrete outcomes, like individual dice. <code>H</code> objects
encode discrete probability distributions as integer counts without any denominator.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The lack of an explicit denominator is intentional and has two benefits. First,
it is redundant. Without it, one never has to worry about probabilities summing
to one (e.g., via miscalculation, floating point error, etc.). Second (and
perhaps more importantly), sometimes one wants to have an insight into
non-reduced counts, not just probabilities. If needed, probabilities can always
be derives, as shown below.</p>
</div>
<p>The <a href="#dyce.h.H.__init__">initializer</a> takes a single parameter, <em>items</em>. In its most
explicit form, <em>items</em> maps outcome values to counts.</p>
<p>Modeling a single six-sided die (<code>1d6</code>) can be expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>An iterable of pairs can also be used (similar to <code>dict</code>):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Two shorthands are provided. If <em>items</em> is an iterable of numbers, counts of 1 are
assumed:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Repeated items are accumulated, as one would expect:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>If <em>items</em> is an integer, it is shorthand for creating a sequential range <span class="arithmatex">\([{1} ..
{items}]\)</span> (or <span class="arithmatex">\([{items} .. {-1}]\)</span> if <em>items</em> is negative):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Histograms are maps, so we can test equivalence against other maps:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Simple indexes can be used to look up an outcome’s count:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))[</span><span class="mi">3</span><span class="p">]</span>
<span class="mi">2</span>
</code></pre></div>
</td></tr></table>
<p>Most arithmetic operators are supported and do what one would expect. If the operand
is a number, the operator applies to the outcomes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">+</span> <span class="mi">4</span>
<span class="n">H</span><span class="p">({</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="o">-</span><span class="n">d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>If the operand is another histogram, combinations are computed. Modeling the sum of
two six-sided dice (<code>2d6</code>) can be expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">7.00</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">2.42</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">5.83</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|</span><span class="c1">#####</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|</span><span class="c1">#####</span>
 <span class="mi">10</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
 <span class="mi">11</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
</code></pre></div>
</td></tr></table>
<p>To sum <span class="arithmatex">\({n}\)</span> identical histograms, the matrix multiplication operator (<code>@</code>)
provides a shorthand:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@d6</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>The <code>len</code> built-in function can be used to show the number of distinct outcomes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span>
<span class="mi">11</span>
</code></pre></div>
</td></tr></table>
<p>The <a href="#dyce.h.H.counts"><code>counts</code> method</a> can be used to compute the total number of
combinations and each outcome’s probability:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span> <span class="p">;</span> <span class="n">total</span>
<span class="mi">36</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">total</span><span class="p">))</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
<span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">36</span><span class="p">)),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">)),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">36</span><span class="p">)),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="o">...</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">36</span><span class="p">))]</span>
</code></pre></div>
</td></tr></table>
<p>Histograms provide common comparators (e.g., <a href="#dyce.h.H.eq"><code>eq</code></a>
<a href="#dyce.h.H.ne"><code>ne</code></a>, etc.). One way to count how often a first six-sided die
shows a different face than a second is:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.83</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.37</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.14</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">83.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################################</span>
</code></pre></div>
</td></tr></table>
<p>Or, how often a first six-sided die shows a face less than a second is:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.42</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.49</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.24</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#############################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
</code></pre></div>
</td></tr></table>
<p>Or how often at least one <code>2</code> will show when rolling four six-sided dice:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6_eq2</span> <span class="o">=</span> <span class="n">d6</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span> <span class="n">d6_eq2</span>  <span class="c1"># how often a 2 shows on a single six-sided die</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">4</span><span class="nd">@d6_eq2</span>  <span class="c1"># count of 2s showing on 4d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">625</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">4</span><span class="nd">@d6_eq2</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># how often that count is at least one</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">625</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">671</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="mi">4</span><span class="nd">@d6_eq2</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.52</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.50</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.25</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">48.23</span><span class="o">%</span> <span class="o">|</span><span class="c1">########################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">51.77</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################</span>
</code></pre></div>
</td></tr></table>
<div class="admonition tip">
<p class="admonition-title">Mind your parentheses</p>
<p>Parentheses are often necessary to enforce the desired order of operations. This
is most often an issue with the <code>@</code> operator, because it behaves differently
than the <code>d</code> operator in most dedicated grammars. More specifically, in
Python, <code>@</code> has a <a href="https://docs.python.org/3/reference/expressions.html#operator-precedence">lower
precedence</a>
than <code>.</code> and <code>[…]</code>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>  <span class="c1"># type: ignore</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="o">...</span>
<span class="ne">KeyError</span><span class="p">:</span> <span class="mi">7</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># probably not what was intended</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">36</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">@</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)[</span><span class="mi">7</span><span class="p">]</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">21</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div>
</td></tr></table>
</div>
<p>Counts are generally accumulated without reduction. To reduce, call the
<a href="#dyce.h.H.lowest_terms"><code>lowest_terms</code> method</a>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>Testing equivalence implicitly performs reductions of operands:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>




  <div class="doc doc-children">















  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.__hash__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Return hash(self).</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span><span class="p">()))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializer.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">tmp</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">]</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">items</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span> <span class="o">=</span> <span class="n">items</span>
            <span class="n">outcome_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="n">count_1</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">items</span><span class="p">)(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">outcome_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span>
                <span class="n">items</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">items</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># count toward zero</span>
            <span class="p">)</span>
            <span class="n">tmp</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">outcome_type</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="n">count_1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">outcome_range</span><span class="p">})</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">HAbleT</span><span class="p">):</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">items</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">ABCMapping</span><span class="p">):</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">ABCIterable</span><span class="p">):</span>
        <span class="c1"># Items is either an Iterable[_OutcomeT] or an Iterable[Tuple[_OutcomeT,</span>
        <span class="c1"># _CountT]] (although this technically supports Iterable[Union[_OutcomeT,</span>
        <span class="c1"># Tuple[_OutcomeT, _CountT]]])</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">tmp</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">tmp</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;unrecognized initializer </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">items</span><span class="p">)))</span>

    <span class="c1"># Sort and omit zero counts. We use an OrderedDict instead of a Counter to</span>
    <span class="c1"># support Python versions earlier than 3.7 which did not guarantee order</span>
    <span class="c1"># preservation for the latter.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="n">ordereddict</span><span class="p">(</span>
        <span class="p">{</span><span class="n">outcome</span><span class="p">:</span> <span class="n">tmp</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span> <span class="k">if</span> <span class="n">tmp</span><span class="p">[</span><span class="n">outcome</span><span class="p">]}</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




























  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.accumulate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Accumulates counts:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Accumulates counts:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(4).accumulate(H(6))</span>
<span class="sd">    H({1: 2, 2: 2, 3: 2, 4: 2, 5: 1, 6: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ABCMapping</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ABCIterable</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">],</span> <span class="p">(</span><span class="n">other</span><span class="p">,))</span>

    <span class="k">return</span> <span class="n">H</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">,</span> <span class="n">other</span><span class="p">)))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.counts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_CountT</span><span class="p">]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>More descriptive synonym for the <a href="#dyce.h.H.values"><code>values</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_CountT</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    More descriptive synonym for the [``values`` method][dyce.h.H.values].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Synonym for <a href="#dyce.h.H.distribution"><code>distribution</code></a>. The <em>relative</em> parameter is
ignored.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>This alias is deprecated and will be removed in a future version.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">relative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="c1"># pylint: disable=unused-argument</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Synonym for [``distribution``][dyce.h.H.distribution]. The *relative* parameter is</span>
<span class="sd">    ignored.</span>

<span class="sd">    !!! warning &quot;Deprecated&quot;</span>

<span class="sd">        This alias is deprecated and will be removed in a future version.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;H.data is deprecated; use H.distribution&quot;</span><span class="p">,</span>
        <span class="ne">DeprecationWarning</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">fill_items</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.data_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">data_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Synonym for <a href="#dyce.h.H.distribution_xy"><code>distribution_xy</code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>This alias is deprecated and will be removed in a future version.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">data_xy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Synonym for [``distribution_xy``][dyce.h.H.distribution_xy].</span>

<span class="sd">    !!! warning &quot;Deprecated&quot;</span>

<span class="sd">        This alias is deprecated and will be removed in a future version.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;H.data_xy is deprecated; use H.distribution_xy&quot;</span><span class="p">,</span>
        <span class="ne">DeprecationWarning</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution_xy</span><span class="p">(</span><span class="n">fill_items</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.distribution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Presentation helper function returning an iterator for each outcome/count or
outcome/probability pair:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">())</span>
<span class="p">[(</span><span class="kc">False</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>
<p>If provided, <em>fill_items</em> supplies defaults for any “missing” outcomes:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">())</span>
<span class="p">[(</span><span class="kc">False</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">fill_items</span><span class="o">=</span><span class="p">{</span><span class="kc">True</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">:</span> <span class="mi">0</span><span class="p">}))</span>
<span class="p">[(</span><span class="kc">False</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">distribution</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Presentation helper function returning an iterator for each outcome/count or</span>
<span class="sd">    outcome/probability pair:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list(H(6).gt(3).distribution())</span>
<span class="sd">    [(False, 0.5), (True, 0.5)]</span>

<span class="sd">    ```</span>

<span class="sd">    If provided, *fill_items* supplies defaults for any “missing” outcomes:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list(H(6).gt(7).distribution())</span>
<span class="sd">    [(False, 1.0)]</span>
<span class="sd">    &gt;&gt;&gt; list(H(6).gt(7).distribution(fill_items={True: 0, False: 0}))</span>
<span class="sd">    [(False, 1.0), (True, 0.0)]</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fill_items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fill_items</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">combined</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">fill_items</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="ow">or</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.distribution_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">distribution_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Presentation helper function returning an iterator for a “zipped” arrangement of the
output from the <a href="#dyce.h.H.distribution"><code>distribution</code> method</a>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">())</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">distribution_xy</span><span class="p">()</span>
<span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">distribution_xy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Presentation helper function returning an iterator for a “zipped” arrangement of the</span>
<span class="sd">    output from the [``distribution`` method][dyce.h.H.distribution]:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list(H(6).distribution())</span>
<span class="sd">    [(1, 0.16666666), (2, 0.16666666), (3, 0.16666666), (4, 0.16666666), (5, 0.16666666), (6, 0.16666666)]</span>
<span class="sd">    &gt;&gt;&gt; H(6).distribution_xy()</span>
<span class="sd">    ((1, 2, 3, 4, 5, 6), (0.16666666, 0.16666666, 0.16666666, 0.16666666, 0.16666666, 0.16666666))</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span>
        <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">fill_items</span><span class="p">))),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.eq, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.eq, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).eq(3)</span>
<span class="sd">    H({False: 5, True: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_eq</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.even" class="doc doc-heading">
<code class="highlight language-python"><span class="n">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Equivalent to <code>self.umap(lambda outcome: outcome % 2 == 0)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">even</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.umap"><code>umap</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to ``self.umap(lambda outcome: outcome % 2 == 0)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).even()</span>
<span class="sd">    H({False: 2, True: 4})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``umap`` method][dyce.h.H.umap].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="n">outcome</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">outcome</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;not supported for outcomes of type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">type</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_even</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.explode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.substitute(lambda h, outcome: h if outcome == max(h) else
outcome, operator.add, max_depth)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.substitute"><code>substitute</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.substitute(lambda h, outcome: h if outcome == max(h) else</span>
<span class="sd">    outcome, operator.add, max_depth)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).explode(max_depth=2)</span>
<span class="sd">    H({1: 36, 2: 36, 3: 36, 4: 36, 5: 36, 7: 6, 8: 6, 9: 6, 10: 6, 11: 6, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``substitute`` method][dyce.h.H.substitute].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span>
        <span class="k">lambda</span> <span class="n">h</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">h</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">else</span> <span class="n">outcome</span><span class="p">,</span>
        <span class="n">op_add</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.faces" class="doc doc-heading">
<code class="highlight language-python"><span class="n">faces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Synonym for <a href="#dyce.h.H.outcomes"><code>outcomes</code></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>This alias is deprecated and will be removed in a future version.</p>
</div>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">faces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Synonym for [``outcomes``][dyce.h.H.outcomes].</span>

<span class="sd">    !!! warning &quot;Deprecated&quot;</span>

<span class="sd">        This alias is deprecated and will be removed in a future version.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
        <span class="s2">&quot;H.faces is deprecated; use H.outcomes&quot;</span><span class="p">,</span>
        <span class="ne">DeprecationWarning</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.format" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">88</span><span class="p">,</span> <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tick</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns a formatted string representation of the histogram. If provided,
<em>fill_items</em> supplies defaults for any missing outcomes. If <em>width</em> is greater
than zero, a horizontal bar ASCII graph is printed using <em>tick</em> and <em>sep</em> (which
are otherwise ignored if <em>width</em> is zero or less).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">{</span><span class="n">avg</span><span class="p">:</span> <span class="mf">3.50</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">}</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fill_items</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)},</span> <span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">tick</span><span class="o">=</span><span class="s2">&quot;@&quot;</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">7.00</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">2.42</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">5.83</span>
  <span class="mi">1</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|@</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|@@</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|@@@@</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|@@@@@</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|@@@@@@</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|@@@@@@@@</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|@@@@@@</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|@@@@@</span>
 <span class="mi">10</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|@@@@</span>
 <span class="mi">11</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|@@</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|@</span>
 <span class="mi">13</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">14</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">15</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">16</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">17</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">18</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">19</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">20</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
</code></pre></div>
</td></tr></table>
<p>If <em>scaled</em> is <code>True</code>, horizontal bars are scaled to <em>width</em>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:-&gt;65}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot; 65 chars wide --&gt;|&quot;</span><span class="p">))</span>
<span class="o">----------------------------------------------</span> <span class="mi">65</span> <span class="n">chars</span> <span class="n">wide</span> <span class="o">--&gt;|</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.58</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.49</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.24</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#############################</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.58</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.49</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.24</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">###################################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">##################################################</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">format</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">_MappingT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">_ROW_WIDTH</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">tick</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a formatted string representation of the histogram. If provided,</span>
<span class="sd">    *fill_items* supplies defaults for any missing outcomes. If *width* is greater</span>
<span class="sd">    than zero, a horizontal bar ASCII graph is printed using *tick* and *sep* (which</span>
<span class="sd">    are otherwise ignored if *width* is zero or less).</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; print(H(6).format(width=0))</span>
<span class="sd">    {avg: 3.50, 1: 16.67%, 2: 16.67%, 3: 16.67%, 4: 16.67%, 5: 16.67%, 6: 16.67%}</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; print((2@H(6)).format(fill_items={i: 0 for i in range(1, 21)}, width=65, tick=&quot;@&quot;))</span>
<span class="sd">    avg |    7.00</span>
<span class="sd">    std |    2.42</span>
<span class="sd">    var |    5.83</span>
<span class="sd">      1 |   0.00% |</span>
<span class="sd">      2 |   2.78% |@</span>
<span class="sd">      3 |   5.56% |@@</span>
<span class="sd">      4 |   8.33% |@@@@</span>
<span class="sd">      5 |  11.11% |@@@@@</span>
<span class="sd">      6 |  13.89% |@@@@@@</span>
<span class="sd">      7 |  16.67% |@@@@@@@@</span>
<span class="sd">      8 |  13.89% |@@@@@@</span>
<span class="sd">      9 |  11.11% |@@@@@</span>
<span class="sd">     10 |   8.33% |@@@@</span>
<span class="sd">     11 |   5.56% |@@</span>
<span class="sd">     12 |   2.78% |@</span>
<span class="sd">     13 |   0.00% |</span>
<span class="sd">     14 |   0.00% |</span>
<span class="sd">     15 |   0.00% |</span>
<span class="sd">     16 |   0.00% |</span>
<span class="sd">     17 |   0.00% |</span>
<span class="sd">     18 |   0.00% |</span>
<span class="sd">     19 |   0.00% |</span>
<span class="sd">     20 |   0.00% |</span>

<span class="sd">    ```</span>

<span class="sd">    If *scaled* is ``True``, horizontal bars are scaled to *width*:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; h = (2@H(6)).ge(7)</span>
<span class="sd">    &gt;&gt;&gt; print(&quot;{:-&gt;65}&quot;.format(&quot; 65 chars wide --&gt;|&quot;))</span>
<span class="sd">    ---------------------------------------------- 65 chars wide --&gt;|</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(width=65, scaled=False))</span>
<span class="sd">    avg |    0.58</span>
<span class="sd">    std |    0.49</span>
<span class="sd">    var |    0.24</span>
<span class="sd">      0 |  41.67% |####################</span>
<span class="sd">      1 |  58.33% |#############################</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(width=65, scaled=True))</span>
<span class="sd">    avg |    0.58</span>
<span class="sd">    std |    0.49</span>
<span class="sd">    var |    0.24</span>
<span class="sd">      0 |  41.67% |###################################</span>
<span class="sd">      1 |  58.33% |##################################################</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># We convert various values herein to native ints and floats because number</span>
    <span class="c1"># tower implementations sometimes neglect to implement __format__ properly (or</span>
    <span class="c1"># at all). (I&#39;m looking at you, sage.rings.…!)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">parts</span><span class="p">():</span>
            <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;avg: </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">fill_items</span><span class="p">):</span>
                <span class="n">probability_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">probability_f</span><span class="si">:</span><span class="s2">7.2%</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">15</span>

        <span class="k">def</span> <span class="nf">lines</span><span class="p">():</span>
            <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;avg | </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
                <span class="n">var</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;std | </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;var | </span><span class="si">{</span><span class="n">var</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">outcomes</span><span class="p">,</span> <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution_xy</span><span class="p">(</span><span class="n">fill_items</span><span class="p">)</span>
            <span class="n">tick_scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span> <span class="k">if</span> <span class="n">scaled</span> <span class="k">else</span> <span class="mf">1.0</span>

            <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">outcome_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome</span><span class="si">:</span><span class="s2"> 3</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="n">outcome_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
                    <span class="n">outcome_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome_str</span><span class="si">:</span><span class="s2"> &gt;3</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="n">ticks</span> <span class="o">=</span> <span class="n">tick</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">probability</span> <span class="o">/</span> <span class="n">tick_scale</span><span class="p">)</span>
                <span class="n">probability_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome_str</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">probability_f</span><span class="si">:</span><span class="s2">7.2%</span><span class="si">}</span><span class="s2"> |</span><span class="si">{</span><span class="n">ticks</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.ge, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.ge, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).ge(3)</span>
<span class="sd">    H({False: 2, True: 4})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_ge</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.gt, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.gt, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).gt(3)</span>
<span class="sd">    H({False: 3, True: 3})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_gt</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.items" class="doc doc-heading">
<code class="highlight language-python"><span class="n">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>D.items() -&gt; a set-like object providing a view on D's items</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>D.keys() -&gt; a set-like object providing a view on D's keys</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.le, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.le, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).le(3)</span>
<span class="sd">    H({False: 3, True: 3})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_le</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.lowest_terms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lowest_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Computes and returns a histogram whose counts share a greatest common divisor of 1.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">df</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span> <span class="n">df</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d233445</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span> <span class="p">;</span> <span class="n">d233445</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d233445</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lowest_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes and returns a histogram whose counts share a greatest common divisor of 1.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; df = H((-1, -1, 0, 0, 1, 1)); df</span>
<span class="sd">    H({-1: 2, 0: 2, 1: 2})</span>
<span class="sd">    &gt;&gt;&gt; df.lowest_terms()</span>
<span class="sd">    H({-1: 1, 0: 1, 1: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d233445 = H((2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5)) ; d233445</span>
<span class="sd">    H({2: 2, 3: 4, 4: 4, 5: 2})</span>
<span class="sd">    &gt;&gt;&gt; d233445.lowest_terms()</span>
<span class="sd">    H({2: 1, 3: 2, 4: 2, 5: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">H</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.lt, other)</code>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.lt, other)``:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).lt(3)</span>
<span class="sd">    H({False: 4, True: 2})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_lt</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.map" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oper</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Applies <em>oper</em> to each outcome of the histogram paired with <em>other</em>. Shorthands
exist for many arithmetic operators and comparators.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oper</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies *oper* to each outcome of the histogram paired with *other*. Shorthands</span>
<span class="sd">    exist for many arithmetic operators and comparators.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.add, d6)</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.add, d6) == d6 + d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.mul, -1)</span>
<span class="sd">    H({-6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1})</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.mul, -1) == d6 * -1</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.gt, 3)</span>
<span class="sd">    H({False: 3, True: 3})</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.gt, 3) == d6.gt(3)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HAbleT</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Number</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">H</span><span class="p">((</span><span class="n">oper</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">other</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">H</span><span class="p">((</span><span class="n">oper</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">o</span><span class="p">),</span> <span class="bp">self</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">other</span><span class="p">[</span><span class="n">o</span><span class="p">])</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.mean" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns the mean of the weighted outcomes (or 0.0 if there are no outcomes).</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the mean of the weighted outcomes (or 0.0 if there are no outcomes).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">numerator</span> <span class="o">+=</span> <span class="n">outcome</span> <span class="o">*</span> <span class="n">count</span>
        <span class="n">denominator</span> <span class="o">+=</span> <span class="n">count</span>

    <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">denominator</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.ne, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.ne, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).ne(3)</span>
<span class="sd">    H({False: 1, True: 5})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_ne</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.odd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Equivalent to <code>self.umap(lambda outcome: outcome % 2 != 0)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">odd</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.umap"><code>umap</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to ``self.umap(lambda outcome: outcome % 2 != 0)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).odd()</span>
<span class="sd">    H({False: 4, True: 2})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``umap`` method][dyce.h.H.umap].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">is_odd</span><span class="p">(</span><span class="n">outcome</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)):</span>
            <span class="k">return</span> <span class="n">outcome</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="s2">&quot;not supported for outcomes of type </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="nb">type</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
                <span class="p">)</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_odd</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.outcomes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>More descriptive synonym for the <a href="#dyce.h.H.keys"><code>keys</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    More descriptive synonym for the [``keys`` method][dyce.h.H.keys].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.roll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_OutcomeT</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns a (weighted) random outcome.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_OutcomeT</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a (weighted) random outcome.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">()))</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">count</span>

        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">total</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">outcome</span>

    <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;val (</span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">) ≥ total (</span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.stdev" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stdev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>math.sqrt(self.variance(mu))</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">stdev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``math.sqrt(self.variance(mu))``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.substitute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substitute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expand</span><span class="p">:</span> <span class="n">_ExpandT</span><span class="p">,</span> <span class="n">coalesce</span><span class="p">:</span> <span class="n">_CoalesceT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Calls <em>expand</em> on each outcome, recursively up to <em>max_depth</em> times. If <em>expand</em>
returns a number, it replaces the outcome. If it returns an <span data-autorefs-identifier="dyce.h.H"><code>H</code>
object</span>, <em>coalesce</em> is called on the outcome and the expanded
histogram, and the returned histogram is folded into result. The default
behavior for <em>coalesce</em> is to replace the outcome with the expanded histogram.
Returned histograms are always reduced to their lowest terms. (See the
<a href="#dyce.h.H.lowest_terms"><code>lowest_terms</code> method</a>.)</p>
<p>This can be used to model complex rules. The following models re-rolling a face
of 1 on the first roll:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">reroll_one</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">return</span> <span class="n">h</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">outcome</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">reroll_one</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.explode"><code>explode</code> method</a> for a common shorthand for
“exploding” dice (i.e., where, if the greatest face come up, the die is
re-rolled and the result is added to a running sum).</p>
<p>In nearly all cases, when a histogram is substituted for an outcome, it takes on
the substituted outcome’s “scale”. In other words, the sum of the counts of the
replacement retains the same proportion as the replaced outcome in relation to
other outcomes. This becomes clearer when there is no overlap between the
original histogram and the substitution:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">orig</span> <span class="o">=</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sub</span> <span class="o">=</span> <span class="n">orig</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="k">lambda</span> <span class="n">h</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="o">-</span><span class="n">h</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">4</span> <span class="k">else</span> <span class="n">outcome</span><span class="p">)</span> <span class="p">;</span> <span class="n">sub</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">count</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">orig</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">orig</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>
<span class="mf">0.4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">count</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">sub</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sub</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>
<span class="mf">0.4</span>
</code></pre></div>
</td></tr></table>
<div class="admonition tip">
<p class="admonition-title">An important exception</p>
<p>If <em>coalesce</em> returns the empty histogram (<code>H({})</code>), the corresponding
outcome and its counts are omitted from the result without substitution or
scaling. A silly example is modeling a d5 by indefinitely re-rolling a d6
until something other than a 6 comes up:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="k">lambda</span> <span class="n">h</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">H</span><span class="p">({})</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">6</span> <span class="k">else</span> <span class="n">outcome</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>This technique is more useful when modeling re-rolling certain derived
outcomes, like ties in a contest:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6_3</span><span class="p">,</span> <span class="n">d8_2</span> <span class="o">=</span> <span class="mi">3</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6_3</span><span class="o">.</span><span class="n">vs</span><span class="p">(</span><span class="n">d8_2</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">4553</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1153</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">8118</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6_3</span><span class="o">.</span><span class="n">vs</span><span class="p">(</span><span class="n">d8_2</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="k">lambda</span> <span class="n">h</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">H</span><span class="p">({})</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">outcome</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">4553</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">8118</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
</div>
<p>Because it delegates to a callback for refereeing substitution decisions,
<code>substitute</code> is quite flexible and well suited to modeling (or at least
approximating) logical progressions. Consider the following rules:</p>
<ol>
<li>Start with a total of zero.</li>
<li>Roll a six-sided die. Add the face to the total. If the face was a six, go
     to step 3. Otherwise stop.</li>
<li>Roll a four-sided die. Add the face to the total. If the face was a four,
     go to step 2. Otherwise stop.</li>
</ol>
<p>What is the likelihood of an even final tally? This can be approximated by:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">reroll_greatest_on_d4_d6</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="n">d6</span><span class="p">:</span> <span class="k">return</span> <span class="n">d4</span>
<span class="o">...</span>     <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="n">d4</span><span class="p">:</span> <span class="k">return</span> <span class="n">d6</span>
<span class="o">...</span>   <span class="k">return</span> <span class="n">outcome</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">d6</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">reroll_greatest_on_d4_d6</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h_even</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">even</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h_even</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">h_even</span><span class="o">.</span><span class="n">counts</span><span class="p">())))</span>
<span class="mf">39.131</span><span class="o">%</span>
</code></pre></div>
</td></tr></table>
<p>Surprised? Because both six and four are even numbers, the only way we keep
rolling is if the total is even. You might think this would lead to evens being
<em>more</em> likely. However, we only care about the final tally and the rules direct
us to re-roll certain evens (nudging us toward an odd number more often than
not).</p>
<p>We can also use this method to model expected damage from a single attack in
d20-like role playing games:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bonus</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dmg_dice</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dmg</span> <span class="o">=</span> <span class="n">dmg_dice</span> <span class="o">+</span> <span class="n">bonus</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">dmg</span> <span class="o">+</span> <span class="n">dmg_dice</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">target</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">-</span> <span class="n">bonus</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d20</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">dmg_from_attack_roll</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">outcome</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">crit</span>
<span class="o">...</span>   <span class="k">elif</span> <span class="n">outcome</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">dmg</span>
<span class="o">...</span>   <span class="k">else</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">0</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">d20</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">dmg_from_attack_roll</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">2.15</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">3.40</span>
<span class="n">var</span> <span class="o">|</span>   <span class="mf">11.55</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">65.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">##################################################</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">3.75</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">3.83</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">3.91</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
  <span class="mi">5</span> <span class="o">|</span>   <span class="mf">3.98</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
  <span class="mi">6</span> <span class="o">|</span>   <span class="mf">4.06</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
  <span class="mi">7</span> <span class="o">|</span>   <span class="mf">4.14</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
  <span class="mi">8</span> <span class="o">|</span>   <span class="mf">4.22</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
  <span class="mi">9</span> <span class="o">|</span>   <span class="mf">4.30</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
 <span class="mi">10</span> <span class="o">|</span>   <span class="mf">0.62</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">11</span> <span class="o">|</span>   <span class="mf">0.55</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">0.47</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">13</span> <span class="o">|</span>   <span class="mf">0.39</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">14</span> <span class="o">|</span>   <span class="mf">0.31</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">15</span> <span class="o">|</span>   <span class="mf">0.23</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">16</span> <span class="o">|</span>   <span class="mf">0.16</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">17</span> <span class="o">|</span>   <span class="mf">0.08</span><span class="o">%</span> <span class="o">|</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">expand</span><span class="p">:</span> <span class="n">_ExpandT</span><span class="p">,</span>
    <span class="n">coalesce</span><span class="p">:</span> <span class="n">_CoalesceT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calls *expand* on each outcome, recursively up to *max_depth* times. If *expand*</span>
<span class="sd">    returns a number, it replaces the outcome. If it returns an [``H``</span>
<span class="sd">    object][dyce.h.H], *coalesce* is called on the outcome and the expanded</span>
<span class="sd">    histogram, and the returned histogram is folded into result. The default</span>
<span class="sd">    behavior for *coalesce* is to replace the outcome with the expanded histogram.</span>
<span class="sd">    Returned histograms are always reduced to their lowest terms. (See the</span>
<span class="sd">    [``lowest_terms`` method][dyce.h.H.lowest_terms].)</span>

<span class="sd">    This can be used to model complex rules. The following models re-rolling a face</span>
<span class="sd">    of 1 on the first roll:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; def reroll_one(h: H, outcome):</span>
<span class="sd">    ...   return h if outcome == 1 else outcome</span>

<span class="sd">    &gt;&gt;&gt; H(6).substitute(reroll_one)</span>
<span class="sd">    H({1: 1, 2: 7, 3: 7, 4: 7, 5: 7, 6: 7})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``explode`` method][dyce.h.H.explode] for a common shorthand for</span>
<span class="sd">    “exploding” dice (i.e., where, if the greatest face come up, the die is</span>
<span class="sd">    re-rolled and the result is added to a running sum).</span>

<span class="sd">    In nearly all cases, when a histogram is substituted for an outcome, it takes on</span>
<span class="sd">    the substituted outcome’s “scale”. In other words, the sum of the counts of the</span>
<span class="sd">    replacement retains the same proportion as the replaced outcome in relation to</span>
<span class="sd">    other outcomes. This becomes clearer when there is no overlap between the</span>
<span class="sd">    original histogram and the substitution:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; orig = H({1: 1, 2: 2, 3: 3, 4: 4})</span>
<span class="sd">    &gt;&gt;&gt; sub = orig.substitute(lambda h, outcome: -h if outcome == 4 else outcome) ; sub</span>
<span class="sd">    H({-4: 8, -3: 6, -2: 4, -1: 2, 1: 5, 2: 10, 3: 15})</span>
<span class="sd">    &gt;&gt;&gt; sum(count for outcome, count in orig.items() if outcome == 4) / sum(orig.counts())</span>
<span class="sd">    0.4</span>
<span class="sd">    &gt;&gt;&gt; sum(count for outcome, count in sub.items() if outcome &lt; 0) / sum(sub.counts())</span>
<span class="sd">    0.4</span>

<span class="sd">    ```</span>

<span class="sd">    !!! tip &quot;An important exception&quot;</span>

<span class="sd">        If *coalesce* returns the empty histogram (``H({})``), the corresponding</span>
<span class="sd">        outcome and its counts are omitted from the result without substitution or</span>
<span class="sd">        scaling. A silly example is modeling a d5 by indefinitely re-rolling a d6</span>
<span class="sd">        until something other than a 6 comes up:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; H(6).substitute(lambda h, outcome: H({}) if outcome == 6 else outcome)</span>
<span class="sd">        H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        This technique is more useful when modeling re-rolling certain derived</span>
<span class="sd">        outcomes, like ties in a contest:</span>

<span class="sd">        ```python</span>
<span class="sd">        &gt;&gt;&gt; d6_3, d8_2 = 3@H(6), 2@H(8)</span>
<span class="sd">        &gt;&gt;&gt; d6_3.vs(d8_2)</span>
<span class="sd">        H({-1: 4553, 0: 1153, 1: 8118})</span>
<span class="sd">        &gt;&gt;&gt; d6_3.vs(d8_2).substitute(lambda h, outcome: H({}) if outcome == 0 else outcome)</span>
<span class="sd">        H({-1: 4553, 1: 8118})</span>

<span class="sd">        ```</span>

<span class="sd">    Because it delegates to a callback for refereeing substitution decisions,</span>
<span class="sd">    ``substitute`` is quite flexible and well suited to modeling (or at least</span>
<span class="sd">    approximating) logical progressions. Consider the following rules:</span>

<span class="sd">      1. Start with a total of zero.</span>
<span class="sd">      2. Roll a six-sided die. Add the face to the total. If the face was a six, go</span>
<span class="sd">         to step 3. Otherwise stop.</span>
<span class="sd">      3. Roll a four-sided die. Add the face to the total. If the face was a four,</span>
<span class="sd">         go to step 2. Otherwise stop.</span>

<span class="sd">    What is the likelihood of an even final tally? This can be approximated by:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d4, d6 = H(4), H(6)</span>

<span class="sd">    &gt;&gt;&gt; def reroll_greatest_on_d4_d6(h: H, outcome):</span>
<span class="sd">    ...   if outcome == max(h):</span>
<span class="sd">    ...     if h == d6: return d4</span>
<span class="sd">    ...     if h == d4: return d6</span>
<span class="sd">    ...   return outcome</span>

<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; h = d6.substitute(reroll_greatest_on_d4_d6, operator.add, max_depth=6)</span>
<span class="sd">    &gt;&gt;&gt; h_even = h.even()</span>
<span class="sd">    &gt;&gt;&gt; print(&quot;{:.3%}&quot;.format(h_even[1] / sum(h_even.counts())))</span>
<span class="sd">    39.131%</span>

<span class="sd">    ```</span>

<span class="sd">    Surprised? Because both six and four are even numbers, the only way we keep</span>
<span class="sd">    rolling is if the total is even. You might think this would lead to evens being</span>
<span class="sd">    *more* likely. However, we only care about the final tally and the rules direct</span>
<span class="sd">    us to re-roll certain evens (nudging us toward an odd number more often than</span>
<span class="sd">    not).</span>

<span class="sd">    We can also use this method to model expected damage from a single attack in</span>
<span class="sd">    d20-like role playing games:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; bonus = 1</span>
<span class="sd">    &gt;&gt;&gt; dmg_dice = H(8)</span>
<span class="sd">    &gt;&gt;&gt; dmg = dmg_dice + bonus</span>
<span class="sd">    &gt;&gt;&gt; crit = dmg + dmg_dice</span>
<span class="sd">    &gt;&gt;&gt; target = 15 - bonus</span>
<span class="sd">    &gt;&gt;&gt; d20 = H(20)</span>

<span class="sd">    &gt;&gt;&gt; def dmg_from_attack_roll(h: H, outcome):</span>
<span class="sd">    ...   if outcome == 20:</span>
<span class="sd">    ...     return crit</span>
<span class="sd">    ...   elif outcome &gt;= target:</span>
<span class="sd">    ...     return dmg</span>
<span class="sd">    ...   else:</span>
<span class="sd">    ...     return 0</span>

<span class="sd">    &gt;&gt;&gt; h = d20.substitute(dmg_from_attack_roll)</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(width=65, scaled=True))</span>
<span class="sd">    avg |    2.15</span>
<span class="sd">    std |    3.40</span>
<span class="sd">    var |   11.55</span>
<span class="sd">      0 |  65.00% |##################################################</span>
<span class="sd">      2 |   3.75% |##</span>
<span class="sd">      3 |   3.83% |##</span>
<span class="sd">      4 |   3.91% |###</span>
<span class="sd">      5 |   3.98% |###</span>
<span class="sd">      6 |   4.06% |###</span>
<span class="sd">      7 |   4.14% |###</span>
<span class="sd">      8 |   4.22% |###</span>
<span class="sd">      9 |   4.30% |###</span>
<span class="sd">     10 |   0.62% |</span>
<span class="sd">     11 |   0.55% |</span>
<span class="sd">     12 |   0.47% |</span>
<span class="sd">     13 |   0.39% |</span>
<span class="sd">     14 |   0.31% |</span>
<span class="sd">     15 |   0.23% |</span>
<span class="sd">     16 |   0.16% |</span>
<span class="sd">     17 |   0.08% |</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">coalesce</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">coalesce</span> <span class="o">=</span> <span class="n">_coalesce_replace</span>

    <span class="k">def</span> <span class="nf">_substitute</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">coalesce</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="n">max_depth</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">h</span>

        <span class="n">total_scalar</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">items_for_reassembly</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">_CountT</span><span class="p">,</span> <span class="n">_CountT</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">expanded</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expanded</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
                <span class="c1"># Keep expanding deeper, if we can</span>
                <span class="n">expanded</span> <span class="o">=</span> <span class="n">_substitute</span><span class="p">(</span><span class="n">expanded</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="c1"># Coalesce the result</span>
                <span class="n">expanded</span> <span class="o">=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">expanded</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>
                <span class="c1"># Account for the impact of expansion on peers</span>
                <span class="n">expanded_scalar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">expanded</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>

                <span class="k">if</span> <span class="n">expanded_scalar</span><span class="p">:</span>
                    <span class="n">total_scalar</span> <span class="o">*=</span> <span class="n">expanded_scalar</span>
                    <span class="c1"># Account for the impact of the original count on the result, but</span>
                    <span class="c1"># keep track of the impact on peers so we can factor it out for</span>
                    <span class="c1"># these items later</span>
                    <span class="n">items_for_reassembly</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                        <span class="p">(</span><span class="n">exp_f</span><span class="p">,</span> <span class="n">exp_c</span> <span class="o">*</span> <span class="n">count</span><span class="p">,</span> <span class="n">expanded_scalar</span><span class="p">)</span>
                        <span class="k">for</span> <span class="n">exp_f</span><span class="p">,</span> <span class="n">exp_c</span> <span class="ow">in</span> <span class="n">expanded</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">items_for_reassembly</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">expanded</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">H</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="c1"># Apply the total_scalar, but factor out this item&#39;s contribution</span>
                <span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="o">*</span> <span class="n">total_scalar</span> <span class="o">//</span> <span class="n">s</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">items_for_reassembly</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">_substitute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.umap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">umap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oper</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Applies <em>oper</em> to each outcome of the histogram:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">outcome</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">outcome</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">outcome</span><span class="p">)</span> <span class="o">**</span> <span class="n">outcome</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">27</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">umap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oper</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies *oper* to each outcome of the histogram:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).umap(lambda outcome: outcome * -1)</span>
<span class="sd">    H(-6)</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(4).umap(lambda outcome: (-outcome) ** outcome)</span>
<span class="sd">    H({-27: 1, -1: 1, 4: 1, 256: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="n">oper</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">h_simple</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span><span class="p">)(</span><span class="n">oper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span><span class="p">)))</span>

        <span class="k">if</span> <span class="n">h_simple</span> <span class="o">==</span> <span class="n">h</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">h_simple</span>

    <span class="k">return</span> <span class="n">h</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>D.values() -&gt; an object providing a view on D's values</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.variance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns the variance of the weighted outcomes. If provided, <em>mu</em> is used as the mean
(to avoid duplicate computation).</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the variance of the weighted outcomes. If provided, *mu* is used as the mean</span>
<span class="sd">    (to avoid duplicate computation).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span> <span class="k">if</span> <span class="n">mu</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">numerator</span> <span class="o">+=</span> <span class="p">(</span><span class="n">outcome</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">count</span>
        <span class="n">denominator</span> <span class="o">+=</span> <span class="n">count</span>

    <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">denominator</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.vs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Compares this histogram with <em>other</em>. -1 represents where <em>other</em> is greater. 0
represents where they are equal. 1 represents where <em>other</em> is less.</p>
<p>Shorthand for <code>self.within(0, 0, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">vs</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">vs</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.within"><code>within</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">vs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compares this histogram with *other*. -1 represents where *other* is greater. 0</span>
<span class="sd">    represents where they are equal. 1 represents where *other* is less.</span>

<span class="sd">    Shorthand for ``self.within(0, 0, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).vs(H(4))</span>
<span class="sd">    H({-1: 6, 0: 4, 1: 14})</span>
<span class="sd">    &gt;&gt;&gt; H(6).vs(H(4)) == H(6).within(0, 0, H(4))</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``within`` method][dyce.h.H.within].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.within" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;H&#39;</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Computes the difference between this histogram and <em>other</em>. -1 represents where that
difference is less than <em>lo</em>. 0 represents where that difference between <em>lo</em>
and <em>hi</em> (inclusive). 1 represents where that difference is greater than <em>hi</em>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6_2</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6_2</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6_2</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>   <span class="o">-</span><span class="mf">0.25</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.72</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.52</span>
 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6_3</span><span class="p">,</span> <span class="n">d8_2</span> <span class="o">=</span> <span class="mi">3</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6_3</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d8_2</span><span class="p">)</span>  <span class="c1"># 3d6 w/in 1 of 2d8</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3500</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">3412</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6912</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6_3</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d8_2</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.25</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.83</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.69</span>
 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>  <span class="mf">25.32</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">24.68</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">50.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the difference between this histogram and *other*. -1 represents where that</span>
<span class="sd">    difference is less than *lo*. 0 represents where that difference between *lo*</span>
<span class="sd">    and *hi* (inclusive). 1 represents where that difference is greater than *hi*.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6_2 = 2@H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6_2.within(7, 9)</span>
<span class="sd">    H({-1: 15, 0: 15, 1: 6})</span>
<span class="sd">    &gt;&gt;&gt; print(d6_2.within(7, 9).format(width=65))</span>
<span class="sd">    avg |   -0.25</span>
<span class="sd">    std |    0.72</span>
<span class="sd">    var |    0.52</span>
<span class="sd">     -1 |  41.67% |####################</span>
<span class="sd">      0 |  41.67% |####################</span>
<span class="sd">      1 |  16.67% |########</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6_3, d8_2 = 3@H(6), 2@H(8)</span>
<span class="sd">    &gt;&gt;&gt; d6_3.within(-1, 1, d8_2)  # 3d6 w/in 1 of 2d8</span>
<span class="sd">    H({-1: 3500, 0: 3412, 1: 6912})</span>
<span class="sd">    &gt;&gt;&gt; print(d6_3.within(-1, 1, d8_2).format(width=65))</span>
<span class="sd">    avg |    0.25</span>
<span class="sd">    std |    0.83</span>
<span class="sd">    var |    0.69</span>
<span class="sd">     -1 |  25.32% |############</span>
<span class="sd">      0 |  24.68% |############</span>
<span class="sd">      1 |  50.00% |#########################</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_within</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="dyce.p.P" class="doc doc-heading">
        <code>P</code>



</h2>

    <div class="doc doc-contents first">

      <p>An immutable pool (ordered sequence) supporting group operations for zero or more
<a href="#dyce.h.H"><code>H</code> objects</a> (provided or created from the
<a href="#dyce.p.P.__init__">initializer</a>’s <em>args</em> parameter).</p>
<p>This class implements the <a href="#dyce.h.HAbleT"><code>HAbleT</code> protocol</a> and derives from the
<a href="#dyce.h.HAbleBinOpsMixin"><code>HAbleBinOpsMixin</code> class</a>, which means it can be
“flattened” into a single histogram, either explicitly via the
<a href="#dyce.p.P.h"><code>h</code> method</a>, or implicitly by using binary arithmetic operations.
Note that this class also provides its own <code>@</code> and unary operator implementations
that result in new <code>P</code> objects, not flattened histograms.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">P</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span> <span class="n">p_d6</span>  <span class="c1"># shorthand for P(H(6))</span>
<span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="o">-</span><span class="n">p_d6</span>
<span class="n">P</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="n">p_d6</span><span class="p">,</span> <span class="n">p_d6</span><span class="p">)</span>  <span class="c1"># 2d6</span>
<span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@p_d6</span>  <span class="c1"># also 2d6</span>
<span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="o">@</span><span class="p">(</span><span class="mi">2</span><span class="nd">@p_d6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="nd">@p_d6</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">20</span><span class="p">))))))</span> <span class="p">;</span> <span class="n">p</span>
<span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">roll</span><span class="p">())</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Arithmetic operators involving a number or another <code>P</code> object produce an
<a href="#dyce.h.H"><code>H</code> object</a>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_d6</span> <span class="o">+</span> <span class="n">p_d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>Comparisons with <a href="#dyce.h.H"><code>H</code> objects</a> work as expected:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@p_d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Indexing selects a contained histogram:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Note that pools are opinionated about ordering:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>In an extension to (departure from) the <a href="#dyce.h.HAbleT"><code>HAbleT</code> protocol</a>, the
<a href="#dyce.p.P.h"><code>P.h</code> method</a>’s implementation also affords subsets of outcomes to be
“taken” (selected) by passing in selection criteria. Values are indexed from least
to greatest. Negative indexes are supported and retain their idiomatic meaning.
Modeling the sum of the greatest two faces of three six-sided dice (<code>3d6</code>) can be
expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span> <span class="o">=</span> <span class="mi">3</span><span class="nd">@p_d6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p_3d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">8.46</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">2.21</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">4.91</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">0.46</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">1.39</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">3.24</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">5</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">6</span> <span class="o">|</span>   <span class="mf">8.80</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">12.50</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">15.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">#######</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
 <span class="mi">10</span> <span class="o">|</span>  <span class="mf">15.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">#######</span>
 <span class="mi">11</span> <span class="o">|</span>  <span class="mf">12.50</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">7.41</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
</code></pre></div>
</td></tr></table>




  <div class="doc doc-children">













  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="n">H</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializer.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_gen_hs</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">Integral</span><span class="p">)):</span>
                <span class="k">yield</span> <span class="n">H</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">a</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">_hs</span><span class="p">:</span>  <span class="c1"># pylint: disable=protected-access</span>
                    <span class="k">yield</span> <span class="n">h</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;type </span><span class="si">{}</span><span class="s2"> incompatible initializer for </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>

    <span class="n">hs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">_gen_hs</span><span class="p">()</span> <span class="k">if</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">hs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">hs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_homogeneous</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span>
</code></pre></div>
        </details>
    </div>

  </div>











  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.appearances_in_rolls" class="doc doc-heading">
<code class="highlight language-python"><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This method should be considered experimental and may disappear in future
versions. While it does provide a performance improvement over other
techniques, it is not significant for most applications, and rarely
justifies the corresponding reduction in readability.</p>
</div>
<p>Returns a histogram where the outcomes (keys) are the number of times <em>outcome</em>
appears, and the counts are the number of rolls where <em>outcome</em> appears
precisely that number of times. Equivalent to <code>H((sum(1 for v in roll if v ==
outcome), count) for roll, count in self.rolls_with_counts())</code>, but much more
efficient.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">p_2d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Least efficient, by far</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d4_2d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">d4</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d6</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">roll</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">3</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">p_3d4_2d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">675</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">945</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">522</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Pretty darned efficient, generalizable to other boolean inquiries, and</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># arguably the most readable</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d4_eq3</span><span class="p">,</span> <span class="n">d6_eq3</span> <span class="o">=</span> <span class="n">d4</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">d6</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">2</span><span class="nd">@d6_eq3</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">675</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">945</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">522</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Most efficient for large sets of dice</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d4_2d6</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">675</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">945</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">522</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>Based on some rudimentary testing, this method appears to converge on being
almost twice (about <span class="arithmatex">\(\frac{7}{4}\)</span>) as efficient as the boolean accumulation
technique for larger sets:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="mi">3</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">2</span><span class="nd">@d6_eq3</span>
<span class="mi">287</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">6.96</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">402</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">5.59</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="mi">9</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">6</span><span class="nd">@d6_eq3</span>
<span class="mi">845</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">7.89</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">9</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">597</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">9.46</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">7</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="mi">90</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">60</span><span class="nd">@d6_eq3</span>
<span class="mf">24.7</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">380</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">8</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">90</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">60</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mf">7.5</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">84.6</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="mi">900</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">600</span><span class="nd">@d6_eq3</span>
<span class="mf">3.34</span> <span class="n">s</span> <span class="err">±</span> <span class="mf">19.3</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]:</span> <span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">900</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">600</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mf">1.93</span> <span class="n">s</span> <span class="err">±</span> <span class="mf">14.3</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">appearances_in_rolls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Experimental&quot;</span>

<span class="sd">        This method should be considered experimental and may disappear in future</span>
<span class="sd">        versions. While it does provide a performance improvement over other</span>
<span class="sd">        techniques, it is not significant for most applications, and rarely</span>
<span class="sd">        justifies the corresponding reduction in readability.</span>

<span class="sd">    Returns a histogram where the outcomes (keys) are the number of times *outcome*</span>
<span class="sd">    appears, and the counts are the number of rolls where *outcome* appears</span>
<span class="sd">    precisely that number of times. Equivalent to ``H((sum(1 for v in roll if v ==</span>
<span class="sd">    outcome), count) for roll, count in self.rolls_with_counts())``, but much more</span>
<span class="sd">    efficient.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; p_2d6 = P(6, 6)</span>
<span class="sd">    &gt;&gt;&gt; list(p_2d6.rolls_with_counts())</span>
<span class="sd">    [((1, 1), 1), ((1, 2), 2), ((1, 3), 2), ((1, 4), 2), ((1, 5), 2), ((1, 6), 2), ...]</span>
<span class="sd">    &gt;&gt;&gt; p_2d6.appearances_in_rolls(1)</span>
<span class="sd">    H({0: 25, 1: 10, 2: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; # Least efficient, by far</span>
<span class="sd">    &gt;&gt;&gt; d4, d6 = H(4), H(6)</span>
<span class="sd">    &gt;&gt;&gt; p_3d4_2d6 = P(d4, d4, d4, d6, d6)</span>
<span class="sd">    &gt;&gt;&gt; H((sum(1 for v in roll if v == 3), count) for roll, count in p_3d4_2d6.rolls_with_counts())</span>
<span class="sd">    H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; # Pretty darned efficient, generalizable to other boolean inquiries, and</span>
<span class="sd">    &gt;&gt;&gt; # arguably the most readable</span>
<span class="sd">    &gt;&gt;&gt; d4_eq3, d6_eq3 = d4.eq(2), d6.eq(2)</span>
<span class="sd">    &gt;&gt;&gt; 3@d4_eq3 + 2@d6_eq3</span>
<span class="sd">    H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; # Most efficient for large sets of dice</span>
<span class="sd">    &gt;&gt;&gt; p_3d4_2d6.appearances_in_rolls(3)</span>
<span class="sd">    H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    Based on some rudimentary testing, this method appears to converge on being</span>
<span class="sd">    almost twice (about $\frac{7}{4}$) as efficient as the boolean accumulation</span>
<span class="sd">    technique for larger sets:</span>

<span class="sd">    ```python</span>
<span class="sd">    In [3]: %timeit 3@d4_eq3 + 2@d6_eq3</span>
<span class="sd">    287 µs ± 6.96 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)</span>

<span class="sd">    In [4]: %timeit P(3@P(4), 2@P(6)).appearances_in_rolls(3)</span>
<span class="sd">    402 µs ± 5.59 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)</span>

<span class="sd">    In [5]: %timeit 9@d4_eq3 + 6@d6_eq3</span>
<span class="sd">    845 µs ± 7.89 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)</span>

<span class="sd">    In [6]: %timeit P(9@P(4), 6@P(6)).appearances_in_rolls(3)</span>
<span class="sd">    597 µs ± 9.46 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)</span>

<span class="sd">    In [7]: %timeit 90@d4_eq3 + 60@d6_eq3</span>
<span class="sd">    24.7 ms ± 380 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="sd">    In [8]: %timeit P(90@P(4), 60@P(6)).appearances_in_rolls(3)</span>
<span class="sd">    7.5 ms ± 84.6 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>

<span class="sd">    In [9]: %timeit 900@d4_eq3 + 600@d6_eq3</span>
<span class="sd">    3.34 s ± 19.3 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="sd">    In [10]: %timeit P(900@P(4), 600@P(6)).appearances_in_rolls(3)</span>
<span class="sd">    1.93 s ± 14.3 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">group_counters</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Counter</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">):</span>
        <span class="n">group_counter</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="n">_OutcomeT</span><span class="p">]</span> <span class="o">=</span> <span class="n">counter</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">_count_of_exactly_k_of_outcome_in_n_of_h</span><span class="p">(</span>
                <span class="n">h</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span>
            <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">group_counters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_counter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sum_w_start</span><span class="p">(</span>
        <span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">group_counter</span><span class="p">)</span> <span class="k">for</span> <span class="n">group_counter</span> <span class="ow">in</span> <span class="n">group_counters</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="n">H</span><span class="p">({})</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().eq(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.eq"><code>H.eq</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().eq(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.eq``][dyce.h.H.eq].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.even" class="doc doc-heading">
<code class="highlight language-python"><span class="n">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().even()</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.even"><code>H.even</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().even()``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.even``][dyce.h.H.even].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">even</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.explode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().explode(max_depth)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a>
and <a href="#dyce.h.H.explode"><code>H.explode</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().explode(max_depth)``. See the [``h`` method][dyce.p.P.h]</span>
<span class="sd">    and [``H.explode``][dyce.h.H.explode].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">max_depth</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().ge(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.ge"><code>H.ge</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().ge(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.ge``][dyce.h.H.ge].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().gt(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.gt"><code>H.gt</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().gt(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.gt``][dyce.h.H.gt].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.h" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Roughly equivalent to <code>H( (sum(roll), count) for roll, count in
self.rolls_with_counts(*which) )</code> with some short-circuit optimizations.</p>
<p>When provided no arguments, <code>h</code> combines (or “flattens”) contained histograms in
accordance with the <a href="#dyce.h.HAbleT"><code>HAbleT</code> protocol</a>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>If one or more arguments are provided, this method sums subsets of outcomes
those arguments identify for each roll. Outcomes are ordered from least (index
<code>0</code>) to greatest (index <code>-1</code> or <code>len(self) - 1</code>). Identifiers can be
<code>int</code>s or <code>slice</code>s, and can be mixed.</p>
<p>Taking the greatest of two six-sided dice can be modeled as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p_2d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">4.47</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">1.40</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">1.97</span>
  <span class="mi">1</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">3</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">4</span> <span class="o">|</span>  <span class="mf">19.44</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">25.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">30.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">###############</span>
</code></pre></div>
</td></tr></table>
<p>Taking the greatest two and least two faces of ten four-sided dice (<code>10d4</code>)
can be modeled as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_10d4</span> <span class="o">=</span> <span class="mi">10</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_10d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1012</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">5030</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">51973</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">168760</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">595004</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">168760</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">51973</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">5030</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1012</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p_10d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>   <span class="mf">10.00</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.91</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.84</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">5</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">6</span> <span class="o">|</span>   <span class="mf">0.10</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">7</span> <span class="o">|</span>   <span class="mf">0.48</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">8</span> <span class="o">|</span>   <span class="mf">4.96</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">16.09</span><span class="o">%</span> <span class="o">|</span><span class="c1">##############</span>
 <span class="mi">10</span> <span class="o">|</span>  <span class="mf">56.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">##################################################</span>
 <span class="mi">11</span> <span class="o">|</span>  <span class="mf">16.09</span><span class="o">%</span> <span class="o">|</span><span class="c1">##############</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">4.96</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
 <span class="mi">13</span> <span class="o">|</span>   <span class="mf">0.48</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">14</span> <span class="o">|</span>   <span class="mf">0.10</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">15</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">16</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
</code></pre></div>
</td></tr></table>
<p>Taking all outcomes exactly once is equivalent to summing the histograms in the
pool.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d233445</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">d6</span><span class="p">,</span> <span class="n">d233445</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d233445</span> <span class="o">+</span> <span class="n">d233445</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Roughly equivalent to ``H( (sum(roll), count) for roll, count in</span>
<span class="sd">    self.rolls_with_counts(*which) )`` with some short-circuit optimizations.</span>

<span class="sd">    When provided no arguments, ``h`` combines (or “flattens”) contained histograms in</span>
<span class="sd">    accordance with the [``HAbleT`` protocol][dyce.h.HAbleT]:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; (2@P(6)).h()</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    If one or more arguments are provided, this method sums subsets of outcomes</span>
<span class="sd">    those arguments identify for each roll. Outcomes are ordered from least (index</span>
<span class="sd">    ``0``) to greatest (index ``-1`` or ``len(self) - 1``). Identifiers can be</span>
<span class="sd">    ``int``s or ``slice``s, and can be mixed.</span>

<span class="sd">    Taking the greatest of two six-sided dice can be modeled as:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; p_2d6 = 2@P(6)</span>
<span class="sd">    &gt;&gt;&gt; p_2d6.h(-1)</span>
<span class="sd">    H({1: 1, 2: 3, 3: 5, 4: 7, 5: 9, 6: 11})</span>
<span class="sd">    &gt;&gt;&gt; print(p_2d6.h(-1).format(width=65))</span>
<span class="sd">    avg |    4.47</span>
<span class="sd">    std |    1.40</span>
<span class="sd">    var |    1.97</span>
<span class="sd">      1 |   2.78% |#</span>
<span class="sd">      2 |   8.33% |####</span>
<span class="sd">      3 |  13.89% |######</span>
<span class="sd">      4 |  19.44% |#########</span>
<span class="sd">      5 |  25.00% |############</span>
<span class="sd">      6 |  30.56% |###############</span>

<span class="sd">    ```</span>

<span class="sd">    Taking the greatest two and least two faces of ten four-sided dice (``10d4``)</span>
<span class="sd">    can be modeled as:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; p_10d4 = 10@P(4)</span>
<span class="sd">    &gt;&gt;&gt; p_10d4.h(slice(2), slice(-2, None))</span>
<span class="sd">    H({4: 1, 5: 10, 6: 1012, 7: 5030, 8: 51973, 9: 168760, 10: 595004, 11: 168760, 12: 51973, 13: 5030, 14: 1012, 15: 10, 16: 1})</span>
<span class="sd">    &gt;&gt;&gt; print(p_10d4.h(slice(2), slice(-2, None)).format(width=65, scaled=True))</span>
<span class="sd">    avg |   10.00</span>
<span class="sd">    std |    0.91</span>
<span class="sd">    var |    0.84</span>
<span class="sd">      4 |   0.00% |</span>
<span class="sd">      5 |   0.00% |</span>
<span class="sd">      6 |   0.10% |</span>
<span class="sd">      7 |   0.48% |</span>
<span class="sd">      8 |   4.96% |####</span>
<span class="sd">      9 |  16.09% |##############</span>
<span class="sd">     10 |  56.74% |##################################################</span>
<span class="sd">     11 |  16.09% |##############</span>
<span class="sd">     12 |   4.96% |####</span>
<span class="sd">     13 |   0.48% |</span>
<span class="sd">     14 |   0.10% |</span>
<span class="sd">     15 |   0.00% |</span>
<span class="sd">     16 |   0.00% |</span>

<span class="sd">    ```</span>

<span class="sd">    Taking all outcomes exactly once is equivalent to summing the histograms in the</span>
<span class="sd">    pool.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d233445 = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">    &gt;&gt;&gt; p = 2@P(d6, d233445)</span>
<span class="sd">    &gt;&gt;&gt; p.h(slice(None)) == p.h() == d6 + d6 + d233445 + d233445</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_analyze_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="c1"># The caller selected all dice in the pool exactly i // n times, so we</span>
            <span class="c1"># can short-circuit roll enumeration</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="o">%</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">*</span> <span class="n">i</span> <span class="o">//</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="n">which</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The caller offered no selection</span>
        <span class="k">return</span> <span class="n">sum_w_start</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">H</span><span class="p">({}))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().le(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.le"><code>H.le</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().le(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.le``][dyce.h.H.le].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().lt(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.lt"><code>H.lt</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().lt(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.lt``][dyce.h.H.lt].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().ne(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.ne"><code>H.ne</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().ne(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.ne``][dyce.h.H.ne].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.odd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().odd()</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.odd"><code>H.odd</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().odd()``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.odd``][dyce.h.H.odd].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">odd</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.roll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RollT</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns (weighted) random outcomes from contained histograms.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RollT</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns (weighted) random outcomes from contained histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">roll</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.rolls_with_counts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rolls_with_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns an iterator yielding 2-tuples (pairs) that, collectively, enumerate all
possible outcomes for the pool. The first item in the 2-tuple is a sorted
sequence of the outcomes for a distinct roll. The second is the count for that
roll. Outcomes in each roll are ordered least to greatest.</p>
<p>If one or more arguments are provided, this methods selects subsets of outcomes
for each roll. Outcomes in each roll are ordered from least (index <code>0</code>) to
greatest (index <code>-1</code> or <code>len(self) - 1</code>). Identifiers can be <code>int</code>s or
<code>slice</code>s, and can be mixed for more flexible selections:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">accumulate_roll_counts</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">roll_counts</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">roll_counts</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">counter</span><span class="p">[</span><span class="n">roll</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
<span class="o">...</span>   <span class="k">return</span> <span class="n">counter</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_6d6</span> <span class="o">=</span> <span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">every_other_d6</span> <span class="o">=</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)))</span> <span class="p">;</span> <span class="n">every_other_d6</span>
<span class="n">Counter</span><span class="p">({(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">4110</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">3390</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">3330</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">13</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>One way to model the likelihood of achieving a “Yhatzee” (i.e., where five
six-sided dice show the same face) on a single roll by checking rolls for where
the least and greatest outcomes are the same:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_5d6</span> <span class="o">=</span> <span class="mi">5</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">yhatzee_on_single_roll</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span>
<span class="o">...</span>   <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">roll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">roll</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="o">...</span>   <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span>
<span class="o">...</span>   <span class="ow">in</span> <span class="n">p_5d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">()</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">yhatzee_on_single_roll</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">{</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mf">99.92</span><span class="o">%</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span>  <span class="mf">0.08</span><span class="o">%</span><span class="p">}</span>
</code></pre></div>
</td></tr></table>
<div class="admonition note">
<p class="admonition-title">In the general case, rolls may appear more than once.</p>
</div>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>
<p>In the above, <code>(1, 2)</code> appears a total of two times, each with counts of one.</p>
<p>However, if the pool is homogeneous (meaning it only contains identical
histograms), rolls (before selection) are not repeated. (See the note on
implementation below.)</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">((</span><span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>
<p>Either way, by summing and counting all rolls, we can confirm identity:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d233445</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">d6</span><span class="p">,</span> <span class="n">d233445</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d233445</span> <span class="o">+</span> <span class="n">d233445</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>This method does not try to outsmart callers by (mis)interpreting selection
arguments. It honors selection identifier order and any redundancy:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_d3_d4</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Select the second, first, then second (again) elements</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">p_d3_d4</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="o">...</span><span class="p">,</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>
<p>Selecting the same outcomes, but in a different order is not immediately
comparable:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">select_0_1</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p_d3_d4</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">select_1_0</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">p_d3_d4</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">select_0_1</span> <span class="o">==</span> <span class="n">select_1_0</span>
<span class="kc">False</span>
</code></pre></div>
</td></tr></table>
<p>Equivalence can be tested when selected outcomes are sorted:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sorted_0_1</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_0_1</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sorted_1_0</span> <span class="o">=</span> <span class="p">[(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_1_0</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sorted_0_1</span> <span class="o">==</span> <span class="n">sorted_1_0</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>They can also be summed and counted which is equivalent to calling the
<a href="#dyce.p.P.h"><code>h</code> method</a> with identical selection arguments.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">summed_0_1</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_0_1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">summed_1_0</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_1_0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">summed_0_1</span> <span class="o">==</span> <span class="n">summed_1_0</span> <span class="o">==</span> <span class="n">p_d3_d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">p_d3_d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<div class="admonition info">
<p class="admonition-title">About the implementation</p>
<p>Enumeration is substantially more efficient for homogeneous pools than
heterogeneous ones, because we are able to avoid the expensive enumeration
of the Cartesian product using several techniques.</p>
<p>Taking <span class="arithmatex">\(k\)</span> outcomes, where <span class="arithmatex">\(k\)</span> selects fewer than all <span class="arithmatex">\(n\)</span> outcomes a
homogeneous pool benefits from <a href="https://rpg.stackexchange.com/a/166663/71245">Ilmari Karonen’s
optimization</a>, which appears
to scale geometrically with <span class="arithmatex">\(k\)</span> times some factor of <span class="arithmatex">\(n\)</span> (e.g., <span class="arithmatex">\(\log n\)</span>,
but I haven’t bothered to figure that out yet), such that—in observed
testing, at least—it is generally the fastest approach for <span class="arithmatex">\(k &lt; n\)</span>.</p>
<p>Where <span class="arithmatex">\(k = n\)</span>, we leverage the <a href="https://en.wikipedia.org/wiki/Permutation#Permutations_of_multisets"><em>multinomial
coefficient</em></a>,
which appears to scale generally with <span class="arithmatex">\(n\)</span>:</p>
<div class="arithmatex">\[
{{n} \choose {{{k}_{1}},{{k}_{2}},\ldots,{{k}_{m}}}}
= {\frac {{n}!} {{{k}_{1}}! {{k}_{2}}! \cdots {{k}_{m}}!}}
\]</div>
<p>We enumerate combinations with replacements, and then the compute the number
of permutations with repetitions for each combination. Consider
<code>n@P(H(m))</code>. Enumerating combinations with replacements would yield all
unique rolls:</p>
<p><code>((1, 1, …, 1), (1, 1, …, 2), …, (1, 1, …, m), …, (m - 1, m, …, m), (m, m, …, m))</code></p>
<p>To determine the count for a particular roll <code>(a, b, …, n)</code>, we compute
the multinomial coefficient for that roll and multiply by the scalar
<code>H(m)[a] * H(m)[b] * … * H(m)[n]</code>. (See
<a href="https://www.lucamoroni.it/the-dice-roll-sum-problem/">this</a> for an in-depth
exploration of the topic.)</p>
<p>Further, this implementation attempts to optimize heterogeneous pools by
breaking them into homogeneous groups before computing the Cartesian product
of those sub-results. This approach allows homogeneous pools to be ordered
without duplicates, where heterogeneous ones offer no such guarantees.</p>
<p>As expected, this optimization allows the performance of arbitrary selection
from mixed pools to sit between that of purely homogeneous and purely
heterogeneous ones. Note, however, that all three appear to scale
geometrically in some way.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">P</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
   <span class="o">...</span><span class="p">:</span>   <span class="n">p</span> <span class="o">=</span> <span class="n">n</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
   <span class="o">...</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">).h(slice(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)):&quot;</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>     <span class="o">%</span><span class="k">timeit</span> p.h(slice(i))
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mf">1.35</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">23.4</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mf">3.15</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">516</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mf">5.37</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">182</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mf">10.5</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">1.3</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mf">5.58</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">25.3</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mf">9.81</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">171</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">6</span><span class="p">)):</span>
<span class="mf">14.7</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">430</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">7</span><span class="p">)):</span>
<span class="mf">20.4</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">328</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">3</span><span class="p">]:</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
   <span class="o">...</span><span class="p">:</span>   <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">n</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="o">*</span><span class="p">[</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
   <span class="o">...</span><span class="p">:</span>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
   <span class="o">...</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">).h(slice(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)):&quot;</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>     <span class="o">%</span><span class="k">timeit</span> p.h(slice(i))
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mf">16.1</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">1.09</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mi">39</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">602</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mf">40.3</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">3.49</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mf">46.2</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">7.43</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mi">538</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">9.46</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mi">534</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">30.4</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">6</span><span class="p">)):</span>
<span class="mi">536</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">13.2</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">7</span><span class="p">)):</span>
<span class="mi">604</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">52.4</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]:</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">):</span>
   <span class="o">...</span><span class="p">:</span>   <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
   <span class="o">...</span><span class="p">:</span>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
   <span class="o">...</span><span class="p">:</span>     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">).h(slice(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)):&quot;</span><span class="p">)</span>
   <span class="o">...</span><span class="p">:</span>     <span class="o">%</span><span class="k">timeit</span> p.h(slice(i))
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mi">145</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">4.59</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mi">147</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">3.6</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mi">158</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">1.38</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mi">147</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">691</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mf">6.09</span> <span class="n">s</span> <span class="err">±</span> <span class="mf">14.4</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mf">6.11</span> <span class="n">s</span> <span class="err">±</span> <span class="mf">36.9</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">6</span><span class="p">)):</span>
<span class="mf">6.25</span> <span class="n">s</span> <span class="err">±</span> <span class="mf">47.5</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="o">...</span><span class="p">,</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">7</span><span class="p">)):</span>
<span class="mf">6.31</span> <span class="n">s</span> <span class="err">±</span> <span class="mf">42.2</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span> <span class="n">loop</span> <span class="n">each</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
</div>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rolls_with_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an iterator yielding 2-tuples (pairs) that, collectively, enumerate all</span>
<span class="sd">    possible outcomes for the pool. The first item in the 2-tuple is a sorted</span>
<span class="sd">    sequence of the outcomes for a distinct roll. The second is the count for that</span>
<span class="sd">    roll. Outcomes in each roll are ordered least to greatest.</span>

<span class="sd">    If one or more arguments are provided, this methods selects subsets of outcomes</span>
<span class="sd">    for each roll. Outcomes in each roll are ordered from least (index ``0``) to</span>
<span class="sd">    greatest (index ``-1`` or ``len(self) - 1``). Identifiers can be ``int``s or</span>
<span class="sd">    ``slice``s, and can be mixed for more flexible selections:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; from collections import Counter</span>
<span class="sd">    &gt;&gt;&gt; def accumulate_roll_counts(counter, roll_counts):</span>
<span class="sd">    ...   for roll, count in roll_counts:</span>
<span class="sd">    ...     counter[roll] += count</span>
<span class="sd">    ...   return counter</span>
<span class="sd">    &gt;&gt;&gt; p_6d6 = 6@P(6)</span>
<span class="sd">    &gt;&gt;&gt; every_other_d6 = accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(slice(None, None, -2))) ; every_other_d6</span>
<span class="sd">    Counter({(6, 4, 2): 4110, (6, 5, 3): 3390, (6, 4, 3): 3330, ..., (3, 3, 3): 13, (2, 2, 2): 7, (1, 1, 1): 1})</span>
<span class="sd">    &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(5, 3, 1)) == every_other_d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(*range(5, 0, -2))) == every_other_d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(*(i for i in range(6, 0, -1) if i % 2 == 1))) == every_other_d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    One way to model the likelihood of achieving a “Yhatzee” (i.e., where five</span>
<span class="sd">    six-sided dice show the same face) on a single roll by checking rolls for where</span>
<span class="sd">    the least and greatest outcomes are the same:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; p_5d6 = 5@P(6)</span>
<span class="sd">    &gt;&gt;&gt; yhatzee_on_single_roll = H(</span>
<span class="sd">    ...   (1 if roll[0] == roll[-1] else 0, count)</span>
<span class="sd">    ...   for roll, count</span>
<span class="sd">    ...   in p_5d6.rolls_with_counts()</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; print(yhatzee_on_single_roll.format(width=0))</span>
<span class="sd">    {..., 0: 99.92%, 1:  0.08%}</span>

<span class="sd">    ```</span>

<span class="sd">    !!! note &quot;In the general case, rolls may appear more than once.&quot;</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list(P(H(2), H(3)).rolls_with_counts())</span>
<span class="sd">    [((1, 1), 1), ((1, 2), 1), ((1, 3), 1), ((1, 2), 1), ((2, 2), 1), ((2, 3), 1)]</span>

<span class="sd">    ```</span>

<span class="sd">    In the above, `(1, 2)` appears a total of two times, each with counts of one.</span>

<span class="sd">    However, if the pool is homogeneous (meaning it only contains identical</span>
<span class="sd">    histograms), rolls (before selection) are not repeated. (See the note on</span>
<span class="sd">    implementation below.)</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list((2@P(H((-1, 0, 1)))).rolls_with_counts())</span>
<span class="sd">    [((-1, -1), 1), ((-1, 0), 2), ((-1, 1), 2), ((0, 0), 1), ((0, 1), 2), ((1, 1), 1)]</span>

<span class="sd">    ```</span>

<span class="sd">    Either way, by summing and counting all rolls, we can confirm identity:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d233445 = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">    &gt;&gt;&gt; p = 2@P(d6, d233445)</span>
<span class="sd">    &gt;&gt;&gt; H((sum(roll), count) for roll, count in p.rolls_with_counts()) == p.h() == d6 + d6 + d233445 + d233445</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    This method does not try to outsmart callers by (mis)interpreting selection</span>
<span class="sd">    arguments. It honors selection identifier order and any redundancy:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; p_d3_d4 = P(H(3), H(4))</span>
<span class="sd">    &gt;&gt;&gt; # Select the second, first, then second (again) elements</span>
<span class="sd">    &gt;&gt;&gt; list(p_d3_d4.rolls_with_counts(-1, 0, 1))</span>
<span class="sd">    [((1, 1, 1), 1), ((2, 1, 2), 1), ((3, 1, 3), 1), ((4, 1, 4), 1), ..., ((3, 1, 3), 1), ((3, 2, 3), 1), ((3, 3, 3), 1), ((4, 3, 4), 1)]</span>

<span class="sd">    ```</span>

<span class="sd">    Selecting the same outcomes, but in a different order is not immediately</span>
<span class="sd">    comparable:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; select_0_1 = list(p_d3_d4.rolls_with_counts(0, 1))</span>
<span class="sd">    &gt;&gt;&gt; select_1_0 = list(p_d3_d4.rolls_with_counts(1, 0))</span>
<span class="sd">    &gt;&gt;&gt; select_0_1 == select_1_0</span>
<span class="sd">    False</span>

<span class="sd">    ```</span>

<span class="sd">    Equivalence can be tested when selected outcomes are sorted:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; sorted_0_1 = [(sorted(roll), count) for roll, count in select_0_1]</span>
<span class="sd">    &gt;&gt;&gt; sorted_1_0 = [(sorted(roll), count) for roll, count in select_1_0]</span>
<span class="sd">    &gt;&gt;&gt; sorted_0_1 == sorted_1_0</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    They can also be summed and counted which is equivalent to calling the</span>
<span class="sd">    [``h`` method][dyce.p.P.h] with identical selection arguments.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; summed_0_1 = H((sum(roll), count) for roll, count in select_0_1)</span>
<span class="sd">    &gt;&gt;&gt; summed_1_0 = H((sum(roll), count) for roll, count in select_1_0)</span>
<span class="sd">    &gt;&gt;&gt; summed_0_1 == summed_1_0 == p_d3_d4.h(0, 1) == p_d3_d4.h(1, 0)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    !!! info &quot;About the implementation&quot;</span>

<span class="sd">        Enumeration is substantially more efficient for homogeneous pools than</span>
<span class="sd">        heterogeneous ones, because we are able to avoid the expensive enumeration</span>
<span class="sd">        of the Cartesian product using several techniques.</span>

<span class="sd">        Taking $k$ outcomes, where $k$ selects fewer than all $n$ outcomes a</span>
<span class="sd">        homogeneous pool benefits from [Ilmari Karonen’s</span>
<span class="sd">        optimization](https://rpg.stackexchange.com/a/166663/71245), which appears</span>
<span class="sd">        to scale geometrically with $k$ times some factor of $n$ (e.g., $\log n$,</span>
<span class="sd">        but I haven’t bothered to figure that out yet), such that—in observed</span>
<span class="sd">        testing, at least—it is generally the fastest approach for $k &lt; n$.</span>

<span class="sd">        Where $k = n$, we leverage the [*multinomial</span>
<span class="sd">        coefficient*](https://en.wikipedia.org/wiki/Permutation#Permutations_of_multisets),</span>
<span class="sd">        which appears to scale generally with $n$:</span>

<span class="sd">        $$</span>
<span class="sd">        {{n} \choose {{{k}_{1}},{{k}_{2}},\ldots,{{k}_{m}}}}</span>
<span class="sd">        = {\frac {{n}!} {{{k}_{1}}! {{k}_{2}}! \cdots {{k}_{m}}!}}</span>
<span class="sd">        $$</span>

<span class="sd">        We enumerate combinations with replacements, and then the compute the number</span>
<span class="sd">        of permutations with repetitions for each combination. Consider</span>
<span class="sd">        ``n@P(H(m))``. Enumerating combinations with replacements would yield all</span>
<span class="sd">        unique rolls:</span>

<span class="sd">        ``((1, 1, …, 1), (1, 1, …, 2), …, (1, 1, …, m), …, (m - 1, m, …, m), (m, m, …, m))``</span>

<span class="sd">        To determine the count for a particular roll ``(a, b, …, n)``, we compute</span>
<span class="sd">        the multinomial coefficient for that roll and multiply by the scalar</span>
<span class="sd">        ``H(m)[a] * H(m)[b] * … * H(m)[n]``. (See</span>
<span class="sd">        [this](https://www.lucamoroni.it/the-dice-roll-sum-problem/) for an in-depth</span>
<span class="sd">        exploration of the topic.)</span>

<span class="sd">        Further, this implementation attempts to optimize heterogeneous pools by</span>
<span class="sd">        breaking them into homogeneous groups before computing the Cartesian product</span>
<span class="sd">        of those sub-results. This approach allows homogeneous pools to be ordered</span>
<span class="sd">        without duplicates, where heterogeneous ones offer no such guarantees.</span>

<span class="sd">        As expected, this optimization allows the performance of arbitrary selection</span>
<span class="sd">        from mixed pools to sit between that of purely homogeneous and purely</span>
<span class="sd">        heterogeneous ones. Note, however, that all three appear to scale</span>
<span class="sd">        geometrically in some way.</span>

<span class="sd">        ```ipython</span>
<span class="sd">        In [1]: from dyce import H, P</span>

<span class="sd">        In [2]: for n in (6, 8):</span>
<span class="sd">           ...:   p = n@P(6)</span>
<span class="sd">           ...:   for i in range(len(p) - 4, len(p)):</span>
<span class="sd">           ...:     print(f&quot;({p}).h(slice({i})):&quot;)</span>
<span class="sd">           ...:     %timeit p.h(slice(i))</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6)).h(slice(2)):</span>
<span class="sd">        1.35 ms ± 23.4 µs per loop (mean ± std. dev. of 7 runs, 1000 loops each)</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6)).h(slice(3)):</span>
<span class="sd">        3.15 ms ± 516 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6)).h(slice(4)):</span>
<span class="sd">        5.37 ms ± 182 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6)).h(slice(5)):</span>
<span class="sd">        10.5 ms ± 1.3 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6, 6, 6)).h(slice(4)):</span>
<span class="sd">        5.58 ms ± 25.3 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6, 6, 6)).h(slice(5)):</span>
<span class="sd">        9.81 ms ± 171 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6, 6, 6)).h(slice(6)):</span>
<span class="sd">        14.7 ms ± 430 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>
<span class="sd">        (P(6, 6, 6, 6, 6, 6, 6, 6)).h(slice(7)):</span>
<span class="sd">        20.4 ms ± 328 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>

<span class="sd">        In [3]: for n in (3, 4):</span>
<span class="sd">           ...:   p = P(n@P(6), *[H(6) - m for m in range(n, 0, -1)])</span>
<span class="sd">           ...:   for i in range(len(p) - 4, len(p)):</span>
<span class="sd">           ...:     print(f&quot;({p}).h(slice({i})):&quot;)</span>
<span class="sd">           ...:     %timeit p.h(slice(i))</span>
<span class="sd">        (P(H({-2: 1, ..., 3: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6)).h(slice(2)):</span>
<span class="sd">        16.1 ms ± 1.09 ms per loop (mean ± std. dev. of 7 runs, 100 loops each)</span>
<span class="sd">        (P(H({-2: 1, ..., 3: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6)).h(slice(3)):</span>
<span class="sd">        39 ms ± 602 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(H({-2: 1, ..., 3: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6)).h(slice(4)):</span>
<span class="sd">        40.3 ms ± 3.49 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(H({-2: 1, ..., 3: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6)).h(slice(5)):</span>
<span class="sd">        46.2 ms ± 7.43 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(H({-3: 1, ..., 2: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6, 6)).h(slice(4)):</span>
<span class="sd">        538 ms ± 9.46 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">        (P(H({-3: 1, ..., 2: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6, 6)).h(slice(5)):</span>
<span class="sd">        534 ms ± 30.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">        (P(H({-3: 1, ..., 2: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6, 6)).h(slice(6)):</span>
<span class="sd">        536 ms ± 13.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">        (P(H({-3: 1, ..., 2: 1}), ..., H({0: 1, ..., 5: 1}), 6, 6, 6, 6)).h(slice(7)):</span>
<span class="sd">        604 ms ± 52.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>

<span class="sd">        In [4]: for n in (6, 8):</span>
<span class="sd">           ...:   p = P(*[H(6) - m for m in range(n, 0, -1)])</span>
<span class="sd">           ...:   for i in range(len(p) - 4, len(p)):</span>
<span class="sd">           ...:     print(f&quot;({p}).h(slice({i})):&quot;)</span>
<span class="sd">           ...:     %timeit p.h(slice(i))</span>
<span class="sd">        (P(H({-5: 1, ..., 0: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(2)):</span>
<span class="sd">        145 ms ± 4.59 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(H({-5: 1, ..., 0: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(3)):</span>
<span class="sd">        147 ms ± 3.6 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(H({-5: 1, ..., 0: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(4)):</span>
<span class="sd">        158 ms ± 1.38 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(H({-5: 1, ..., 0: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(5)):</span>
<span class="sd">        147 ms ± 691 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</span>
<span class="sd">        (P(H({-7: 1, ..., -2: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(4)):</span>
<span class="sd">        6.09 s ± 14.4 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">        (P(H({-7: 1, ..., -2: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(5)):</span>
<span class="sd">        6.11 s ± 36.9 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">        (P(H({-7: 1, ..., -2: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(6)):</span>
<span class="sd">        6.25 s ± 47.5 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">        (P(H({-7: 1, ..., -2: 1}), ..., H({0: 1, ..., 5: 1}))).h(slice(7)):</span>
<span class="sd">        6.31 s ± 42.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)</span>
<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">which</span><span class="p">:</span>
        <span class="n">i</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_analyze_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rolls_with_counts_iter</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">))</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Based on cursory performance analysis, calling the homogeneous</span>
            <span class="c1"># implementation directly provides about a 15% performance savings over</span>
            <span class="c1"># merely falling through to _rwc_heterogeneous_h_groups. Maybe</span>
            <span class="c1"># itertools.product adds significant overhead?</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">hn</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">hn</span> <span class="o">==</span> <span class="n">n</span>

            <span class="k">if</span> <span class="n">i</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">_rwc_homogeneous_n_h_using_karonen_partial_selection</span><span class="p">(</span>
                        <span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="mi">0</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">_rwc_homogeneous_n_h_using_multinomial_coefficient</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="n">_rwc_heterogeneous_h_groups</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sorted_outcomes_for_roll</span><span class="p">,</span> <span class="n">roll_count</span> <span class="ow">in</span> <span class="n">rolls_with_counts_iter</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">taken_outcomes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">_getitems</span><span class="p">(</span><span class="n">sorted_outcomes_for_roll</span><span class="p">,</span> <span class="n">which</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">taken_outcomes</span> <span class="o">=</span> <span class="n">sorted_outcomes_for_roll</span>

        <span class="k">yield</span> <span class="n">taken_outcomes</span><span class="p">,</span> <span class="n">roll_count</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.substitute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substitute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expand</span><span class="p">:</span> <span class="n">_ExpandT</span><span class="p">,</span> <span class="n">coalesce</span><span class="p">:</span> <span class="n">_CoalesceT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().substitute(expand, coalesce, max_depth)</code>. See the
<a href="#dyce.p.P.h"><code>h</code> method</a> and <a href="#dyce.h.H.substitute"><code>H.substitute</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">expand</span><span class="p">:</span> <span class="n">_ExpandT</span><span class="p">,</span>
    <span class="n">coalesce</span><span class="p">:</span> <span class="n">_CoalesceT</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().substitute(expand, coalesce, max_depth)``. See the</span>
<span class="sd">    [``h`` method][dyce.p.P.h] and [``H.substitute``][dyce.h.H.substitute].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">expand</span><span class="p">,</span> <span class="n">coalesce</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.within" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().within(lo, hi, other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a>
and <a href="#dyce.h.H.within"><code>H.within</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().within(lo, hi, other)``. See the [``h`` method][dyce.p.P.h]</span>
<span class="sd">    and [``H.within``][dyce.h.H.within].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="dyce.h.HAbleT" class="doc doc-heading">
        <code>HAbleT</code>



</h2>

    <div class="doc doc-contents first">

      <p>A protocol whose implementer can be expressed as (or reduced to) an
<a href="#dyce.h.H"><code>H</code> object</a> by calling its <a href="#dyce.h.HAbleT.h"><code>h</code> method</a>. Currently,
only the <a href="#dyce.p.P"><code>P</code> class</a> implements this protocol, but this affords an
integration point for <code>dyce</code> users.</p>




  <div class="doc doc-children">











  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleT.h" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Express its implementer as an <a href="#dyce.h.H"><code>H</code> object</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Express its implementer as an [``H`` object][dyce.h.H].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="dyce.h.HAbleBinOpsMixin" class="doc doc-heading">
        <code>HAbleBinOpsMixin</code>



</h2>

    <div class="doc doc-contents first">

      <p>A “mix-in” class providing arithmetic operations for implementers of the
<a href="#dyce.h.HAbleT"><code>HAbleT</code> protocol</a>. The <a href="#dyce.p.P"><code>P</code> class</a> derives from this
class.</p>




  <div class="doc doc-children">









  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__add__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.add(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.add(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__and__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.and_(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.and_(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_and</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__floordiv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.floordiv(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.floordiv(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_floordiv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__mod__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.mod(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.mod(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_mod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__mul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.mul(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.mul(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_mul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__or__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.or_(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.or_(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_or</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__pow__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.pow(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.pow(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_pow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__radd__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.add(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.add(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_add</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rand__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.and_(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.and_(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_and</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rfloordiv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.floordiv(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.floordiv(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_floordiv</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rmod__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.mod(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.mod(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_mod</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rmul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.mul(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.mul(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_mul</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__ror__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__ror__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.or_(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__ror__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.or_(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_or</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rpow__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.pow(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.pow(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_pow</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rsub__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.sub(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.sub(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_sub</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rtruediv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.truediv(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.truediv(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_truediv</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__rxor__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rxor__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.xor(other, self.h())</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__rxor__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OutcomeT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.xor(other, self.h())``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_xor</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__sub__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.sub(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.sub(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_sub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__truediv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.truediv(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.truediv(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_truediv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.HAbleBinOpsMixin.__xor__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>operator.xor(self.h(), other)</code>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">HAbleT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``operator.xor(self.h(), other)``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">op_xor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../translations/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Applications &amp; translations" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Applications & translations
            </div>
          </div>
        </a>
      
      
        
        <a href="../dyce.plt/" class="md-footer__link md-footer__link--next" aria-label="Next: &lt;tt&gt;dyce.plt&lt;/tt&gt;" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              <tt>dyce.plt</tt>
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            <i>Copyright and other protections apply. Please see the accompanying <tt>LICENSE</tt> file for rights and restrictions governing use of this software. All rights not expressly waived or licensed are reserved. If that file is missing or appears to be modified from its original, then please contact the author before viewing or using this software in any capacity.</i>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.sections", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.b0710199.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.76f349be.min.js"></script>
      
        <script src="../img_theme.js"></script>
      
        <script src="../mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>