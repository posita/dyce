
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Simple Python tools for dice-based probabilities">
      
      
      
        <meta name="author" content="Matt Bogosian">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.1.4">
    
    
      
        <title>dyce - dyce</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.bde7dde4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ef6f36e2.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    <script>function __prefix(e){return new URL("..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dyce-package-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="dyce" class="md-header__button md-logo" aria-label="dyce" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dyce
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              <tt>dyce</tt>
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/posita/dyce/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="dyce" class="md-nav__button md-logo" aria-label="dyce" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    dyce
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/posita/dyce/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      <label class="md-nav__link" for="__nav_2">
        API
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="API" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <tt>dyce</tt>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        <tt>dyce</tt>
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dyce" class="md-nav__link">
    dyce
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dyce.h.H" class="md-nav__link">
    H
  </a>
  
    <nav class="md-nav" aria-label="H">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.concat" class="md-nav__link">
    concat()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.counts" class="md-nav__link">
    counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.data" class="md-nav__link">
    data()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.data_xy" class="md-nav__link">
    data_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.eq" class="md-nav__link">
    eq()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.even" class="md-nav__link">
    even()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.explode" class="md-nav__link">
    explode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.faces" class="md-nav__link">
    faces()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.format" class="md-nav__link">
    format()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.ge" class="md-nav__link">
    ge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.gt" class="md-nav__link">
    gt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.items" class="md-nav__link">
    items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.keys" class="md-nav__link">
    keys()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.le" class="md-nav__link">
    le()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.lowest_terms" class="md-nav__link">
    lowest_terms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.lt" class="md-nav__link">
    lt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.map" class="md-nav__link">
    map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.ne" class="md-nav__link">
    ne()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.odd" class="md-nav__link">
    odd()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.roll" class="md-nav__link">
    roll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.substitute" class="md-nav__link">
    substitute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.values" class="md-nav__link">
    values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.within" class="md-nav__link">
    within()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dyce.p.P" class="md-nav__link">
    P
  </a>
  
    <nav class="md-nav" aria-label="P">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.eq" class="md-nav__link">
    eq()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.even" class="md-nav__link">
    even()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.explode" class="md-nav__link">
    explode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.ge" class="md-nav__link">
    ge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.gt" class="md-nav__link">
    gt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.h" class="md-nav__link">
    h()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.le" class="md-nav__link">
    le()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.lt" class="md-nav__link">
    lt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.ne" class="md-nav__link">
    ne()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.odd" class="md-nav__link">
    odd()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.roll" class="md-nav__link">
    roll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.rolls_with_counts" class="md-nav__link">
    rolls_with_counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.substitute" class="md-nav__link">
    substitute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.within" class="md-nav__link">
    within()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../dyce.plt/" class="md-nav__link">
        <tt>dyce.plt</tt>
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contrib/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/posita/dyce/edit/master/docs/dyce.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <!--- -*- encoding: utf-8 -*-
  Copyright and other protections apply. Please see the accompanying LICENSE file for
  rights and restrictions governing use of this software. All rights not expressly
  waived or licensed are reserved. If that file is missing or appears to be modified
  from its original, then please contact the author before viewing or using this
  software in any capacity.

  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  !!!!!!!!!!!!!!! IMPORTANT: READ THIS BEFORE EDITING! !!!!!!!!!!!!!!!
  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  Please keep each sentence on its own unwrapped line.
  It looks like crap in a text editor, but it has no effect on rendering, and it allows much more useful diffs.
  Thank you!
-->

<h1 id="dyce-package-reference"><code>dyce</code> package reference</h1>


  <div class="doc doc-object doc-module">

<a id="dyce"></a>
    <div class="doc doc-contents first">



    </div>

  </div>

<p><code>dyce</code> provides two key primitives:</p>
<ul>
<li><a href="#dyce.h.H"><code>H</code></a> for histograms (outcomes or individual dice)</li>
<li><a href="#dyce.p.P"><code>P</code></a> for collections of histograms (pools)</li>
</ul>


  <div class="doc doc-object doc-class">



<h2 id="dyce.h.H" class="doc doc-heading">
        <code>H</code>



</h2>

    <div class="doc doc-contents first">

      <p>An immutable mapping for use as a histogram that supports arithmetic operations.
This is useful for modeling outcomes. The <a href="#dyce.h.H--dyce.h.H.__init__">initializer</a> takes a
single parameter, <em>items</em>. In its most explicit form, <em>items</em> maps faces to counts.</p>
<p>Modeling a single six-sided die (<code>1d6</code>) can be expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>An iterable of pairs can also be used (similar to <code>dict</code>):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Two shorthands are provided. If <em>items</em> an iterable of <code>int</code>s, counts of one will
be assumed:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Repeated items do what one would expect:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>If <em>items</em> is an <code>int</code>, it is shorthand for creating a sequential range
<span class="arithmatex">\([{1} .. {items}]\)</span> (or <span class="arithmatex">\([{items} .. {-1}]\)</span> if <em>items</em> is negative):</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Histograms are maps, so we can test equivalence against other maps:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Simple indexes can be used to look up a face’s count:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="mi">1</span>
</code></pre></div>
</td></tr></table>
<p>Most arithmetic operators are supported and do what one would expect. If the operand
is an <code>int</code>, the operator applies to the faces:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">+</span> <span class="mi">4</span>
<span class="n">H</span><span class="p">({</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="o">-</span><span class="n">d6</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>If the operand is another histogram, combinations are computed. Modeling the sum of
two six-sided dice (<code>2d6</code>) can be expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">7.00</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|</span><span class="c1">#####</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|</span><span class="c1">#####</span>
 <span class="mi">10</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
 <span class="mi">11</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
</code></pre></div>
</td></tr></table>
<p>To sum <span class="arithmatex">\({n}\)</span> identical histograms, the matrix multiplication operator (<code>@</code>)
provides a shorthand:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@d6</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>The <code>len</code> built-in function can be used to show the number of distinct sums:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span>
<span class="mi">11</span>
</code></pre></div>
</td></tr></table>
<p>The <a href="#dyce.h.H.counts"><code>counts</code> method</a> can be used to show the total number of
combinations:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">((</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>
<span class="mi">36</span>
</code></pre></div>
</td></tr></table>
<p>Counts are generally accumulated without reduction:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>To reduce, call the <a href="#dyce.h.H.lowest_terms"><code>lowest_terms</code> method</a>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>Testing equivalence implicitly performs reductions of operands:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Histograms provide common comparators (e.g., <a href="#dyce.h.H.eq"><code>eq</code></a>
<a href="#dyce.h.H.ne"><code>ne</code></a>, etc.). One way to count how often a first six-sided die
shows a different face than a second is:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.83</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">83.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################################</span>
</code></pre></div>
</td></tr></table>
<p>Or, how often a first six-sided die shows a face less than a second is:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.42</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#############################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
</code></pre></div>
</td></tr></table>
<p>Or how often at least one <code>2</code> will show when rolling four six-sided dice:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># how often a 2 shows on a single six-sided die</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">4</span><span class="o">@</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>  <span class="c1"># counts of how many 2s show on 4d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">625</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># how often the count is at least one</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">625</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">671</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.52</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">48.23</span><span class="o">%</span> <span class="o">|</span><span class="c1">########################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">51.77</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################</span>
</code></pre></div>
</td></tr></table>
<div class="admonition warning">
<p class="admonition-title">Mind your parentheses</p>
<p>Parentheses are often necessary to enforce the desired order of operations:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># probably not what was intended</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">36</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">@</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">21</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div>
</td></tr></table>
</div>




  <div class="doc doc-children">


















  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializer.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="n">SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">items</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span> <span class="o">=</span> <span class="n">items</span>
            <span class="n">items</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">items</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">items</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_simple_init</span> <span class="o">=</span> <span class="n">items</span>
            <span class="n">items</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">items</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">AbleT</span><span class="p">):</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">ABCMapping</span><span class="p">):</span>
        <span class="n">h</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>  <span class="c1"># type: DefaultDict[int, int]</span>

        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">face</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">h</span><span class="p">[</span><span class="n">face</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">h</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">items</span> <span class="o">=</span> <span class="n">h</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">((</span><span class="n">face</span><span class="p">,</span> <span class="n">items</span><span class="p">[</span><span class="n">face</span><span class="p">])</span> <span class="k">for</span> <span class="n">face</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



























  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.concat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Accumulates counts:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Accumulates counts:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(4).concat(H(6))</span>
<span class="sd">    H({1: 2, 2: 2, 3: 2, 4: 2, 5: 1, 6: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="p">(</span><span class="n">other</span><span class="p">,)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ABCMapping</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">H</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">cast</span><span class="p">(</span><span class="n">Iterable</span><span class="p">,</span> <span class="n">other</span><span class="p">)))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.counts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>More descriptive synonym for the <a href="#dyce.h.H.values"><code>values</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    More descriptive synonym for the [``values`` method][dyce.h.H.values].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.data" class="doc doc-heading">
<code class="highlight language-python"><span class="n">data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_items</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Presentation helper function that returns an iterator for each face/frequency pair:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">())</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">)]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>
<p>If provided, <em>fill_items</em> supplies defaults for any missing faces:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">())</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">)]</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">fill_items</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">0</span><span class="p">}))</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">relative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Presentation helper function that returns an iterator for each face/frequency pair:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; list(d6.gt(3).data())</span>
<span class="sd">    [(0, 3.0), (1, 3.0)]</span>

<span class="sd">    &gt;&gt;&gt; list(d6.gt(3).data(relative=True))</span>
<span class="sd">    [(0, 0.5), (1, 0.5)]</span>

<span class="sd">    ```</span>

<span class="sd">    If provided, *fill_items* supplies defaults for any missing faces:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list(d6.gt(7).data())</span>
<span class="sd">    [(0, 6.0)]</span>

<span class="sd">    &gt;&gt;&gt; list(d6.gt(7).data(fill_items={1: 0, 0: 0}))</span>
<span class="sd">    [(0, 6.0), (1, 0.0)]</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fill_items</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fill_items</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">if</span> <span class="n">relative</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span> <span class="ow">or</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">combined</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="n">fill_items</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="k">return</span> <span class="p">((</span><span class="n">face</span><span class="p">,</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span> <span class="k">for</span> <span class="n">face</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">combined</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.data_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">data_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_items</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Presentation helper function that returns an iterator for a “zipped” arrangement of
the output from the <a href="#dyce.h.H.data"><code>data</code> method</a>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">data</span><span class="p">())</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">data_xy</span><span class="p">()</span>
<span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">))</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">data_xy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">relative</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Presentation helper function that returns an iterator for a “zipped” arrangement of</span>
<span class="sd">    the output from the [``data`` method][dyce.h.H.data]:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; list(d6.data())</span>
<span class="sd">    [(1, 1.0), (2, 1.0), (3, 1.0), (4, 1.0), (5, 1.0), (6, 1.0)]</span>
<span class="sd">    &gt;&gt;&gt; d6.data_xy()</span>
<span class="sd">    ((1, 2, 3, 4, 5, 6), (1.0, 1.0, 1.0, 1.0, 1.0, 1.0))</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cast</span><span class="p">(</span>
        <span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]],</span>
        <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">relative</span><span class="p">,</span> <span class="n">fill_items</span><span class="p">))),</span>
    <span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.eq, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">eq</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.eq, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).eq(3)</span>
<span class="sd">    H({0: 5, 1: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_eq</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.even" class="doc doc-heading">
<code class="highlight language-python"><span class="n">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">even</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).even()</span>
<span class="sd">    H({0: 2, 1: 4})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mb">0b1</span><span class="p">)</span> <span class="o">^</span> <span class="mb">0b1</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_even</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.explode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.substitute(lambda h, f: h if f == max(h) else f, operator.add,
max_depth)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.substitute"><code>substitute</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.substitute(lambda h, f: h if f == max(h) else f, operator.add,</span>
<span class="sd">    max_depth)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).explode(max_depth=2)</span>
<span class="sd">    H({1: 36, 2: 36, 3: 36, 4: 36, 5: 36, 7: 6, 8: 6, 9: 6, 10: 6, 11: 6, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``substitute`` method][dyce.h.H.substitute].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_reroll_greatest</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">face</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="n">h</span> <span class="k">if</span> <span class="n">face</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">else</span> <span class="n">face</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">_reroll_greatest</span><span class="p">,</span> <span class="n">op_add</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.faces" class="doc doc-heading">
<code class="highlight language-python"><span class="n">faces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>More descriptive synonym for the <a href="#dyce.h.H.keys"><code>keys</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">faces</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    More descriptive synonym for the [``keys`` method][dyce.h.H.keys].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.format" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fill_items</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">88</span><span class="p">,</span> <span class="n">tick</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns a formatted string representation of the histogram. If provided,
<em>fill_items</em> supplies defaults for any missing faces. If <em>width</em> is greater than
zero, a horizontal bar ASCII graph is printed using <em>tick</em> and <em>sep</em> (which are
otherwise ignored if <em>width</em> is zero or less).</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">{</span><span class="n">avg</span><span class="p">:</span> <span class="mf">3.50</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">}</span>

<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fill_items</span><span class="o">=</span><span class="p">{</span><span class="n">i</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)},</span> <span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">tick</span><span class="o">=</span><span class="s2">&quot;@&quot;</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">7.00</span>
  <span class="mi">1</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|@</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|@@</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|@@@@</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|@@@@@</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|@@@@@@</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|@@@@@@@@</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|@@@@@@</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|@@@@@</span>
 <span class="mi">10</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|@@@@</span>
 <span class="mi">11</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|@@</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|@</span>
 <span class="mi">13</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">14</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">15</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">16</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">17</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">18</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">19</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">20</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
</code></pre></div>
</td></tr></table>
<p>If <em>scaled</em> is <code>True</code>, horizontal bars are scaled to <em>width</em>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:-&gt;65}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot; 65 chars wide --&gt;|&quot;</span><span class="p">))</span>
<span class="o">----------------------------------------------</span> <span class="mi">65</span> <span class="n">chars</span> <span class="n">wide</span> <span class="o">--&gt;|</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.58</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#############################</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.58</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">###################################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">##################################################</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">format</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">fill_items</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Mapping</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">_ROW_WIDTH</span><span class="p">,</span>
    <span class="n">tick</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">linesep</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a formatted string representation of the histogram. If provided,</span>
<span class="sd">    *fill_items* supplies defaults for any missing faces. If *width* is greater than</span>
<span class="sd">    zero, a horizontal bar ASCII graph is printed using *tick* and *sep* (which are</span>
<span class="sd">    otherwise ignored if *width* is zero or less).</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; print(H(6).format(width=0))</span>
<span class="sd">    {avg: 3.50, 1: 16.67%, 2: 16.67%, 3: 16.67%, 4: 16.67%, 5: 16.67%, 6: 16.67%}</span>

<span class="sd">    &gt;&gt;&gt; print((2@H(6)).format(fill_items={i: 0 for i in range(1, 21)}, width=65, tick=&quot;@&quot;))</span>
<span class="sd">    avg |    7.00</span>
<span class="sd">      1 |   0.00% |</span>
<span class="sd">      2 |   2.78% |@</span>
<span class="sd">      3 |   5.56% |@@</span>
<span class="sd">      4 |   8.33% |@@@@</span>
<span class="sd">      5 |  11.11% |@@@@@</span>
<span class="sd">      6 |  13.89% |@@@@@@</span>
<span class="sd">      7 |  16.67% |@@@@@@@@</span>
<span class="sd">      8 |  13.89% |@@@@@@</span>
<span class="sd">      9 |  11.11% |@@@@@</span>
<span class="sd">     10 |   8.33% |@@@@</span>
<span class="sd">     11 |   5.56% |@@</span>
<span class="sd">     12 |   2.78% |@</span>
<span class="sd">     13 |   0.00% |</span>
<span class="sd">     14 |   0.00% |</span>
<span class="sd">     15 |   0.00% |</span>
<span class="sd">     16 |   0.00% |</span>
<span class="sd">     17 |   0.00% |</span>
<span class="sd">     18 |   0.00% |</span>
<span class="sd">     19 |   0.00% |</span>
<span class="sd">     20 |   0.00% |</span>

<span class="sd">    ```</span>

<span class="sd">    If *scaled* is ``True``, horizontal bars are scaled to *width*:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; h = (2@H(6)).ge(7)</span>
<span class="sd">    &gt;&gt;&gt; print(&quot;{:-&gt;65}&quot;.format(&quot; 65 chars wide --&gt;|&quot;))</span>
<span class="sd">    ---------------------------------------------- 65 chars wide --&gt;|</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(width=65, scaled=False))</span>
<span class="sd">    avg |    0.58</span>
<span class="sd">      0 |  41.67% |####################</span>
<span class="sd">      1 |  58.33% |#############################</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(width=65, scaled=True))</span>
<span class="sd">    avg |    0.58</span>
<span class="sd">      0 |  41.67% |###################################</span>
<span class="sd">      1 |  58.33% |##################################################</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">parts</span><span class="p">():</span>
            <span class="k">yield</span> <span class="s2">&quot;avg: </span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">())</span>

            <span class="k">for</span> <span class="n">face</span><span class="p">,</span> <span class="n">percentage</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">relative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fill_items</span><span class="o">=</span><span class="n">fill_items</span><span class="p">):</span>
                <span class="k">yield</span> <span class="s2">&quot;</span><span class="si">{}</span><span class="s2">:</span><span class="si">{:7.2%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">percentage</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">parts</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">15</span>

        <span class="k">def</span> <span class="nf">lines</span><span class="p">():</span>
            <span class="k">yield</span> <span class="s2">&quot;avg | </span><span class="si">{:7.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">avg</span><span class="p">())</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>
            <span class="n">tick_scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span> <span class="k">if</span> <span class="n">scaled</span> <span class="k">else</span> <span class="n">total</span>

            <span class="k">for</span> <span class="n">face</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">(</span><span class="n">relative</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_items</span><span class="o">=</span><span class="n">fill_items</span><span class="p">):</span>
                <span class="n">percentage</span> <span class="o">=</span> <span class="n">count</span> <span class="o">/</span> <span class="n">total</span>
                <span class="n">ticks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">count</span> <span class="o">/</span> <span class="n">tick_scale</span><span class="p">)</span>
                <span class="k">yield</span> <span class="s2">&quot;</span><span class="si">{: 3}</span><span class="s2"> | </span><span class="si">{:7.2%}</span><span class="s2"> |</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">percentage</span><span class="p">,</span> <span class="n">tick</span> <span class="o">*</span> <span class="n">ticks</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">())</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.ge, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ge</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.ge, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).ge(3)</span>
<span class="sd">    H({0: 2, 1: 4})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_ge</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.gt, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gt</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.gt, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).gt(3)</span>
<span class="sd">    H({0: 3, 1: 3})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_gt</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.items" class="doc doc-heading">
<code class="highlight language-python"><span class="n">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>D.items() -&gt; a set-like object providing a view on D's items</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>D.keys() -&gt; a set-like object providing a view on D's keys</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.le, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">le</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.le, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).le(3)</span>
<span class="sd">    H({0: 3, 1: 3})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_le</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.lowest_terms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lowest_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Computes and returns a histogram whose counts share a greatest common divisor of 1.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">_</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lowest_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes and returns a histogram whose counts share a greatest common divisor of 1.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H((-1, -1, 0, 0, 1, 1))</span>
<span class="sd">    H({-1: 2, 0: 2, 1: 2})</span>
<span class="sd">    &gt;&gt;&gt; _.lowest_terms()</span>
<span class="sd">    H({-1: 1, 0: 1, 1: 1})</span>

<span class="sd">    &gt;&gt;&gt; H((2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 5, 5))</span>
<span class="sd">    H({2: 2, 3: 4, 4: 4, 5: 2})</span>
<span class="sd">    &gt;&gt;&gt; _.lowest_terms()</span>
<span class="sd">    H({2: 1, 3: 2, 4: 2, 5: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">counts_gcd</span> <span class="o">=</span> <span class="n">reduce</span><span class="p">(</span><span class="n">gcd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">(),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">H</span><span class="p">({</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="o">//</span> <span class="n">counts_gcd</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()})</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.lt, other)</code>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lt</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.lt, other)``:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).lt(3)</span>
<span class="sd">    H({0: 4, 1: 2})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_lt</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.map" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oper</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Applies <em>oper</em> to each face of the histogram paired with <em>other</em>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>Note that shorthands exist for many arithmetic operators and comparators:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">gt</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">oper</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies *oper* to each face of the histogram paired with *other*:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.add, d6)</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>

<span class="sd">    &gt;&gt;&gt; d6.map(operator.mul, -1)</span>
<span class="sd">    H({-6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1})</span>

<span class="sd">    &gt;&gt;&gt; d6.map(operator.gt, 3)</span>
<span class="sd">    H({0: 3, 1: 3})</span>

<span class="sd">    ```</span>

<span class="sd">    Note that shorthands exist for many arithmetic operators and comparators:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d6 + d6 == d6.map(operator.add, d6)</span>
<span class="sd">    True</span>

<span class="sd">    &gt;&gt;&gt; d6 * -1 == d6.map(operator.mul, -1)</span>
<span class="sd">    True</span>

<span class="sd">    &gt;&gt;&gt; d6.gt(3) == d6.map(operator.gt, 3)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="o">.</span><span class="n">AbleT</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">H</span><span class="p">((</span><span class="nb">int</span><span class="p">(</span><span class="n">oper</span><span class="p">(</span><span class="n">face</span><span class="p">,</span> <span class="n">other</span><span class="p">)),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">face</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">H</span><span class="p">(</span>
            <span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">oper</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)),</span> <span class="bp">self</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">other</span><span class="p">[</span><span class="n">b</span><span class="p">])</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.map(operator.ne, other)</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.map"><code>map</code> method</a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ne</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.map(operator.ne, other)``.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H(6).ne(3)</span>
<span class="sd">    H({0: 1, 1: 5})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map`` method][dyce.h.H.map].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op_ne</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.odd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">odd</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).odd()</span>
<span class="sd">    H({0: 4, 1: 2})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">is_odd</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">a</span> <span class="o">&amp;</span> <span class="mb">0b1</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_odd</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.roll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns a (weighted) random face.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a (weighted) random face.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">()))</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">face</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">count</span>

        <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="n">total</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">face</span>

    <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;val (</span><span class="si">{}</span><span class="s2">) ≥ total (</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">total</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.substitute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substitute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">coalesce</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Calls <em>expand</em> on each face, recursively up to <em>max_depth</em> times. If <em>expand</em>
returns an <code>int</code>, it replaces the face. <a href="#dyce.h.H"><code>H</code> object</a>, <em>coalesce</em>
is called on the face and the expanded histogram, and the returned histogram is
folded into result. The default behavior for <em>coalesce</em> is to replace the face
with the expanded histogram.</p>
<p>This can be used to model complex rules. The following models re-rolling a face
of 1 on the first roll:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">reroll_one</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">face</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="o">...</span>   <span class="k">return</span> <span class="n">h</span> <span class="k">if</span> <span class="n">face</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">face</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">reroll_one</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>See the <a href="#dyce.h.H.explode"><code>explode</code> method</a> for a common shorthand for
exploding dice.</p>
<p>For a more complicated example, consider the following rules:</p>
<ol>
<li>Start with a total of zero.</li>
<li>Roll a six-sided die. Add the face to the total. If the face was a six, go
     to step 3. Otherwise stop.</li>
<li>Roll a four-sided die. Add the face to the total. If the face was a four,
     go to step 2. Otherwise stop.</li>
</ol>
<p>What is the likelihood of an even final tally? This can be approximated by:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">reroll_greatest_on_d4_d6</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">face</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="o">...</span>   <span class="k">if</span> <span class="n">face</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">):</span>
<span class="o">...</span>     <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="n">d6</span><span class="p">:</span> <span class="k">return</span> <span class="n">d4</span>
<span class="o">...</span>     <span class="k">if</span> <span class="n">h</span> <span class="o">==</span> <span class="n">d4</span><span class="p">:</span> <span class="k">return</span> <span class="n">d6</span>
<span class="o">...</span>   <span class="k">return</span> <span class="n">face</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">d6</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">reroll_greatest_on_d4_d6</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h_even</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">even</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.3%}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">h_even</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">h_even</span><span class="o">.</span><span class="n">counts</span><span class="p">())))</span>
<span class="mf">39.131</span><span class="o">%</span>
</code></pre></div>
</td></tr></table>
<p>Because <code>substitute</code> accepts arbitrary functions, it is well suited for
modeling complicated logical progressions:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">bonus</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dmg_dice</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dmg</span> <span class="o">=</span> <span class="n">dmg_dice</span> <span class="o">+</span> <span class="n">bonus</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">crit</span> <span class="o">=</span> <span class="n">dmg</span> <span class="o">+</span> <span class="n">dmg_dice</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">target</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">-</span> <span class="n">bonus</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d20</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">dmg_from_attack_roll</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">face</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="o">...</span>   <span class="k">if</span> <span class="n">face</span> <span class="o">==</span> <span class="mi">20</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">crit</span>
<span class="o">...</span>   <span class="k">elif</span> <span class="n">face</span> <span class="o">&gt;=</span> <span class="n">target</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">dmg</span>
<span class="o">...</span>   <span class="k">else</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">d20</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">dmg_from_attack_roll</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">{</span><span class="n">avg</span><span class="p">:</span> <span class="mf">2.15</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mf">65.00</span><span class="o">%</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span>  <span class="mf">3.75</span><span class="o">%</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span>  <span class="mf">3.83</span><span class="o">%</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span>  <span class="mf">3.91</span><span class="o">%</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span>  <span class="mf">0.23</span><span class="o">%</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span>  <span class="mf">0.16</span><span class="o">%</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span>  <span class="mf">0.08</span><span class="o">%</span><span class="p">}</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">expand</span><span class="p">:</span> <span class="n">_ExpandT</span><span class="p">,</span>
    <span class="n">coalesce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_CoalesceT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calls *expand* on each face, recursively up to *max_depth* times. If *expand*</span>
<span class="sd">    returns an ``int``, it replaces the face. [``H`` object][dyce.h.H], *coalesce*</span>
<span class="sd">    is called on the face and the expanded histogram, and the returned histogram is</span>
<span class="sd">    folded into result. The default behavior for *coalesce* is to replace the face</span>
<span class="sd">    with the expanded histogram.</span>

<span class="sd">    This can be used to model complex rules. The following models re-rolling a face</span>
<span class="sd">    of 1 on the first roll:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; def reroll_one(h: H, face: int) -&gt; Union[H, int]:</span>
<span class="sd">    ...   return h if face == 1 else face</span>
<span class="sd">    &gt;&gt;&gt; H(6).substitute(reroll_one)</span>
<span class="sd">    H({1: 1, 2: 7, 3: 7, 4: 7, 5: 7, 6: 7})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``explode`` method][dyce.h.H.explode] for a common shorthand for</span>
<span class="sd">    exploding dice.</span>

<span class="sd">    For a more complicated example, consider the following rules:</span>

<span class="sd">      1. Start with a total of zero.</span>
<span class="sd">      2. Roll a six-sided die. Add the face to the total. If the face was a six, go</span>
<span class="sd">         to step 3. Otherwise stop.</span>
<span class="sd">      3. Roll a four-sided die. Add the face to the total. If the face was a four,</span>
<span class="sd">         go to step 2. Otherwise stop.</span>

<span class="sd">    What is the likelihood of an even final tally? This can be approximated by:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; d4, d6 = H(4), H(6)</span>
<span class="sd">    &gt;&gt;&gt; def reroll_greatest_on_d4_d6(h: H, face: int) -&gt; Union[H, int]:</span>
<span class="sd">    ...   if face == max(h):</span>
<span class="sd">    ...     if h == d6: return d4</span>
<span class="sd">    ...     if h == d4: return d6</span>
<span class="sd">    ...   return face</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; h = d6.substitute(reroll_greatest_on_d4_d6, operator.add, max_depth=6)</span>
<span class="sd">    &gt;&gt;&gt; h_even = h.even()</span>
<span class="sd">    &gt;&gt;&gt; print(&quot;{:.3%}&quot;.format(h_even.get(1, 0) / sum(h_even.counts())))</span>
<span class="sd">    39.131%</span>

<span class="sd">    ```</span>

<span class="sd">    Because ``substitute`` accepts arbitrary functions, it is well suited for</span>
<span class="sd">    modeling complicated logical progressions:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; bonus = 1</span>
<span class="sd">    &gt;&gt;&gt; dmg_dice = H(8)</span>
<span class="sd">    &gt;&gt;&gt; dmg = dmg_dice + bonus</span>
<span class="sd">    &gt;&gt;&gt; crit = dmg + dmg_dice</span>
<span class="sd">    &gt;&gt;&gt; target = 15 - bonus</span>
<span class="sd">    &gt;&gt;&gt; d20 = H(20)</span>
<span class="sd">    &gt;&gt;&gt; def dmg_from_attack_roll(h: H, face: int) -&gt; Union[H, int]:</span>
<span class="sd">    ...   if face == 20:</span>
<span class="sd">    ...     return crit</span>
<span class="sd">    ...   elif face &gt;= target:</span>
<span class="sd">    ...     return dmg</span>
<span class="sd">    ...   else:</span>
<span class="sd">    ...     return 0</span>
<span class="sd">    &gt;&gt;&gt; h = d20.substitute(dmg_from_attack_roll)</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(width=0))</span>
<span class="sd">    {avg: 2.15, 0: 65.00%, 2:  3.75%, 3:  3.83%, 4:  3.91%, ..., 15:  0.23%, 16:  0.16%, 17:  0.08%}</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">coalesce</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">coalesce</span> <span class="o">=</span> <span class="n">_coalesce_replace</span>

    <span class="k">def</span> <span class="nf">_substitute</span><span class="p">(</span>
        <span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span>
        <span class="n">depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">coalesce</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="n">max_depth</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">h</span>

        <span class="n">total_scalar</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">items_for_reassembly</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">face</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">expanded</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">expanded</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">items_for_reassembly</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">expanded</span><span class="p">,</span> <span class="n">count</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Keep expanding deeper, if we can</span>
                <span class="n">expanded</span> <span class="o">=</span> <span class="n">_substitute</span><span class="p">(</span><span class="n">expanded</span><span class="p">,</span> <span class="n">depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
                <span class="c1"># Coalesce the result</span>
                <span class="n">expanded</span> <span class="o">=</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">expanded</span><span class="p">,</span> <span class="n">face</span><span class="p">)</span>
                <span class="c1"># Account for the impact of expansion on peers</span>
                <span class="n">expanded_scalar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">expanded</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>
                <span class="n">total_scalar</span> <span class="o">*=</span> <span class="n">expanded_scalar</span>
                <span class="c1"># Account for the impact of the original count on the result, but</span>
                <span class="c1"># keep track of the impact on peers so we can factor it out for</span>
                <span class="c1"># these items later</span>
                <span class="n">items_for_reassembly</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">count</span><span class="p">,</span> <span class="n">expanded_scalar</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">expanded</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">H</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="c1"># Apply the total_scalar, but factor out this item&#39;s contribution</span>
                <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">c</span> <span class="o">*</span> <span class="n">total_scalar</span> <span class="o">//</span> <span class="n">s</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">f</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">items_for_reassembly</span>
            <span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">_substitute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>D.values() -&gt; an object providing a view on D's values</p>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.h.H.within" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Computes the difference between this histogram and <em>other</em>. -1 is represents where
that difference is less than <em>lo</em>. 0 represents where that difference between
<em>lo</em> and <em>hi</em> (inclusive). 1 represents where that difference is greater than
<em>hi</em>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>   <span class="o">-</span><span class="mf">0.25</span>
 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>

<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">3</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>  <span class="c1"># 3d6 w/in 1 of 2d8</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3500</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">3412</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6912</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.25</span>
 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>  <span class="mf">25.32</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">24.68</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">50.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/h.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the difference between this histogram and *other*. -1 is represents where</span>
<span class="sd">    that difference is less than *lo*. 0 represents where that difference between</span>
<span class="sd">    *lo* and *hi* (inclusive). 1 represents where that difference is greater than</span>
<span class="sd">    *hi*.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; (2@H(6)).within(7, 9)</span>
<span class="sd">    H({-1: 15, 0: 15, 1: 6})</span>
<span class="sd">    &gt;&gt;&gt; print(_.format(width=65))</span>
<span class="sd">    avg |   -0.25</span>
<span class="sd">     -1 |  41.67% |####################</span>
<span class="sd">      0 |  41.67% |####################</span>
<span class="sd">      1 |  16.67% |########</span>

<span class="sd">    &gt;&gt;&gt; (3@H(6)).within(-1, 1, 2@H(8))  # 3d6 w/in 1 of 2d8</span>
<span class="sd">    H({-1: 3500, 0: 3412, 1: 6912})</span>
<span class="sd">    &gt;&gt;&gt; print(_.format(width=65))</span>
<span class="sd">    avg |    0.25</span>
<span class="sd">     -1 |  25.32% |############</span>
<span class="sd">      0 |  24.68% |############</span>
<span class="sd">      1 |  50.00% |#########################</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_within</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="dyce.p.P" class="doc doc-heading">
        <code>P</code>



</h2>

    <div class="doc doc-contents first">

      <p>An immutable pool (ordered sequence) of zero or more <a href="#dyce.h.H"><code>H</code> objects</a>
supporting group operations. Objects can be flattened to a single histogram, either
explicitly via the <a href="#dyce.p.P.h"><code>h</code> method</a>, or by using binary arithmetic
operations. Unary operators and the <code>@</code> operator result in new <code>P</code> objects. If
any of the <a href="#dyce.p.P--dyce.p.P.__init__">initializer</a>’s <em>args</em> parameter is an <code>int</code>, it is
passed to the constructor for <code>H</code>.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># shorthand for P(H(6))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_d6</span>
<span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="o">-</span><span class="n">p_d6</span>
<span class="n">P</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="n">p_d6</span><span class="p">,</span> <span class="n">p_d6</span><span class="p">)</span>  <span class="c1"># 2d6</span>
<span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@p_d6</span>  <span class="c1"># also 2d6</span>
<span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="o">@</span><span class="p">(</span><span class="mi">2</span><span class="nd">@p_d6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="nd">@p_d6</span>
<span class="kc">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">20</span><span class="p">))))))</span>
<span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">roll</span><span class="p">())</span> <span class="ow">in</span> <span class="n">_</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Arithmetic operators involving an <code>int</code> or another <code>P</code> object produces an
<a href="#dyce.h.H"><code>H</code> object</a>:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_d6</span> <span class="o">+</span> <span class="n">p_d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>Comparisons between <code>P</code> and <a href="#dyce.h.H"><code>H</code></a> objects still work:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@p_d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Indexing selects a contained histogram:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
<p>Note that containers are opinionated about histogram ordering:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>The <a href="#dyce.p.P.h"><code>h</code> method</a> also allows subsets of faces to be “taken” by index
from least to greatest. Negative indexes are supported and retain their idiomatic
meaning. Modeling the sum of the greatest two faces of three six-sided dice
(<code>3d6</code>) can be expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">3</span><span class="nd">@p_d6</span><span class="p">)</span><span class="o">.</span><span class="n">h</span><span class="p">((</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">8.46</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">0.46</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">1.39</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">3.24</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">5</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">6</span> <span class="o">|</span>   <span class="mf">8.80</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">12.50</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">15.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">#######</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
 <span class="mi">10</span> <span class="o">|</span>  <span class="mf">15.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">#######</span>
 <span class="mi">11</span> <span class="o">|</span>  <span class="mf">12.50</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">7.41</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
</code></pre></div>
</td></tr></table>




  <div class="doc doc-children">
















  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initializer.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_gen_hs</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">H</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">a</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">_hs</span><span class="p">:</span>  <span class="c1"># pylint: disable=protected-access</span>
                    <span class="k">yield</span> <span class="n">h</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="s2">&quot;type </span><span class="si">{}</span><span class="s2"> incompatible initializer for </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">)</span>

    <span class="n">hs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">_gen_hs</span><span class="p">()</span> <span class="k">if</span> <span class="n">h</span><span class="p">)</span>
    <span class="n">hs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">hs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>


























  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().eq(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.eq"><code>H.eq</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">eq</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().eq(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.eq``][dyce.h.H.eq].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.even" class="doc doc-heading">
<code class="highlight language-python"><span class="n">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().even()</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.even"><code>H.even</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().even()``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.even``][dyce.h.H.even].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">even</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.explode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().explode(max_depth)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a>
and <a href="#dyce.h.H.explode"><code>H.explode</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().explode(max_depth)``. See the [``h`` method][dyce.p.P.h]</span>
<span class="sd">    and [``H.explode``][dyce.h.H.explode].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">max_depth</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().ge(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.ge"><code>H.ge</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ge</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().ge(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.ge``][dyce.h.H.ge].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().gt(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.gt"><code>H.gt</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">gt</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().gt(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.gt``][dyce.h.H.gt].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.h" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>When provided no arguments, <code>h</code> combines (or “flattens”) contained
histograms:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div>
</td></tr></table>
<p>If the optional <em>key</em> parameter is provided, <code>h</code> sums subsets of faces
selected by <em>key</em>. <em>key</em> can be an <code>int</code>, a <code>slice</code>, or an iterable of
<code>int</code>s and <code>slice</code>s.</p>
<p>All outcomes are enumerated. For each outcome, faces are ordered from least
(index <code>0</code>) to greatest (index <code>-1</code> or <code>len(self)</code>). Modeling taking the
greatest of two six-sided dice can be expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">4.47</span>
  <span class="mi">1</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">3</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">4</span> <span class="o">|</span>  <span class="mf">19.44</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">25.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">30.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">###############</span>
</code></pre></div>
</td></tr></table>
<p>Slices and arbitrary iterables support more flexible face selections:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_6d6</span> <span class="o">=</span> <span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">every_other_d6</span> <span class="o">=</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">every_other_d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">86</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1106</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">395</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">31</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">h</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">h</span><span class="p">({</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">})</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
</code></pre></div>
</td></tr></table>
<p>Modeling the sum of the greatest two and least two faces of ten four-sided dice
(<code>10d4</code>) can be expressed as:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">10</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">((</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">)))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1012</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">5030</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">51973</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">168760</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">595004</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">168760</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">51973</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">5030</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1012</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">65</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>   <span class="mf">10.00</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">5</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">6</span> <span class="o">|</span>   <span class="mf">0.10</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">7</span> <span class="o">|</span>   <span class="mf">0.48</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">8</span> <span class="o">|</span>   <span class="mf">4.96</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">16.09</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
 <span class="mi">10</span> <span class="o">|</span>  <span class="mf">56.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">############################</span>
 <span class="mi">11</span> <span class="o">|</span>  <span class="mf">16.09</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">4.96</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
 <span class="mi">13</span> <span class="o">|</span>   <span class="mf">0.48</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">14</span> <span class="o">|</span>   <span class="mf">0.10</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">15</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">16</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
</code></pre></div>
</td></tr></table>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">_GetItemT</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_GetItemT</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    When provided no arguments, ``h`` combines (or “flattens”) contained</span>
<span class="sd">    histograms:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; (2@P(6)).h()</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    If the optional *key* parameter is provided, ``h`` sums subsets of faces</span>
<span class="sd">    selected by *key*. *key* can be an ``int``, a ``slice``, or an iterable of</span>
<span class="sd">    ``int``s and ``slice``s.</span>

<span class="sd">    All outcomes are enumerated. For each outcome, faces are ordered from least</span>
<span class="sd">    (index ``0``) to greatest (index ``-1`` or ``len(self)``). Modeling taking the</span>
<span class="sd">    greatest of two six-sided dice can be expressed as:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; (2@P(6)).h(-1)</span>
<span class="sd">    H({1: 1, 2: 3, 3: 5, 4: 7, 5: 9, 6: 11})</span>
<span class="sd">    &gt;&gt;&gt; print(_.format(width=65))</span>
<span class="sd">    avg |    4.47</span>
<span class="sd">      1 |   2.78% |#</span>
<span class="sd">      2 |   8.33% |####</span>
<span class="sd">      3 |  13.89% |######</span>
<span class="sd">      4 |  19.44% |#########</span>
<span class="sd">      5 |  25.00% |############</span>
<span class="sd">      6 |  30.56% |###############</span>

<span class="sd">    ```</span>

<span class="sd">    Slices and arbitrary iterables support more flexible face selections:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; p_6d6 = 6@P(6)</span>
<span class="sd">    &gt;&gt;&gt; every_other_d6 = p_6d6.h(slice(None, None, -2))</span>
<span class="sd">    &gt;&gt;&gt; every_other_d6</span>
<span class="sd">    H({3: 1, 4: 21, 5: 86, ..., 16: 1106, 17: 395, 18: 31})</span>
<span class="sd">    &gt;&gt;&gt; p_6d6.h((5, 3, 1)) == every_other_d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; p_6d6.h(range(1, 6, 2)) == every_other_d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; p_6d6.h(i for i in range(0, 6) if i % 2 == 1) == every_other_d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; p_6d6.h({1, 3, 5}) == every_other_d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    Modeling the sum of the greatest two and least two faces of ten four-sided dice</span>
<span class="sd">    (``10d4``) can be expressed as:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; (10@P(4)).h((slice(2), slice(-2, None)))</span>
<span class="sd">    H({4: 1, 5: 10, 6: 1012, 7: 5030, 8: 51973, 9: 168760, 10: 595004, 11: 168760, 12: 51973, 13: 5030, 14: 1012, 15: 10, 16: 1})</span>
<span class="sd">    &gt;&gt;&gt; print(_.format(width=65))</span>
<span class="sd">    avg |   10.00</span>
<span class="sd">      4 |   0.00% |</span>
<span class="sd">      5 |   0.00% |</span>
<span class="sd">      6 |   0.10% |</span>
<span class="sd">      7 |   0.48% |</span>
<span class="sd">      8 |   4.96% |##</span>
<span class="sd">      9 |  16.09% |########</span>
<span class="sd">     10 |  56.74% |############################</span>
<span class="sd">     11 |  16.09% |########</span>
<span class="sd">     12 |   4.96% |##</span>
<span class="sd">     13 |   0.48% |</span>
<span class="sd">     14 |   0.10% |</span>
<span class="sd">     15 |   0.00% |</span>
<span class="sd">     16 |   0.00% |</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">:</span>
            <span class="n">hs_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hs_sum</span> <span class="o">=</span> <span class="n">H</span><span class="p">(())</span>

        <span class="k">return</span> <span class="n">cast</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">hs_sum</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="n">keys</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_GetItemT</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">ABCIterable</span><span class="p">):</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="n">key</span><span class="p">,)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">return</span> <span class="n">H</span><span class="p">(</span><span class="n">_select_and_sum_faces</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(),</span> <span class="n">keys</span><span class="p">))</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().le(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.le"><code>H.le</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">le</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().le(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.le``][dyce.h.H.le].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().lt(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.lt"><code>H.lt</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">lt</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().lt(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.lt``][dyce.h.H.lt].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().ne(other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.ne"><code>H.ne</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">ne</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().ne(other)``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.ne``][dyce.h.H.ne].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.odd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().odd()</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a> and
<a href="#dyce.h.H.odd"><code>H.odd</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().odd()``. See the [``h`` method][dyce.p.P.h] and</span>
<span class="sd">    [``H.odd``][dyce.h.H.odd].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">odd</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.roll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns (weighted) random faces from contained histograms.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns (weighted) random faces from contained histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">roll</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.rolls_with_counts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rolls_with_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns an iterator that yields 2-tuples (pairs) that, collectively, enumerate all
possible outcomes for the pool. The first item in the 2-tuple is a sorted
sequence of the faces for a distinct roll. The second is the count for that
roll.</p>
<p>We can model the likelihood of achieving a “Yhatzee” (i.e., where five six-sided
dice show the same face) on a single roll by checking rolls for where the least
and greatest faces are the same:</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_5d6</span> <span class="o">=</span> <span class="mi">5</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">yhatzee_on_single_roll</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span>
<span class="o">...</span>   <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">roll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">roll</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="o">...</span>   <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span>
<span class="o">...</span>   <span class="ow">in</span> <span class="n">p_5d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">()</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">yhatzee_on_single_roll</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">{</span><span class="n">avg</span><span class="p">:</span> <span class="mf">0.00</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mf">99.92</span><span class="o">%</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span>  <span class="mf">0.08</span><span class="o">%</span><span class="p">}</span>
</code></pre></div>
</td></tr></table>
<p>Note that, in the general case, rolls can appear more than once, and there are
no guarantees about their order.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>
<p>However, if the pool is homogeneous (meaning it only contains identical
histograms), faces are not repeated and are presented in order.</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">((</span><span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div>
</td></tr></table>
<p>Enumeration is substantially more efficient for homogeneous pools than
heterogeneous ones. This is because homogeneous pools can be enumerated using
combinations with replacements, but heterogeneous pools require computing the
Cartesian product. This implementation attempts to optimize the latter by
breaking pools into homogeneous groups before computing the product of those
sub-results. This approach allows homogeneous pools to be ordered without
duplicates, but heterogeneous ones provide no such guarantees.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">rolls_with_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an iterator that yields 2-tuples (pairs) that, collectively, enumerate all</span>
<span class="sd">    possible outcomes for the pool. The first item in the 2-tuple is a sorted</span>
<span class="sd">    sequence of the faces for a distinct roll. The second is the count for that</span>
<span class="sd">    roll.</span>

<span class="sd">    We can model the likelihood of achieving a “Yhatzee” (i.e., where five six-sided</span>
<span class="sd">    dice show the same face) on a single roll by checking rolls for where the least</span>
<span class="sd">    and greatest faces are the same:</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; p_5d6 = 5@P(6)</span>
<span class="sd">    &gt;&gt;&gt; yhatzee_on_single_roll = H(</span>
<span class="sd">    ...   (1 if roll[0] == roll[-1] else 0, count)</span>
<span class="sd">    ...   for roll, count</span>
<span class="sd">    ...   in p_5d6.rolls_with_counts()</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; print(yhatzee_on_single_roll.format(width=0))</span>
<span class="sd">    {avg: 0.00, 0: 99.92%, 1:  0.08%}</span>

<span class="sd">    ```</span>

<span class="sd">    Note that, in the general case, rolls can appear more than once, and there are</span>
<span class="sd">    no guarantees about their order.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list(P(H(2), H(3)).rolls_with_counts())</span>
<span class="sd">    [((1, 1), 1), ((1, 2), 1), ((1, 3), 1), ((1, 2), 1), ((2, 2), 1), ((2, 3), 1)]</span>

<span class="sd">    ```</span>

<span class="sd">    However, if the pool is homogeneous (meaning it only contains identical</span>
<span class="sd">    histograms), faces are not repeated and are presented in order.</span>

<span class="sd">    ```python</span>
<span class="sd">    &gt;&gt;&gt; list((2@P(H((-1, 0, 1)))).rolls_with_counts())</span>
<span class="sd">    [((-1, -1), 1), ((-1, 0), 2), ((-1, 1), 2), ((0, 0), 1), ((0, 1), 2), ((1, 1), 1)]</span>

<span class="sd">    ```</span>

<span class="sd">    Enumeration is substantially more efficient for homogeneous pools than</span>
<span class="sd">    heterogeneous ones. This is because homogeneous pools can be enumerated using</span>
<span class="sd">    combinations with replacements, but heterogeneous pools require computing the</span>
<span class="sd">    Cartesian product. This implementation attempts to optimize the latter by</span>
<span class="sd">    breaking pools into homogeneous groups before computing the product of those</span>
<span class="sd">    sub-results. This approach allows homogeneous pools to be ordered without</span>
<span class="sd">    duplicates, but heterogeneous ones provide no such guarantees.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">))</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># Optimization to use _rolls_with_counts_for_n_uniform_histograms directly if</span>
        <span class="c1"># there&#39;s only one group; roughly 15% time savings based on cursory</span>
        <span class="c1"># performance analysis</span>
        <span class="n">h</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">_rolls_with_counts_for_n_uniform_histograms</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_rolls_with_counts_for_nonuniform_histograms</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.substitute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substitute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">coalesce</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().substitute(expand, coalesce, max_depth)</code>. See the
<a href="#dyce.p.P.h"><code>h</code> method</a> and <a href="#dyce.h.H.substitute"><code>H.substitute</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">expand</span><span class="p">:</span> <span class="n">_ExpandT</span><span class="p">,</span>
    <span class="n">coalesce</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">_CoalesceT</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().substitute(expand, coalesce, max_depth)``. See the</span>
<span class="sd">    [``h`` method][dyce.p.P.h] and [``H.substitute``][dyce.h.H.substitute].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">expand</span><span class="p">,</span> <span class="n">coalesce</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="dyce.p.P.within" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Shorthand for <code>self.h().within(lo, hi, other)</code>. See the <a href="#dyce.p.P.h"><code>h</code> method</a>
and <a href="#dyce.h.H.within"><code>H.within</code></a>.</p>

        <details class="quote">
          <summary>Source code in <code>dyce/p.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``self.h().within(lo, hi, other)``. See the [``h`` method][dyce.p.P.h]</span>
<span class="sd">    and [``H.within``][dyce.h.H.within].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href=".." class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Introduction
            </div>
          </div>
        </a>
      
      
        <a href="../dyce.plt/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              <tt>dyce.plt</tt>
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            <i>Copyright and other protections apply. Please see the accompanying <tt>LICENSE</tt> file for rights and restrictions governing use of this software. All rights not expressly waived or licensed are reserved. If that file is missing or appears to be modified from its original, then please contact the author before viewing or using this software in any capacity.</i>
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.sections", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../assets/javascripts/workers/search.4fa0e4ee.min.js", "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.1d3bfcf1.min.js"></script>
      
        <script src="../mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>