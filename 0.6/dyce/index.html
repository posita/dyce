
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Simple Python tools for dice-based probabilities">
      
      
        <meta name="author" content="Matt Bogosian">
      
      
        <link rel="canonical" href="https://posita.github.io/dyce/0.6/dyce/">
      
      
        <link rel="prev" href="../license/">
      
      
        <link rel="next" href="../dyce.evaluation/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>dyce - dyce</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.eebd395e.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dyce-package-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="dyce" class="md-header__button md-logo" aria-label="dyce" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            dyce
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              <tt>dyce</tt>
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="green" data-md-color-accent="green"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/posita/dyce" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="dyce" class="md-nav__button md-logo" aria-label="dyce" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    dyce
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/posita/dyce" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../countin/" class="md-nav__link">
        Countin’ with histograms and pools
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../rollin/" class="md-nav__link">
        Rollin’ with rollers and rolls
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../translations/" class="md-nav__link">
        Applications and translations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../notes/" class="md-nav__link">
        Release notes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contrib/" class="md-nav__link">
        Contributing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" checked>
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          <tt>dyce</tt>
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        <tt>dyce</tt>
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#dyce.h.H" class="md-nav__link">
    H
  </a>
  
    <nav class="md-nav" aria-label="H">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__slots__" class="md-nav__link">
    __slots__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.total" class="md-nav__link">
    total
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__abs__" class="md-nav__link">
    __abs__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__add__" class="md-nav__link">
    __add__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__and__" class="md-nav__link">
    __and__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__bool__" class="md-nav__link">
    __bool__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__contains__" class="md-nav__link">
    __contains__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__floordiv__" class="md-nav__link">
    __floordiv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__hash__" class="md-nav__link">
    __hash__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__invert__" class="md-nav__link">
    __invert__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__iter__" class="md-nav__link">
    __iter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__matmul__" class="md-nav__link">
    __matmul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__mod__" class="md-nav__link">
    __mod__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__mul__" class="md-nav__link">
    __mul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__ne__" class="md-nav__link">
    __ne__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__neg__" class="md-nav__link">
    __neg__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__or__" class="md-nav__link">
    __or__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__pos__" class="md-nav__link">
    __pos__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__pow__" class="md-nav__link">
    __pow__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__radd__" class="md-nav__link">
    __radd__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rand__" class="md-nav__link">
    __rand__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__reversed__" class="md-nav__link">
    __reversed__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rfloordiv__" class="md-nav__link">
    __rfloordiv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rmatmul__" class="md-nav__link">
    __rmatmul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rmod__" class="md-nav__link">
    __rmod__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rmul__" class="md-nav__link">
    __rmul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__ror__" class="md-nav__link">
    __ror__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rpow__" class="md-nav__link">
    __rpow__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rsub__" class="md-nav__link">
    __rsub__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rtruediv__" class="md-nav__link">
    __rtruediv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__rxor__" class="md-nav__link">
    __rxor__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__sub__" class="md-nav__link">
    __sub__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__truediv__" class="md-nav__link">
    __truediv__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.__xor__" class="md-nav__link">
    __xor__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.accumulate" class="md-nav__link">
    accumulate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.counts" class="md-nav__link">
    counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.distribution" class="md-nav__link">
    distribution()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.distribution_xy" class="md-nav__link">
    distribution_xy()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.draw" class="md-nav__link">
    draw()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.eq" class="md-nav__link">
    eq()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.exactly_k_times_in_n" class="md-nav__link">
    exactly_k_times_in_n()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.explode" class="md-nav__link">
    explode()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.foreach" class="md-nav__link">
    foreach()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.format" class="md-nav__link">
    format()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.ge" class="md-nav__link">
    ge()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.gt" class="md-nav__link">
    gt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.is_even" class="md-nav__link">
    is_even()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.is_odd" class="md-nav__link">
    is_odd()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.items" class="md-nav__link">
    items()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.keys" class="md-nav__link">
    keys()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.le" class="md-nav__link">
    le()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.lowest_terms" class="md-nav__link">
    lowest_terms()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.lt" class="md-nav__link">
    lt()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.map" class="md-nav__link">
    map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.mean" class="md-nav__link">
    mean()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.ne" class="md-nav__link">
    ne()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.order_stat_for_n_at_pos" class="md-nav__link">
    order_stat_for_n_at_pos()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.outcomes" class="md-nav__link">
    outcomes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.remove" class="md-nav__link">
    remove()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.reversed" class="md-nav__link">
    reversed()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.rmap" class="md-nav__link">
    rmap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.roll" class="md-nav__link">
    roll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.stdev" class="md-nav__link">
    stdev()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.substitute" class="md-nav__link">
    substitute()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.umap" class="md-nav__link">
    umap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.values" class="md-nav__link">
    values()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.variance" class="md-nav__link">
    variance()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.vs" class="md-nav__link">
    vs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.within" class="md-nav__link">
    within()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.h.H.zero_fill" class="md-nav__link">
    zero_fill()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dyce.p.P" class="md-nav__link">
    P
  </a>
  
    <nav class="md-nav" aria-label="P">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__slots__" class="md-nav__link">
    __slots__
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.total" class="md-nav__link">
    total
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__eq__" class="md-nav__link">
    __eq__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__getitem__" class="md-nav__link">
    __getitem__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__init__" class="md-nav__link">
    __init__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__iter__" class="md-nav__link">
    __iter__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__len__" class="md-nav__link">
    __len__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__matmul__" class="md-nav__link">
    __matmul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__ne__" class="md-nav__link">
    __ne__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__repr__" class="md-nav__link">
    __repr__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.__rmatmul__" class="md-nav__link">
    __rmatmul__()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.appearances_in_rolls" class="md-nav__link">
    appearances_in_rolls()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.foreach" class="md-nav__link">
    foreach()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.h" class="md-nav__link">
    h()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.is_homogeneous" class="md-nav__link">
    is_homogeneous()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.map" class="md-nav__link">
    map()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.rmap" class="md-nav__link">
    rmap()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.roll" class="md-nav__link">
    roll()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.rolls_with_counts" class="md-nav__link">
    rolls_with_counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dyce.p.P.umap" class="md-nav__link">
    umap()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dyce.evaluation/" class="md-nav__link">
        <tt>dyce.evaluation</tt>
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dyce.h/" class="md-nav__link">
        <tt>dyce.h</tt>
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dyce.r/" class="md-nav__link">
        <tt>dyce.r</tt>
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<!---
  Copyright and other protections apply. Please see the accompanying LICENSE file for
  rights and restrictions governing use of this software. All rights not expressly
  waived or licensed are reserved. If that file is missing or appears to be modified
  from its original, then please contact the author before viewing or using this
  software in any capacity.

  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  !!!!!!!!!!!!!!! IMPORTANT: READ THIS BEFORE EDITING! !!!!!!!!!!!!!!!
  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
  Please keep each sentence on its own unwrapped line.
  It looks like crap in a text editor, but it has no effect on rendering, and it allows much more useful diffs.
  Thank you!
-->

<h1 id="dyce-package-reference"><code class="highlight"><span class="n">dyce</span></code> package reference</h1>
<p><code class="highlight"><span class="n">dyce</span></code> revolves around two core primitives.
<a class="autorefs autorefs-internal" href="#dyce.h.H"><code>H</code> objects</a> are histograms (outcomes or individual dice).
<a class="autorefs autorefs-internal" href="#dyce.p.P"><code>P</code> objects</a> are collections of histograms (pools).</p>
<p>Additionally, the <a href="../dyce.evaluation/"><code>dyce.evaluation</code></a> package provides the <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.expandable"><code>expandable</code> decorator</a>, which is useful for substitutions, explosions, and modeling arbitrarily complex computations with dependent terms.
It also provides <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.foreach"><code>foreach</code></a> and <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.explode"><code>explode</code></a> as convenient shorthands.
The <a href="../dyce.r/"><code>dyce.r</code></a> package provides scalars, histograms, pools, operators, etc. for assembling reusable roller trees.</p>


<div class="doc doc-object doc-class">



<h2 id="dyce.h.H" class="doc doc-heading">
          <code>H</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="dyce.h._MappingT">_MappingT</span></code></p>

  
      <p>An immutable mapping for use as a histogram which supports arithmetic operations.
This is useful for modeling discrete outcomes, like individual dice. <code class="highlight"><span class="n">H</span></code>
objects encode finite discrete probability distributions as integer counts without
any denominator.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>The lack of an explicit denominator is intentional and has two benefits. First,
a denominator is redundant. Without it, one never has to worry about
probabilities summing to one (e.g., via miscalculation, floating point error,
etc.). Second (and perhaps more importantly), sometimes one wants to have an
insight into non-reduced counts, not just probabilities. If needed,
probabilities can always be derived, as shown below.</p>
</div>
<p>The <a class="autorefs autorefs-internal" href="#dyce.h.H.__init__">initializer</a> takes a single parameter, <em>items</em>. In its most
explicit form, <em>items</em> maps outcome values to counts.</p>
<p>Modeling a single six-sided die (<code>1d6</code>) can be expressed as:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>An iterable of pairs can also be used (similar to <code class="highlight"><span class="nb">dict</span></code>).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>Two shorthands are provided. If <em>items</em> is an iterable of numbers, counts of 1 are
assumed.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>Repeated items are accumulated, as one would expect.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>If <em>items</em> is an integer, it is shorthand for creating a sequential range <span class="arithmatex">\([{1} ..
{items}]\)</span> (or <span class="arithmatex">\([{items} .. {-1}]\)</span> if <em>items</em> is negative).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>Histograms are maps, so we can test equivalence against other maps.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">==</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>Simple indexes can be used to look up an outcome’s count.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))[</span><span class="mi">3</span><span class="p">]</span>
<span class="mi">2</span>
</code></pre></div></td></tr></table></div>
<p>Most arithmetic operators are supported and do what one would expect. If the operand
is a number, the operator applies to the outcomes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">+</span> <span class="mi">4</span>
<span class="n">H</span><span class="p">({</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="o">-</span><span class="n">d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>If the operand is another histogram, combinations are computed. Modeling the sum of
two six-sided dice (<code>2d6</code>) can be expressed as:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">7.00</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">2.42</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">5.83</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|</span><span class="c1">#####</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|</span><span class="c1">#####</span>
 <span class="mi">10</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
 <span class="mi">11</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
</code></pre></div></td></tr></table></div>
<p>To sum <span class="arithmatex">\({n}\)</span> identical histograms, the matrix multiplication operator (<code>@</code>)
provides a shorthand.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@d6</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>The <code class="highlight"><span class="nb">len</span></code> built-in function can be used to show the number of distinct
outcomes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span>
<span class="mi">11</span>
</code></pre></div></td></tr></table></div>
<p>The <a class="autorefs autorefs-internal" href="#dyce.h.H.total"><code>total</code> property</a> can be used to compute the total number of
combinations and each outcome’s probability.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">total</span>
<span class="mi">36</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">total</span><span class="p">))</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
<span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">36</span><span class="p">)),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">)),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">)),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">)),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">36</span><span class="p">)),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="o">...</span><span class="p">,</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">36</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
<p>Histograms provide common comparators (e.g., <a class="autorefs autorefs-internal" href="#dyce.h.H.eq"><code>eq</code></a>
<a class="autorefs autorefs-internal" href="#dyce.h.H.ne"><code>ne</code></a>, etc.). One way to count how often a first six-sided die
shows a different face than a second is:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">30</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.83</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.37</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.14</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">83.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################################</span>
</code></pre></div></td></tr></table></div>
<p>Or, how often a first six-sided die shows a face less than a second is:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">d6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.42</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.49</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.24</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#############################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
</code></pre></div></td></tr></table></div>
<p>Or how often at least one <code class="highlight"><span class="mi">2</span></code> will show when rolling four six-sided dice:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6_eq2</span> <span class="o">=</span> <span class="n">d6</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">;</span> <span class="n">d6_eq2</span>  <span class="c1"># how often a 2 shows on a single six-sided die</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">4</span><span class="nd">@d6_eq2</span>  <span class="c1"># count of 2s showing on 4d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">625</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">4</span><span class="nd">@d6_eq2</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># how often that count is at least one</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">625</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">671</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="mi">4</span><span class="nd">@d6_eq2</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.52</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.50</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.25</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">48.23</span><span class="o">%</span> <span class="o">|</span><span class="c1">########################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">51.77</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################</span>
</code></pre></div></td></tr></table></div>
<div class="admonition bug">
<p class="admonition-title">Mind your parentheses</p>
<p>Parentheses are often necessary to enforce the desired order of operations. This
is most often an issue with the <code class="highlight"><span class="o">@</span></code> operator, because it behaves
differently than the <code>d</code> operator in most dedicated grammars. More
specifically, in Python, <code class="highlight"><span class="o">@</span></code> has a <a href="https://docs.python.org/3/reference/expressions.html#operator-precedence">lower
precedence</a>
than <code class="highlight"><span class="o">.</span></code> and <code class="highlight"><span class="p">[</span><span class="err">…</span><span class="p">]</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>  <span class="c1"># type: ignore [operator]</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="o">...</span>
<span class="ne">KeyError</span><span class="p">:</span> <span class="mi">7</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># probably not what was intended</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">36</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="o">@</span><span class="p">(</span><span class="n">d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">))</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)[</span><span class="mi">7</span><span class="p">]</span>
<span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">21</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@d6</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@d6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="kc">False</span>
</code></pre></div></td></tr></table></div>
</div>
<p>Counts are generally accumulated without reduction. To reduce, call the
<a class="autorefs autorefs-internal" href="#dyce.h.H.lowest_terms"><code>lowest_terms</code> method</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>Testing equivalence implicitly performs reductions of operands.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>

            <details class="quote">
              <summary>Source code in <code>dyce/h.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">H</span><span class="p">(</span><span class="n">_MappingT</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An immutable mapping for use as a histogram which supports arithmetic operations.</span>
<span class="sd">    This is useful for modeling discrete outcomes, like individual dice. ``#!python H``</span>
<span class="sd">    objects encode finite discrete probability distributions as integer counts without</span>
<span class="sd">    any denominator.</span>

<span class="sd">    !!! info</span>

<span class="sd">        The lack of an explicit denominator is intentional and has two benefits. First,</span>
<span class="sd">        a denominator is redundant. Without it, one never has to worry about</span>
<span class="sd">        probabilities summing to one (e.g., via miscalculation, floating point error,</span>
<span class="sd">        etc.). Second (and perhaps more importantly), sometimes one wants to have an</span>
<span class="sd">        insight into non-reduced counts, not just probabilities. If needed,</span>
<span class="sd">        probabilities can always be derived, as shown below.</span>

<span class="sd">    The [initializer][dyce.h.H.__init__] takes a single parameter, *items*. In its most</span>
<span class="sd">    explicit form, *items* maps outcome values to counts.</span>

<span class="sd">    Modeling a single six-sided die (``1d6``) can be expressed as:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from dyce import H</span>
<span class="sd">    &gt;&gt;&gt; d6 = H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    An iterable of pairs can also be used (similar to ``#!python dict``).</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 == H(((1, 1), (2, 1), (3, 1), (4, 1), (5, 1), (6, 1)))</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    Two shorthands are provided. If *items* is an iterable of numbers, counts of 1 are</span>
<span class="sd">    assumed.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 == H((1, 2, 3, 4, 5, 6))</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    Repeated items are accumulated, as one would expect.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">    H({2: 1, 3: 2, 4: 2, 5: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    If *items* is an integer, it is shorthand for creating a sequential range $[{1} ..</span>
<span class="sd">    {items}]$ (or $[{items} .. {-1}]$ if *items* is negative).</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 == H(6)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    Histograms are maps, so we can test equivalence against other maps.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6) == {1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1}</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    Simple indexes can be used to look up an outcome’s count.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H((2, 3, 3, 4, 4, 5))[3]</span>
<span class="sd">    2</span>

<span class="sd">    ```</span>

<span class="sd">    Most arithmetic operators are supported and do what one would expect. If the operand</span>
<span class="sd">    is a number, the operator applies to the outcomes.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 + 4</span>
<span class="sd">    H({5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 * -1</span>
<span class="sd">    H({-6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1})</span>
<span class="sd">    &gt;&gt;&gt; d6 * -1 == -d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; d6 * -1 == H(-6)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    If the operand is another histogram, combinations are computed. Modeling the sum of</span>
<span class="sd">    two six-sided dice (``2d6``) can be expressed as:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 + d6</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>
<span class="sd">    &gt;&gt;&gt; print((d6 + d6).format())</span>
<span class="sd">    avg |    7.00</span>
<span class="sd">    std |    2.42</span>
<span class="sd">    var |    5.83</span>
<span class="sd">      2 |   2.78% |#</span>
<span class="sd">      3 |   5.56% |##</span>
<span class="sd">      4 |   8.33% |####</span>
<span class="sd">      5 |  11.11% |#####</span>
<span class="sd">      6 |  13.89% |######</span>
<span class="sd">      7 |  16.67% |########</span>
<span class="sd">      8 |  13.89% |######</span>
<span class="sd">      9 |  11.11% |#####</span>
<span class="sd">     10 |   8.33% |####</span>
<span class="sd">     11 |   5.56% |##</span>
<span class="sd">     12 |   2.78% |#</span>

<span class="sd">    ```</span>

<span class="sd">    To sum ${n}$ identical histograms, the matrix multiplication operator (``@``)</span>
<span class="sd">    provides a shorthand.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; 3@d6 == d6 + d6 + d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    The ``#!python len`` built-in function can be used to show the number of distinct</span>
<span class="sd">    outcomes.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; len(2@d6)</span>
<span class="sd">    11</span>

<span class="sd">    ```</span>

<span class="sd">    The [``total`` property][dyce.h.H.total] can be used to compute the total number of</span>
<span class="sd">    combinations and each outcome’s probability.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from fractions import Fraction</span>
<span class="sd">    &gt;&gt;&gt; (2@d6).total</span>
<span class="sd">    36</span>
<span class="sd">    &gt;&gt;&gt; [(outcome, Fraction(count, (2@d6).total)) for outcome, count in (2@d6).items()]</span>
<span class="sd">    [(2, Fraction(1, 36)), (3, Fraction(1, 18)), (4, Fraction(1, 12)), (5, Fraction(1, 9)), (6, Fraction(5, 36)), (7, Fraction(1, 6)), ..., (12, Fraction(1, 36))]</span>

<span class="sd">    ```</span>

<span class="sd">    Histograms provide common comparators (e.g., [``eq``][dyce.h.H.eq]</span>
<span class="sd">    [``ne``][dyce.h.H.ne], etc.). One way to count how often a first six-sided die</span>
<span class="sd">    shows a different face than a second is:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6.ne(d6)</span>
<span class="sd">    H({False: 6, True: 30})</span>
<span class="sd">    &gt;&gt;&gt; print(d6.ne(d6).format())</span>
<span class="sd">    avg |    0.83</span>
<span class="sd">    std |    0.37</span>
<span class="sd">    var |    0.14</span>
<span class="sd">      0 |  16.67% |########</span>
<span class="sd">      1 |  83.33% |#########################################</span>

<span class="sd">    ```</span>

<span class="sd">    Or, how often a first six-sided die shows a face less than a second is:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6.lt(d6)</span>
<span class="sd">    H({False: 21, True: 15})</span>
<span class="sd">    &gt;&gt;&gt; print(d6.lt(d6).format())</span>
<span class="sd">    avg |    0.42</span>
<span class="sd">    std |    0.49</span>
<span class="sd">    var |    0.24</span>
<span class="sd">      0 |  58.33% |#############################</span>
<span class="sd">      1 |  41.67% |####################</span>

<span class="sd">    ```</span>

<span class="sd">    Or how often at least one ``#!python 2`` will show when rolling four six-sided dice:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6_eq2 = d6.eq(2) ; d6_eq2  # how often a 2 shows on a single six-sided die</span>
<span class="sd">    H({False: 5, True: 1})</span>
<span class="sd">    &gt;&gt;&gt; 4@d6_eq2  # count of 2s showing on 4d6</span>
<span class="sd">    H({0: 625, 1: 500, 2: 150, 3: 20, 4: 1})</span>
<span class="sd">    &gt;&gt;&gt; (4@d6_eq2).ge(1)  # how often that count is at least one</span>
<span class="sd">    H({False: 625, True: 671})</span>
<span class="sd">    &gt;&gt;&gt; print((4@d6_eq2).ge(1).format())</span>
<span class="sd">    avg |    0.52</span>
<span class="sd">    std |    0.50</span>
<span class="sd">    var |    0.25</span>
<span class="sd">      0 |  48.23% |########################</span>
<span class="sd">      1 |  51.77% |#########################</span>

<span class="sd">    ```</span>

<span class="sd">    !!! bug &quot;Mind your parentheses&quot;</span>

<span class="sd">        Parentheses are often necessary to enforce the desired order of operations. This</span>
<span class="sd">        is most often an issue with the ``#!python @`` operator, because it behaves</span>
<span class="sd">        differently than the ``d`` operator in most dedicated grammars. More</span>
<span class="sd">        specifically, in Python, ``#!python @`` has a [lower</span>
<span class="sd">        precedence](https://docs.python.org/3/reference/expressions.html#operator-precedence)</span>
<span class="sd">        than ``#!python .`` and ``#!python […]``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; 2@d6[7]  # type: ignore [operator]</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">          ...</span>
<span class="sd">        KeyError: 7</span>
<span class="sd">        &gt;&gt;&gt; 2@d6.le(7)  # probably not what was intended</span>
<span class="sd">        H({2: 36})</span>
<span class="sd">        &gt;&gt;&gt; 2@d6.le(7) == 2@(d6.le(7))</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; (2@d6)[7]</span>
<span class="sd">        6</span>
<span class="sd">        &gt;&gt;&gt; (2@d6).le(7)</span>
<span class="sd">        H({False: 15, True: 21})</span>
<span class="sd">        &gt;&gt;&gt; 2@d6.le(7) == (2@d6).le(7)</span>
<span class="sd">        False</span>

<span class="sd">        ```</span>

<span class="sd">    Counts are generally accumulated without reduction. To reduce, call the</span>
<span class="sd">    [``lowest_terms`` method][dyce.h.H.lowest_terms].</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6.ge(4)</span>
<span class="sd">    H({False: 3, True: 3})</span>
<span class="sd">    &gt;&gt;&gt; d6.ge(4).lowest_terms()</span>
<span class="sd">    H({False: 1, True: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    Testing equivalence implicitly performs reductions of operands.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6.ge(4) == d6.ge(4).lowest_terms()</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_h&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_hash&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_lowest_terms&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_order_stat_funcs_by_n&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_total&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># ---- Initializer -----------------------------------------------------------------</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">:</span> <span class="n">_MappingT</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">_h</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">items</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">simple_init</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
                <span class="n">outcome_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span>
                    <span class="n">simple_init</span> <span class="k">if</span> <span class="n">simple_init</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span>
                    <span class="mi">0</span> <span class="k">if</span> <span class="n">simple_init</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">simple_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="c1"># if isinstance(items, RealLike):</span>
                <span class="c1">#     outcome_type = type(items)</span>
                <span class="c1">#     self._h = {outcome_type(i): 1 for i in outcome_range}</span>
                <span class="c1"># else:</span>
                <span class="c1">#     self._h = {i: 1 for i in outcome_range}</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">)</span>
                <span class="n">outcome_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="p">{</span><span class="n">outcome_type</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">outcome_range</span><span class="p">}</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">_h</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">IterableC</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
                <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

            <span class="c1"># items is either an Iterable[RealLike] or an Iterable[tuple[RealLike,</span>
            <span class="c1"># SupportsInt]] (although this technically supports Iterable[RealLike |</span>
            <span class="c1"># tuple[RealLike, SupportsInt]])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">sorted_items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">sorted_items</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="n">sorted_items</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">natural_key</span><span class="p">)</span>

            <span class="c1"># As of Python 3.7, insertion order of keys is preserved</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_items</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                    <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">item</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">outcome</span> <span class="o">=</span> <span class="n">item</span>
                    <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>

                <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;count for </span><span class="si">{</span><span class="n">outcome</span><span class="si">}</span><span class="s2"> cannot be negative&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unrecognized initializer type </span><span class="si">{</span><span class="n">items</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># We can&#39;t use something like functools.lru_cache for these values because those</span>
        <span class="c1"># mechanisms call this object&#39;s __hash__ method which relies on both of these</span>
        <span class="c1"># and we don&#39;t want a circular dependency when computing this object&#39;s hash.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">H</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># We don&#39;t use functools&#39; caching mechanisms generally because they don&#39;t</span>
        <span class="c1"># present a good mechanism for scoping the cache to object instances such that</span>
        <span class="c1"># the cache will be purged when the object is deleted. functools.cached_property</span>
        <span class="c1"># is an exception, but it requires that objects have proper __dict__ values,</span>
        <span class="c1"># which Hs do not. So we basically do what functools.cached_property does, but</span>
        <span class="c1"># without a __dict__.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="n">H</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># ---- Overrides -------------------------------------------------------------------</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">dict</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
            <span class="k">return</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
            <span class="k">return</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span><span class="o">.</span><span class="n">_h</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
            <span class="k">return</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># type: ignore [override]</span>
        <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__add__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__sub__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__sub__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__mul__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__mul__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">if</span> <span class="n">other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;argument cannot be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sum_h</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rmatmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__matmul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__truediv__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__truediv__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__floordiv__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__floordiv__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__mod__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__mod__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__pow__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__pow__</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
    <span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;HableT&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__and__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="fm">__and__</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
    <span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;HableT&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__xor__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rxor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="fm">__xor__</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
    <span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;HableT&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
                <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__or__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__ror__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="fm">__or__</span><span class="p">)</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__neg__</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__pos__</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__abs__</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__invert__</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValuesView</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        More descriptive synonym for the [``values`` method][dyce.h.H.values].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ItemsView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KeysView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KeysView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        More descriptive synonym for the [``keys`` method][dyce.h.H.keys].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">reversed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValuesView</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">()</span>

    <span class="c1"># ---- Properties ------------------------------------------------------------------</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">total</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            This property should be considered experimental and may change or disappear</span>
<span class="sd">            in future versions.</span>

<span class="sd">        Equivalent to ``#!python sum(self.counts())``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span>

    <span class="c1"># ---- Methods ---------------------------------------------------------------------</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@deprecated</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">foreach</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">dependent_term</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">HOrOutcomeT</span><span class="p">],</span>
        <span class="o">**</span><span class="n">independent_sources</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Deprecated&quot;</span>

<span class="sd">            This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">            the [``expandable`` decorator][dyce.evaluation.expandable] and</span>
<span class="sd">            [``foreach`` function][dyce.evaluation.foreach] for more flexible</span>
<span class="sd">            alternatives.</span>

<span class="sd">        Calls ``#!python dependent_term`` for each set of outcomes from the product of</span>
<span class="sd">        ``independent_sources`` and accumulates the results. This is useful for</span>
<span class="sd">        resolving dependent probabilities. Returned histograms are always reduced to</span>
<span class="sd">        their lowest terms.</span>

<span class="sd">        For example rolling a d20, re-rolling a ``#!python 1`` if it comes up, and</span>
<span class="sd">        keeping the result might be expressed as[^1]:</span>

<span class="sd">        [^1]:</span>

<span class="sd">            This is primarily for illustration. [``H.substitute``][dyce.h.H.substitute]</span>
<span class="sd">            is often better suited to cases involving re-rolling a single independent</span>
<span class="sd">            term such as this one.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d20 = H(20)</span>

<span class="sd">        &gt;&gt;&gt; def reroll_one_dependent_term(d20_outcome):</span>
<span class="sd">        ...   if d20_outcome == 1:</span>
<span class="sd">        ...     return d20</span>
<span class="sd">        ...   else:</span>
<span class="sd">        ...     return d20_outcome</span>

<span class="sd">        &gt;&gt;&gt; H.foreach(reroll_one_dependent_term, d20_outcome=d20)</span>
<span class="sd">        H({1: 1, 2: 21, 3: 21, ..., 19: 21, 20: 21})</span>

<span class="sd">        ```</span>

<span class="sd">        The ``#!python foreach`` class method merely wraps *dependent_term* and calls</span>
<span class="sd">        [``P.foreach``][dyce.p.P.foreach]. In doing so, it imposes a very modest</span>
<span class="sd">        overhead that is negligible in most cases.</span>

<span class="sd">        ``` python</span>
<span class="sd">        --8&lt;-- &quot;docs/assets/perf_foreach.txt&quot;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;details&gt;</span>
<span class="sd">        &lt;summary&gt;Source: &lt;a href=&quot;https://github.com/posita/dyce/blob/latest/docs/assets/perf_foreach.ipy&quot;&gt;&lt;code&gt;perf_foreach.ipy&lt;/code&gt;&lt;/a&gt;&lt;/summary&gt;</span>

<span class="sd">        ``` python</span>
<span class="sd">        --8&lt;-- &quot;docs/assets/perf_foreach.ipy&quot;</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/details&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">P</span>

        <span class="k">def</span> <span class="nf">_dependent_term</span><span class="p">(</span><span class="o">**</span><span class="n">roll_kw</span><span class="p">):</span>
            <span class="n">outcome_kw</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">roll</span> <span class="ow">in</span> <span class="n">roll_kw</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
                <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
                <span class="n">outcome_kw</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">roll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">dependent_term</span><span class="p">(</span><span class="o">**</span><span class="n">outcome_kw</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">P</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">_dependent_term</span><span class="p">,</span> <span class="o">**</span><span class="n">independent_sources</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bin_op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies *bin_op* to each outcome of the histogram as the left operand and</span>
<span class="sd">        *right_operand* as the right. Shorthands exist for many arithmetic operators and</span>
<span class="sd">        comparators.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import operator</span>
<span class="sd">        &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">        &gt;&gt;&gt; d6.map(operator.__add__, d6)</span>
<span class="sd">        H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>
<span class="sd">        &gt;&gt;&gt; d6.map(operator.__add__, d6) == d6 + d6</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6.map(operator.__pow__, 2)</span>
<span class="sd">        H({1: 1, 4: 1, 9: 1, 16: 1, 25: 1, 36: 1})</span>
<span class="sd">        &gt;&gt;&gt; d6.map(operator.__pow__, 2) == d6 ** 2</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6.map(operator.__gt__, 3)</span>
<span class="sd">        H({False: 3, True: 3})</span>
<span class="sd">        &gt;&gt;&gt; d6.map(operator.__gt__, 3) == d6.gt(3)</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_operand</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
            <span class="n">right_operand</span> <span class="o">=</span> <span class="n">right_operand</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_operand</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
                <span class="p">(</span><span class="n">bin_op</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">o</span><span class="p">),</span> <span class="bp">self</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">right_operand</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
                <span class="p">(</span><span class="n">bin_op</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">rmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_operand</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">bin_op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Analogous to the [``map`` method][dyce.h.H.map], but where the caller supplies</span>
<span class="sd">        *left_operand*.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import operator</span>
<span class="sd">        &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">        &gt;&gt;&gt; d6.rmap(2, operator.__pow__)</span>
<span class="sd">        H({2: 1, 4: 1, 8: 1, 16: 1, 32: 1, 64: 1})</span>
<span class="sd">        &gt;&gt;&gt; d6.rmap(2, operator.__pow__) == 2 ** d6</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        !!! note</span>

<span class="sd">            The positions of *left_operand* and *bin_op* are different from</span>
<span class="sd">            [``map`` method][dyce.h.H.map]. This is intentional and serves as a reminder</span>
<span class="sd">            of operand ordering.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
            <span class="p">(</span><span class="n">bin_op</span><span class="p">(</span><span class="n">left_operand</span><span class="p">,</span> <span class="n">outcome</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">umap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">un_op</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Applies *un_op* to each outcome of the histogram.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import operator</span>
<span class="sd">        &gt;&gt;&gt; H(6).umap(operator.__neg__)</span>
<span class="sd">        H({-6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(4).umap(lambda outcome: (-outcome) ** outcome)</span>
<span class="sd">        H({-27: 1, -1: 1, 4: 1, 256: 1})</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)((</span><span class="n">un_op</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python self.map(operator.__lt__, other).umap(bool)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).lt(3)</span>
<span class="sd">        H({False: 4, True: 2})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__lt__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python self.map(operator.__le__, other).umap(bool)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).le(3)</span>
<span class="sd">        H({False: 3, True: 3})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__le__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python self.map(operator.__eq__, other).umap(bool)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).eq(3)</span>
<span class="sd">        H({False: 5, True: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__eq__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python self.map(operator.__ne__, other).umap(bool)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).ne(3)</span>
<span class="sd">        H({False: 1, True: 5})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__ne__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python self.map(operator.__gt__, other).umap(bool)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).gt(3)</span>
<span class="sd">        H({False: 3, True: 3})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__gt__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python self.map(operator.__ge__, other).umap(bool)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).ge(3)</span>
<span class="sd">        H({False: 2, True: 4})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__ge__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to ``#!python self.umap(dyce.types.is_even)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).is_even()</span>
<span class="sd">        H({False: 2, True: 4})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``umap`` method][dyce.h.H.umap].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_even</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">is_odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equivalent to ``#!python self.umap(dyce.types.is_odd)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).is_odd()</span>
<span class="sd">        H({False: 4, True: 2})</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``umap`` method][dyce.h.H.umap].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_odd</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Accumulates counts.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(4).accumulate(H(6))</span>
<span class="sd">        H({1: 2, 2: 2, 3: 2, 4: 2, 5: 1, 6: 1})</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">cast</span><span class="p">(</span><span class="n">_SourceT</span><span class="p">,</span> <span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcomes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">RealLike</span><span class="p">],</span> <span class="n">_MappingT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            This property should be considered experimental and may change or disappear</span>
<span class="sd">            in future versions.</span>

<span class="sd">        Returns a new [``H`` object][dyce.h.H] where the counts associated with</span>
<span class="sd">        *outcomes* has been updated. This may be useful for using histograms to model</span>
<span class="sd">        decks of cards (rather than dice). If *outcome* is ``#!python None``, this is</span>
<span class="sd">        equivalent to ``#!python self.draw(self.roll())``.</span>

<span class="sd">        If *outcomes* is a single value, that value’s count is decremented by one. If</span>
<span class="sd">        *outcomes* is an iterable of values, those values’ outcomes are decremented by</span>
<span class="sd">        one for each time that outcome appears. If *outcomes* is a mapping of outcomes</span>
<span class="sd">        to counts, those outcomes are decremented by the respective counts.</span>

<span class="sd">        Counts are not reduced and zero counts are preserved. To reduce, call the</span>
<span class="sd">        [``lowest_terms`` method][dyce.h.H.lowest_terms].</span>

<span class="sd">        &lt;!-- BEGIN MONKEY PATCH --</span>
<span class="sd">        For deterministic outcomes.</span>

<span class="sd">        &gt;&gt;&gt; import random</span>
<span class="sd">        &gt;&gt;&gt; from dyce import rng</span>
<span class="sd">        &gt;&gt;&gt; rng.RNG = random.Random(1691413956)</span>

<span class="sd">          -- END MONKEY PATCH --&gt;</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).draw()</span>
<span class="sd">        H({1: 1, 2: 1, 3: 1, 4: 0, 5: 1, 6: 1})</span>

<span class="sd">        &gt;&gt;&gt; H(6).draw(2)</span>
<span class="sd">        H({1: 1, 2: 0, 3: 1, 4: 1, 5: 1, 6: 1})</span>

<span class="sd">        &gt;&gt;&gt; H(6).draw((2, 3, 4, 5)).lowest_terms()</span>
<span class="sd">        H({1: 1, 6: 1})</span>

<span class="sd">        &gt;&gt;&gt; h = H(6).accumulate(H(4)) ; h</span>
<span class="sd">        H({1: 2, 2: 2, 3: 2, 4: 2, 5: 1, 6: 1})</span>
<span class="sd">        &gt;&gt;&gt; h.draw({1: 2, 4: 1, 6: 1})</span>
<span class="sd">        H({1: 0, 2: 2, 3: 2, 4: 1, 5: 1, 6: 0})</span>

<span class="sd">        ```</span>

<span class="sd">        !!! tip &quot;Negative counts can be used to increase counts&quot;</span>

<span class="sd">            Where *outcomes* is a mapping of outcomes to counts, negative counts can be</span>
<span class="sd">            used to *increase* or “add” outcomes’ counts.</span>

<span class="sd">            ``` python</span>
<span class="sd">            &gt;&gt;&gt; H(4).draw({5: -1})</span>
<span class="sd">            H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1})</span>

<span class="sd">            ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">outcomes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roll</span><span class="p">())</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">):</span>
            <span class="n">outcomes</span> <span class="o">=</span> <span class="p">(</span><span class="n">outcomes</span><span class="p">,)</span>

        <span class="n">to_draw_outcome_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
        <span class="n">self_outcome_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1"># This approach is necessary because Counter.__sub__ does not preserve negative</span>
        <span class="c1"># counts and Counter.subtract modifies the counter in-place</span>
        <span class="n">new_outcome_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">self_outcome_counts</span><span class="p">)</span>
        <span class="n">new_outcome_counts</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">to_draw_outcome_counts</span><span class="p">)</span>
        <span class="n">would_go_negative</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="o">+</span><span class="n">to_draw_outcome_counts</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="o">+</span><span class="n">self_outcome_counts</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">would_go_negative</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;outcomes to be drawn </span><span class="si">{</span><span class="n">would_go_negative</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">zeros</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">self_outcome_counts</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_outcome_counts</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">zeros</span><span class="p">:</span>
            <span class="n">new_outcome_counts</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">new_outcome_counts</span><span class="p">)</span>

    <span class="nd">@experimental</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">exactly_k_times_in_n</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span>
        <span class="n">n</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span>
        <span class="n">k</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            This method should be considered experimental and may change or disappear in</span>
<span class="sd">            future versions.</span>

<span class="sd">        Computes (in constant time) and returns the number of times *outcome* appears</span>
<span class="sd">        exactly *k* times among ``#!python n@self``. This is a more efficient</span>
<span class="sd">        alternative to ``#!python (n@(self.eq(outcome)))[k]``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).exactly_k_times_in_n(outcome=5, n=4, k=2)</span>
<span class="sd">        150</span>
<span class="sd">        &gt;&gt;&gt; H((2, 3, 3, 4, 4, 5)).exactly_k_times_in_n(outcome=2, n=3, k=3)</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; H((2, 3, 3, 4, 4, 5)).exactly_k_times_in_n(outcome=4, n=3, k=3)</span>
<span class="sd">        8</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="k">assert</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span>
        <span class="n">c_outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">c_outcome</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">-</span> <span class="n">c_outcome</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="n">IntegralLike</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@deprecated</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IntegralLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Deprecated&quot;</span>

<span class="sd">            This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">            the [``explode`` function][dyce.evaluation.explode] for a more flexible</span>
<span class="sd">            alternative.</span>

<span class="sd">        Shorthand for ``#!python self.substitute(lambda h, outcome: outcome if len(h) == 1</span>
<span class="sd">        else h if outcome == max(h) else outcome, operator.__add__, max_depth,</span>
<span class="sd">        precision_limit)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).explode(max_depth=2)</span>
<span class="sd">        H({1: 36, 2: 36, 3: 36, 4: 36, 5: 36, 7: 6, 8: 6, 9: 6, 10: 6, 11: 6, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        This method guards against excessive recursion by returning ``#!python outcome``</span>
<span class="sd">        if the passed histogram has only one face. See the [``substitute``</span>
<span class="sd">        method][dyce.h.H.substitute].</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span> <span class="nf">_explode</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HOrOutcomeT</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">outcome</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">h</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">else</span> <span class="n">outcome</span>

        <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;only one of max_depth and precision_limit is allowed&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">_explode</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">_explode</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">,</span> <span class="n">precision_limit</span><span class="o">=</span><span class="n">precision_limit</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">_explode</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">lowest_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes and returns a histogram whose nonzero counts share a greatest</span>
<span class="sd">        common divisor of 1.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; df_obscured = H({-2: 0, -1: 2, 0: 2, 1: 2, 2: 0})</span>
<span class="sd">        &gt;&gt;&gt; df_obscured.lowest_terms()</span>
<span class="sd">        H({-1: 1, 0: 1, 1: 1})</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">counts_gcd</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>

            <span class="k">if</span> <span class="n">counts_gcd</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
                    <span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="o">//</span> <span class="n">counts_gcd</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span>

    <span class="nd">@experimental</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">order_stat_for_n_at_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            This method should be considered experimental and may change or disappear in</span>
<span class="sd">            future versions.</span>

<span class="sd">        Computes the probability distribution for each outcome appearing in at *pos* for</span>
<span class="sd">        *n* histograms. *pos* is a zero-based index.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6avg = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">        &gt;&gt;&gt; d6avg.order_stat_for_n_at_pos(5, 3)  # counts where outcome appears in the fourth of five positions</span>
<span class="sd">        H({2: 26, 3: 1432, 4: 4792, 5: 1526})</span>

<span class="sd">        ```</span>

<span class="sd">        The results show that, when rolling five six-sided “averaging” dice and sorting</span>
<span class="sd">        each roll, there are 26 ways where ``#!python 2`` appears at the fourth (index</span>
<span class="sd">        ``#!python 3``) position, 1432 ways where ``#!python 3`` appears at the fourth</span>
<span class="sd">        position, etc. This can be verified independently using the computationally</span>
<span class="sd">        expensive method of enumerating rolls and counting those that meet the criteria.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; from dyce import P</span>
<span class="sd">        &gt;&gt;&gt; p_5d6avg = 5@P(d6avg)</span>
<span class="sd">        &gt;&gt;&gt; sum(count for roll, count in p_5d6avg.rolls_with_counts() if roll[3] == 5)</span>
<span class="sd">        1526</span>

<span class="sd">        ```</span>

<span class="sd">        Negative values for *pos* follow Python index semantics:</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">        &gt;&gt;&gt; d6.order_stat_for_n_at_pos(6, 0) == d6.order_stat_for_n_at_pos(6, -6)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; d6.order_stat_for_n_at_pos(6, 5) == d6.order_stat_for_n_at_pos(6, -1)</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        This method caches computing the betas for *n* so they can be reused for varying</span>
<span class="sd">        values of *pos* in subsequent calls.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># See &lt;https://math.stackexchange.com/q/4173084/226394&gt; for motivation</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_func_for_n</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">pos</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">[</span><span class="n">n</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
            <span class="p">(</span><span class="n">orig_outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">orig_outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">orig_outcome</span> <span class="o">!=</span> <span class="n">outcome</span>
        <span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="n">IntegralLike</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="n">IntegralLike</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@deprecated</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
        <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span>
        <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IntegralLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Deprecated&quot;</span>

<span class="sd">            This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">            the [``expandable`` decorator][dyce.evaluation.expandable] and</span>
<span class="sd">            [``foreach`` function][dyce.evaluation.foreach] for more flexible</span>
<span class="sd">            alternatives.</span>

<span class="sd">        Calls *expand* on each outcome. If *expand* returns a single outcome, it</span>
<span class="sd">        replaces the existing outcome. If it returns an [``H`` object][dyce.h.H],</span>
<span class="sd">        evaluation is performed again (recursively) on that object until a limit (either</span>
<span class="sd">        *max_depth* or *precision_limit*) is exhausted. *coalesce* is called on the</span>
<span class="sd">        original outcome and the expanded histogram or outcome and the returned</span>
<span class="sd">        histogram is “folded” into result. The default behavior for *coalesce* is to</span>
<span class="sd">        replace the outcome with the expanded histogram. Returned histograms are always</span>
<span class="sd">        reduced to their lowest terms.</span>

<span class="sd">        !!! note &quot;*coalesce* is not called unless *expand* returns a histogram&quot;</span>

<span class="sd">            If *expand* returns a single outcome, it *always* replaces the existing</span>
<span class="sd">            outcome. This is intentional. To return a single outcome, but trigger</span>
<span class="sd">            *coalesce*, characterize that outcome as a single-sided die (e.g.,</span>
<span class="sd">            ``#!python H({outcome: 1})``.</span>

<span class="sd">        See the [``coalesce_replace``][dyce.h.coalesce_replace] and</span>
<span class="sd">        [``lowest_terms``][dyce.h.H.lowest_terms] methods.</span>

<span class="sd">        !!! tip &quot;Precision limits&quot;</span>

<span class="sd">            The *max_depth* parameter is similar to an</span>
<span class="sd">            [``expandable``][dyce.evaluation.expandable]-decorated function’s limit</span>
<span class="sd">            argument when given a whole number. The *precision_limit* parameter is</span>
<span class="sd">            similar to an [``expandable``][dyce.evaluation.expandable]-decorated</span>
<span class="sd">            function’s limit argument being provided a fractional value. It is an error</span>
<span class="sd">            to provide values for both *max_depth* and *precision_limit*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">.evaluation</span> <span class="kn">import</span> <span class="n">HResult</span><span class="p">,</span> <span class="n">LimitT</span><span class="p">,</span> <span class="n">expandable</span>

        <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;only one of max_depth and precision_limit is allowed&quot;</span><span class="p">)</span>

        <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LimitT</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">max_depth</span> <span class="k">if</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">precision_limit</span>
        <span class="p">)</span>

        <span class="nd">@expandable</span><span class="p">(</span><span class="n">sentinel</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">def</span> <span class="nf">_expand</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="n">HResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HOrOutcomeT</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">outcome</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">_expand</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">result</span><span class="o">.</span><span class="n">outcome</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span> <span class="k">else</span> <span class="n">res</span>

        <span class="k">return</span> <span class="n">_expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">vs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compares the histogram with *other*. -1 represents where *other* is greater. 0</span>
<span class="sd">        represents where they are equal. 1 represents where *other* is less.</span>

<span class="sd">        Shorthand for ``#!python self.within(0, 0, other)``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(6).vs(H(4))</span>
<span class="sd">        H({-1: 6, 0: 4, 1: 14})</span>
<span class="sd">        &gt;&gt;&gt; H(6).vs(H(4)) == H(6).within(0, 0, H(4))</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        See the [``within`` method][dyce.h.H.within].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Computes the difference between the histogram and *other*. -1 represents where that</span>
<span class="sd">        difference is less than *lo*. 0 represents where that difference between *lo*</span>
<span class="sd">        and *hi* (inclusive). 1 represents where that difference is greater than *hi*.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6_2 = 2@H(6)</span>
<span class="sd">        &gt;&gt;&gt; d6_2.within(7, 9)</span>
<span class="sd">        H({-1: 15, 0: 15, 1: 6})</span>
<span class="sd">        &gt;&gt;&gt; print(d6_2.within(7, 9).format())</span>
<span class="sd">        avg |   -0.25</span>
<span class="sd">        std |    0.72</span>
<span class="sd">        var |    0.52</span>
<span class="sd">         -1 |  41.67% |####################</span>
<span class="sd">          0 |  41.67% |####################</span>
<span class="sd">          1 |  16.67% |########</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6_3, d8_2 = 3@H(6), 2@H(8)</span>
<span class="sd">        &gt;&gt;&gt; d6_3.within(-1, 1, d8_2)  # 3d6 w/in 1 of 2d8</span>
<span class="sd">        H({-1: 3500, 0: 3412, 1: 6912})</span>
<span class="sd">        &gt;&gt;&gt; print(d6_3.within(-1, 1, d8_2).format())</span>
<span class="sd">        avg |    0.25</span>
<span class="sd">        std |    0.83</span>
<span class="sd">        var |    0.69</span>
<span class="sd">         -1 |  25.32% |############</span>
<span class="sd">          0 |  24.68% |############</span>
<span class="sd">          1 |  50.00% |#########################</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_within</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">),</span> <span class="n">other</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">zero_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">RealLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python self.accumulate({outcome: 0 for outcome in</span>
<span class="sd">        outcomes})``.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(4).zero_fill(H(8).outcomes())</span>
<span class="sd">        H({1: 1, 2: 1, 3: 1, 4: 1, 5: 0, 6: 0, 7: 0, 8: 0})</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulate</span><span class="p">({</span><span class="n">outcome</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="p">})</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">distribution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">]]:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="nf">distribution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rational_t</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">_T</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]:</span>
        <span class="o">...</span>

    <span class="nd">@experimental</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">distribution</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">rational_t</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Presentation helper function returning an iterator for each outcome/count or</span>
<span class="sd">        outcome/probability pair.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; h = H((1, 2, 3, 3, 4, 4, 5, 6))</span>
<span class="sd">        &gt;&gt;&gt; list(h.distribution())</span>
<span class="sd">        [(1, Fraction(1, 8)), (2, Fraction(1, 8)), (3, Fraction(1, 4)), (4, Fraction(1, 4)), (5, Fraction(1, 8)), (6, Fraction(1, 8))]</span>
<span class="sd">        &gt;&gt;&gt; list(h.ge(3).distribution())</span>
<span class="sd">        [(False, Fraction(1, 4)), (True, Fraction(3, 4))]</span>

<span class="sd">        ```</span>

<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            The *rational_t* argument to this method should be considered experimental</span>
<span class="sd">            and may change or disappear in future versions.</span>

<span class="sd">        If provided, *rational_t* must be a callable that takes two ``#!python int``s (a</span>
<span class="sd">        numerator and denominator) and returns an instance of a desired (but otherwise</span>
<span class="sd">        arbitrary) type.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; list(h.distribution(rational_t=lambda n, d: f&quot;{n}/{d}&quot;))</span>
<span class="sd">        [(1, &#39;1/8&#39;), (2, &#39;1/8&#39;), (3, &#39;2/8&#39;), (4, &#39;2/8&#39;), (5, &#39;1/8&#39;), (6, &#39;1/8&#39;)]</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import sympy</span>
<span class="sd">        &gt;&gt;&gt; list(h.distribution(rational_t=sympy.Rational))</span>
<span class="sd">        [(1, 1/8), (2, 1/8), (3, 1/4), (4, 1/4), (5, 1/8), (6, 1/8)]</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import sage.rings.rational  # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; list(h.distribution(rational_t=lambda n, d: sage.rings.rational.Rational((n, d))))  # doctest: +SKIP</span>
<span class="sd">        [(1, 1/8), (2, 1/8), (3, 1/4), (4, 1/4), (5, 1/8), (6, 1/8)]</span>

<span class="sd">        ```</span>

<span class="sd">        !!! note</span>

<span class="sd">            The arguments passed to *rational_t* are not reduced to the lowest terms.</span>

<span class="sd">        The *rational_t* argument is a convenience. Iteration or comprehension can be</span>
<span class="sd">        used to accomplish something similar.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; [(outcome, f&quot;{probability.numerator}/{probability.denominator}&quot;) for outcome, probability in (h).distribution()]</span>
<span class="sd">        [(1, &#39;1/8&#39;), (2, &#39;1/8&#39;), (3, &#39;1/4&#39;), (4, &#39;1/4&#39;), (5, &#39;1/8&#39;), (6, &#39;1/8&#39;)]</span>

<span class="sd">        ```</span>

<span class="sd">        Many number implementations can convert directly from ``#!python</span>
<span class="sd">        fractions.Fraction``s.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import sympy.abc</span>
<span class="sd">        &gt;&gt;&gt; [(outcome, sympy.Rational(probability)) for outcome, probability in (h + sympy.abc.x).distribution()]</span>
<span class="sd">        [(x + 1, 1/8), (x + 2, 1/8), (x + 3, 1/4), (x + 4, 1/4), (x + 5, 1/8), (x + 6, 1/8)]</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import sage.rings.rational  # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; [(outcome, sage.rings.rational.Rational(probability)) for outcome, probability in h.distribution()]  # doctest: +SKIP</span>
<span class="sd">        [(1, 1/6), (2, 1/6), (3, 1/3), (4, 1/3), (5, 1/6), (6, 1/6)]</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">rational_t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># TODO(posita): See &lt;https://github.com/python/mypy/issues/10854#issuecomment-1663057450&gt;</span>
            <span class="n">rational_t</span> <span class="o">=</span> <span class="n">Fraction</span>  <span class="c1"># type: ignore [assignment]</span>
            <span class="k">assert</span> <span class="n">rational_t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

        <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="ow">or</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">rational_t</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">outcome</span><span class="p">],</span> <span class="n">total</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">sorted_outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">distribution_xy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Presentation helper function returning an iterator for a “zipped” arrangement of the</span>
<span class="sd">        output from the [``distribution`` method][dyce.h.H.distribution] and ensures the</span>
<span class="sd">        values are ``#!python float``s.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; list(H(6).distribution())</span>
<span class="sd">        [(1, Fraction(1, 6)), (2, Fraction(1, 6)), (3, Fraction(1, 6)), (4, Fraction(1, 6)), (5, Fraction(1, 6)), (6, Fraction(1, 6))]</span>
<span class="sd">        &gt;&gt;&gt; H(6).distribution_xy()</span>
<span class="sd">        ((1, 2, 3, 4, 5, 6), (0.16666666, 0.16666666, 0.16666666, 0.16666666, 0.16666666, 0.16666666))</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO(posita): See &lt;https://github.com/python/typing/issues/193&gt;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>  <span class="c1"># type: ignore [return-value]</span>
            <span class="nb">zip</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span>
                    <span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">format</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">width</span><span class="p">:</span> <span class="n">SupportsInt</span> <span class="o">=</span> <span class="n">_ROW_WIDTH</span><span class="p">,</span>
        <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tick</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span>
        <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a formatted string representation of the histogram. If *width* is</span>
<span class="sd">        greater than zero, a horizontal bar ASCII graph is printed using *tick* and</span>
<span class="sd">        *sep* (which are otherwise ignored if *width* is zero or less).</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; print(H(6).format(width=0))</span>
<span class="sd">        {avg: 3.50, 1: 16.67%, 2: 16.67%, 3: 16.67%, 4: 16.67%, 5: 16.67%, 6: 16.67%}</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; print((2@H(6)).zero_fill(range(1, 21)).format(tick=&quot;@&quot;))</span>
<span class="sd">        avg |    7.00</span>
<span class="sd">        std |    2.42</span>
<span class="sd">        var |    5.83</span>
<span class="sd">          1 |   0.00% |</span>
<span class="sd">          2 |   2.78% |@</span>
<span class="sd">          3 |   5.56% |@@</span>
<span class="sd">          4 |   8.33% |@@@@</span>
<span class="sd">          5 |  11.11% |@@@@@</span>
<span class="sd">          6 |  13.89% |@@@@@@</span>
<span class="sd">          7 |  16.67% |@@@@@@@@</span>
<span class="sd">          8 |  13.89% |@@@@@@</span>
<span class="sd">          9 |  11.11% |@@@@@</span>
<span class="sd">         10 |   8.33% |@@@@</span>
<span class="sd">         11 |   5.56% |@@</span>
<span class="sd">         12 |   2.78% |@</span>
<span class="sd">         13 |   0.00% |</span>
<span class="sd">         14 |   0.00% |</span>
<span class="sd">         15 |   0.00% |</span>
<span class="sd">         16 |   0.00% |</span>
<span class="sd">         17 |   0.00% |</span>
<span class="sd">         18 |   0.00% |</span>
<span class="sd">         19 |   0.00% |</span>
<span class="sd">         20 |   0.00% |</span>

<span class="sd">        ```</span>

<span class="sd">        If *scaled* is ``#!python True``, horizontal bars are scaled to *width*.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; h = (2@H(6)).ge(7)</span>
<span class="sd">        &gt;&gt;&gt; print(f&quot;{&#39; 65 chars wide --&gt;|&#39;:-&gt;65}&quot;)</span>
<span class="sd">        ---------------------------------------------- 65 chars wide --&gt;|</span>
<span class="sd">        &gt;&gt;&gt; print(H(1).format(scaled=False))</span>
<span class="sd">        avg |    1.00</span>
<span class="sd">        std |    0.00</span>
<span class="sd">        var |    0.00</span>
<span class="sd">          1 | 100.00% |##################################################</span>
<span class="sd">        &gt;&gt;&gt; print(h.format(scaled=False))</span>
<span class="sd">        avg |    0.58</span>
<span class="sd">        std |    0.49</span>
<span class="sd">        var |    0.24</span>
<span class="sd">          0 |  41.67% |####################</span>
<span class="sd">          1 |  58.33% |#############################</span>
<span class="sd">        &gt;&gt;&gt; print(h.format(scaled=True))</span>
<span class="sd">        avg |    0.58</span>
<span class="sd">        std |    0.49</span>
<span class="sd">        var |    0.24</span>
<span class="sd">          0 |  41.67% |###################################</span>
<span class="sd">          1 |  58.33% |##################################################</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

        <span class="c1"># We convert various values herein to native ints and floats because number</span>
        <span class="c1"># tower implementations sometimes neglect to implement __format__ properly (or</span>
        <span class="c1"># at all). (I&#39;m looking at you, sage.rings.…!)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mu</span><span class="p">:</span> <span class="n">RealLike</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">_parts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;avg: </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>

                <span class="k">for</span> <span class="p">(</span>
                    <span class="n">outcome</span><span class="p">,</span>
                    <span class="n">probability</span><span class="p">,</span>
                <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">():</span>
                    <span class="n">probability_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">probability_f</span><span class="si">:</span><span class="s2">7.2%</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">return</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_parts</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">w</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">15</span>

            <span class="k">def</span> <span class="nf">_lines</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;avg | </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
                    <span class="n">var</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
                    <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;std | </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;var | </span><span class="si">{</span><span class="n">var</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="s2">; mu: </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
                    <span class="n">outcomes</span><span class="p">,</span> <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution_xy</span><span class="p">()</span>
                    <span class="n">tick_scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span> <span class="k">if</span> <span class="n">scaled</span> <span class="k">else</span> <span class="mf">1.0</span>

                    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">):</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">outcome_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome</span><span class="si">:</span><span class="s2"> 3</span><span class="si">}</span><span class="s2">&quot;</span>
                        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                            <span class="n">outcome_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
                            <span class="n">outcome_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome_str</span><span class="si">:</span><span class="s2"> &gt;3</span><span class="si">}</span><span class="s2">&quot;</span>

                        <span class="n">ticks</span> <span class="o">=</span> <span class="n">tick</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">probability</span> <span class="o">/</span> <span class="n">tick_scale</span><span class="p">)</span>
                        <span class="n">probability_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
                        <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome_str</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">probability_f</span><span class="si">:</span><span class="s2">7.2%</span><span class="si">}</span><span class="s2"> |</span><span class="si">{</span><span class="n">ticks</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_lines</span><span class="p">())</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the mean of the weighted outcomes (or 0.0 if there are no outcomes).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">numerator</span><span class="p">:</span> <span class="nb">float</span>
        <span class="n">denominator</span><span class="p">:</span> <span class="nb">float</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">numerator</span> <span class="o">+=</span> <span class="n">outcome</span> <span class="o">*</span> <span class="n">count</span>
            <span class="n">denominator</span> <span class="o">+=</span> <span class="n">count</span>

        <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">denominator</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">stdev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python math.sqrt(self.variance(mu))``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the variance of the weighted outcomes. If provided, *mu* is used as the mean</span>
<span class="sd">        (to avoid duplicate computation).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span> <span class="k">if</span> <span class="n">mu</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">numerator</span><span class="p">:</span> <span class="nb">float</span>
        <span class="n">denominator</span><span class="p">:</span> <span class="nb">float</span>
        <span class="n">numerator</span> <span class="o">=</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">numerator</span> <span class="o">+=</span> <span class="n">outcome</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">count</span>
            <span class="n">denominator</span> <span class="o">+=</span> <span class="n">count</span>

        <span class="c1"># While floating point overflow is impossible to eliminate, we avoid it under</span>
        <span class="c1"># some circumstances by exploiting the equivalence of E[(X - E[X])**2] and the</span>
        <span class="c1"># more efficient E[X**2] - E[X]**2. See</span>
        <span class="c1"># &lt;https://dlsun.github.io/probability/variance.html&gt;.</span>
        <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">denominator</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="o">**</span><span class="mi">2</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a (weighted) random outcome.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">rng</span><span class="o">.</span><span class="n">RNG</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span>
                <span class="n">population</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()),</span>
                <span class="n">weights</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">()),</span>
                <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span>
            <span class="k">else</span> <span class="mi">0</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_order_stat_func_for_n</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="s2">&quot;H&quot;</span><span class="p">]:</span>
        <span class="n">betas_by_outcome</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">H</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">():</span>
            <span class="n">betas_by_outcome</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">n</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span>
                <span class="n">n</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span>
            <span class="p">)</span>

        <span class="k">def</span> <span class="nf">_gen_h_items_at_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_OutcomeCountT</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="p">(</span><span class="n">h_le</span><span class="p">,</span> <span class="n">h_lt</span><span class="p">)</span> <span class="ow">in</span> <span class="n">betas_by_outcome</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">yield</span> <span class="p">(</span>
                    <span class="n">outcome</span><span class="p">,</span>
                    <span class="n">h_le</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">h_lt</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
                <span class="p">)</span>

        <span class="nd">@beartype</span>
        <span class="k">def</span> <span class="nf">order_stat_for_n_at_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">_gen_h_items_at_pos</span><span class="p">(</span><span class="n">pos</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">order_stat_for_n_at_pos</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="dyce.h.H.__slots__" class="doc doc-heading">
<code class="highlight language-python"><span class="vm">__slots__</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_h&#39;</span><span class="p">,</span> <span class="s1">&#39;_hash&#39;</span><span class="p">,</span> <span class="s1">&#39;_lowest_terms&#39;</span><span class="p">,</span> <span class="s1">&#39;_order_stat_funcs_by_n&#39;</span><span class="p">,</span> <span class="s1">&#39;_total&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="dyce.h.H.total" class="doc doc-heading">
<code class="highlight language-python"><span class="n">total</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This property should be considered experimental and may change or disappear
in future versions.</p>
</div>
<p>Equivalent to <code class="highlight"><span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span></code>.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__abs__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__abs__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__abs__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__add__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__add__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__add__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__and__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__and__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">HableT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
<span class="k">def</span> <span class="fm">__and__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;HableT&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__and__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__bool__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__bool__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__contains__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__contains__</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># type: ignore [override]</span>
    <span class="k">return</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
        <span class="k">return</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
        <span class="k">return</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span><span class="o">.</span><span class="n">_h</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__floordiv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__floordiv__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__floordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__floordiv__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__hash__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__hash__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span> <span class="o">=</span> <span class="nb">hash</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">items</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializer.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">items</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">:</span> <span class="n">_MappingT</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">_h</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">items</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">simple_init</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="n">outcome_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span>
                <span class="n">simple_init</span> <span class="k">if</span> <span class="n">simple_init</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span><span class="p">,</span>
                <span class="mi">0</span> <span class="k">if</span> <span class="n">simple_init</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="n">simple_init</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># if isinstance(items, RealLike):</span>
            <span class="c1">#     outcome_type = type(items)</span>
            <span class="c1">#     self._h = {outcome_type(i): 1 for i in outcome_range}</span>
            <span class="c1"># else:</span>
            <span class="c1">#     self._h = {i: 1 for i in outcome_range}</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">)</span>
            <span class="n">outcome_type</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="p">{</span><span class="n">outcome_type</span><span class="p">(</span><span class="n">i</span><span class="p">):</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">outcome_range</span><span class="p">}</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">h</span><span class="p">()</span><span class="o">.</span><span class="n">_h</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">IterableC</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">):</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>

        <span class="c1"># items is either an Iterable[RealLike] or an Iterable[tuple[RealLike,</span>
        <span class="c1"># SupportsInt]] (although this technically supports Iterable[RealLike |</span>
        <span class="c1"># tuple[RealLike, SupportsInt]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_h</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">sorted_items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">sorted_items</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="n">sorted_items</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">natural_key</span><span class="p">)</span>

        <span class="c1"># As of Python 3.7, insertion order of keys is preserved</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sorted_items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
                <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">count</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">outcome</span> <span class="o">=</span> <span class="n">item</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;count for </span><span class="si">{</span><span class="n">outcome</span><span class="si">}</span><span class="s2"> cannot be negative&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unrecognized initializer type </span><span class="si">{</span><span class="n">items</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># We can&#39;t use something like functools.lru_cache for these values because those</span>
    <span class="c1"># mechanisms call this object&#39;s __hash__ method which relies on both of these</span>
    <span class="c1"># and we don&#39;t want a circular dependency when computing this object&#39;s hash.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_hash</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">H</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># We don&#39;t use functools&#39; caching mechanisms generally because they don&#39;t</span>
    <span class="c1"># present a good mechanism for scoping the cache to object instances such that</span>
    <span class="c1"># the cache will be purged when the object is deleted. functools.cached_property</span>
    <span class="c1"># is an exception, but it requires that objects have proper __dict__ values,</span>
    <span class="c1"># which Hs do not. So we basically do what functools.cached_property does, but</span>
    <span class="c1"># without a __dict__.</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">],</span> <span class="n">H</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__invert__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__invert__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__invert__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__invert__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__len__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__matmul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__matmul__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">if</span> <span class="n">other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;argument cannot be negative&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sum_h</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__mod__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__mod__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__mod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__mod__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__mul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__mul__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__mul__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__ne__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__ne__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
        <span class="k">return</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__neg__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__neg__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__neg__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__or__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__or__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">HableT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
<span class="k">def</span> <span class="fm">__or__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;HableT&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__or__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__pos__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__pos__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="fm">__pos__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__pow__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__pow__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__pow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__pow__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__radd__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__radd__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rand__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rand__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rand__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="fm">__and__</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">dict</span><span class="o">.</span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__reversed__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__reversed__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__reversed__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rfloordiv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rfloordiv__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rfloordiv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__floordiv__</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rmatmul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rmatmul__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rmatmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__matmul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rmod__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rmod__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rmod__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__mod__</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rmul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rmul__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__mul__</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__ror__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__ror__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__ror__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="fm">__or__</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rpow__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rpow__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rpow__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__pow__</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rsub__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rsub__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rsub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__sub__</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rtruediv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rtruediv__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rtruediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="fm">__truediv__</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__rxor__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rxor__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rxor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">),</span> <span class="fm">__xor__</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">NotImplementedError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__sub__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__sub__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__sub__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__truediv__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__truediv__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__truediv__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__truediv__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.__xor__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__xor__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">HableT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
<span class="k">def</span> <span class="fm">__xor__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="s2">&quot;HableT&quot;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__xor__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">NotImplementedError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.accumulate" class="doc doc-heading">
<code class="highlight language-python"><span class="n">accumulate</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Accumulates counts.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">accumulate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Accumulates counts.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(4).accumulate(H(6))</span>
<span class="sd">    H({1: 2, 2: 2, 3: 2, 4: 2, 5: 1, 6: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">cast</span><span class="p">(</span><span class="n">_SourceT</span><span class="p">,</span> <span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">other</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.counts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">counts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ValuesView</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>More descriptive synonym for the <a class="autorefs autorefs-internal" href="#dyce.h.H.values"><code>values</code> method</a>.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">counts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValuesView</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    More descriptive synonym for the [``values`` method][dyce.h.H.values].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.distribution" class="doc doc-heading">
<code class="highlight language-python"><span class="n">distribution</span><span class="p">(</span><span class="n">rational_t</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Presentation helper function returning an iterator for each outcome/count or
outcome/probability pair.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">distribution</span><span class="p">())</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">())</span>
<span class="p">[(</span><span class="kc">False</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))]</span>
</code></pre></div></td></tr></table></div>
<div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>The <em>rational_t</em> argument to this method should be considered experimental
and may change or disappear in future versions.</p>
</div>
<p>If provided, <em>rational_t</em> must be a callable that takes two <code class="highlight"><span class="nb">int</span></code>s (a
numerator and denominator) and returns an instance of a desired (but otherwise
arbitrary) type.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">rational_t</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">))</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;2/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;2/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sympy</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">rational_t</span><span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">))</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sage.rings.rational</span>  <span class="c1"># doctest: +SKIP</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">distribution</span><span class="p">(</span><span class="n">rational_t</span><span class="o">=</span><span class="k">lambda</span> <span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">:</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">rational</span><span class="o">.</span><span class="n">Rational</span><span class="p">((</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">))))</span>  <span class="c1"># doctest: +SKIP</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The arguments passed to <em>rational_t</em> are not reduced to the lowest terms.</p>
</div>
<p>The <em>rational_t</em> argument is a convenience. Iteration or comprehension can be
used to accomplish something similar.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">outcome</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">probability</span><span class="o">.</span><span class="n">numerator</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">probability</span><span class="o">.</span><span class="n">denominator</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">()]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;1/4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;1/4&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;1/8&#39;</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<p>Many number implementations can convert directly from <code class="highlight"><span class="n">fractions</span><span class="o">.</span><span class="n">Fraction</span></code>s.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sympy.abc</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="n">probability</span><span class="p">))</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="p">(</span><span class="n">h</span> <span class="o">+</span> <span class="n">sympy</span><span class="o">.</span><span class="n">abc</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">()]</span>
<span class="p">[(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">8</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">sage.rings.rational</span>  <span class="c1"># doctest: +SKIP</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">[(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">sage</span><span class="o">.</span><span class="n">rings</span><span class="o">.</span><span class="n">rational</span><span class="o">.</span><span class="n">Rational</span><span class="p">(</span><span class="n">probability</span><span class="p">))</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="n">h</span><span class="o">.</span><span class="n">distribution</span><span class="p">()]</span>  <span class="c1"># doctest: +SKIP</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@experimental</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">distribution</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">rational_t</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">[[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">_T</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">_T</span><span class="p">]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Presentation helper function returning an iterator for each outcome/count or</span>
<span class="sd">    outcome/probability pair.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; h = H((1, 2, 3, 3, 4, 4, 5, 6))</span>
<span class="sd">    &gt;&gt;&gt; list(h.distribution())</span>
<span class="sd">    [(1, Fraction(1, 8)), (2, Fraction(1, 8)), (3, Fraction(1, 4)), (4, Fraction(1, 4)), (5, Fraction(1, 8)), (6, Fraction(1, 8))]</span>
<span class="sd">    &gt;&gt;&gt; list(h.ge(3).distribution())</span>
<span class="sd">    [(False, Fraction(1, 4)), (True, Fraction(3, 4))]</span>

<span class="sd">    ```</span>

<span class="sd">    !!! warning &quot;Experimental&quot;</span>

<span class="sd">        The *rational_t* argument to this method should be considered experimental</span>
<span class="sd">        and may change or disappear in future versions.</span>

<span class="sd">    If provided, *rational_t* must be a callable that takes two ``#!python int``s (a</span>
<span class="sd">    numerator and denominator) and returns an instance of a desired (but otherwise</span>
<span class="sd">    arbitrary) type.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; list(h.distribution(rational_t=lambda n, d: f&quot;{n}/{d}&quot;))</span>
<span class="sd">    [(1, &#39;1/8&#39;), (2, &#39;1/8&#39;), (3, &#39;2/8&#39;), (4, &#39;2/8&#39;), (5, &#39;1/8&#39;), (6, &#39;1/8&#39;)]</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import sympy</span>
<span class="sd">    &gt;&gt;&gt; list(h.distribution(rational_t=sympy.Rational))</span>
<span class="sd">    [(1, 1/8), (2, 1/8), (3, 1/4), (4, 1/4), (5, 1/8), (6, 1/8)]</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import sage.rings.rational  # doctest: +SKIP</span>
<span class="sd">    &gt;&gt;&gt; list(h.distribution(rational_t=lambda n, d: sage.rings.rational.Rational((n, d))))  # doctest: +SKIP</span>
<span class="sd">    [(1, 1/8), (2, 1/8), (3, 1/4), (4, 1/4), (5, 1/8), (6, 1/8)]</span>

<span class="sd">    ```</span>

<span class="sd">    !!! note</span>

<span class="sd">        The arguments passed to *rational_t* are not reduced to the lowest terms.</span>

<span class="sd">    The *rational_t* argument is a convenience. Iteration or comprehension can be</span>
<span class="sd">    used to accomplish something similar.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; [(outcome, f&quot;{probability.numerator}/{probability.denominator}&quot;) for outcome, probability in (h).distribution()]</span>
<span class="sd">    [(1, &#39;1/8&#39;), (2, &#39;1/8&#39;), (3, &#39;1/4&#39;), (4, &#39;1/4&#39;), (5, &#39;1/8&#39;), (6, &#39;1/8&#39;)]</span>

<span class="sd">    ```</span>

<span class="sd">    Many number implementations can convert directly from ``#!python</span>
<span class="sd">    fractions.Fraction``s.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import sympy.abc</span>
<span class="sd">    &gt;&gt;&gt; [(outcome, sympy.Rational(probability)) for outcome, probability in (h + sympy.abc.x).distribution()]</span>
<span class="sd">    [(x + 1, 1/8), (x + 2, 1/8), (x + 3, 1/4), (x + 4, 1/4), (x + 5, 1/8), (x + 6, 1/8)]</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import sage.rings.rational  # doctest: +SKIP</span>
<span class="sd">    &gt;&gt;&gt; [(outcome, sage.rings.rational.Rational(probability)) for outcome, probability in h.distribution()]  # doctest: +SKIP</span>
<span class="sd">    [(1, 1/6), (2, 1/6), (3, 1/3), (4, 1/3), (5, 1/6), (6, 1/6)]</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">rational_t</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># TODO(posita): See &lt;https://github.com/python/mypy/issues/10854#issuecomment-1663057450&gt;</span>
        <span class="n">rational_t</span> <span class="o">=</span> <span class="n">Fraction</span>  <span class="c1"># type: ignore [assignment]</span>
        <span class="k">assert</span> <span class="n">rational_t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

    <span class="n">total</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="ow">or</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">rational_t</span><span class="p">(</span><span class="bp">self</span><span class="p">[</span><span class="n">outcome</span><span class="p">],</span> <span class="n">total</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">sorted_outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.distribution_xy" class="doc doc-heading">
<code class="highlight language-python"><span class="n">distribution_xy</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Presentation helper function returning an iterator for a “zipped” arrangement of the
output from the <a class="autorefs autorefs-internal" href="#dyce.h.H.distribution"><code>distribution</code> method</a> and ensures the
values are <code class="highlight"><span class="nb">float</span></code>s.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">list</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">distribution</span><span class="p">())</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)),</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">))]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">distribution_xy</span><span class="p">()</span>
<span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">,</span> <span class="mf">0.16666666</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">distribution_xy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Presentation helper function returning an iterator for a “zipped” arrangement of the</span>
<span class="sd">    output from the [``distribution`` method][dyce.h.H.distribution] and ensures the</span>
<span class="sd">    values are ``#!python float``s.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; list(H(6).distribution())</span>
<span class="sd">    [(1, Fraction(1, 6)), (2, Fraction(1, 6)), (3, Fraction(1, 6)), (4, Fraction(1, 6)), (5, Fraction(1, 6)), (6, Fraction(1, 6))]</span>
<span class="sd">    &gt;&gt;&gt; H(6).distribution_xy()</span>
<span class="sd">    ((1, 2, 3, 4, 5, 6), (0.16666666, 0.16666666, 0.16666666, 0.16666666, 0.16666666, 0.16666666))</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO(posita): See &lt;https://github.com/python/typing/issues/193&gt;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>  <span class="c1"># type: ignore [return-value]</span>
        <span class="nb">zip</span><span class="p">(</span>
            <span class="o">*</span><span class="p">(</span>
                <span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.draw" class="doc doc-heading">
<code class="highlight language-python"><span class="n">draw</span><span class="p">(</span><span class="n">outcomes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">RealLike</span><span class="p">],</span> <span class="n">_MappingT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This property should be considered experimental and may change or disappear
in future versions.</p>
</div>
<p>Returns a new <a class="autorefs autorefs-internal" href="#dyce.h.H"><code>H</code> object</a> where the counts associated with
<em>outcomes</em> has been updated. This may be useful for using histograms to model
decks of cards (rather than dice). If <em>outcome</em> is <code class="highlight"><span class="kc">None</span></code>, this is
equivalent to <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roll</span><span class="p">())</span></code>.</p>
<p>If <em>outcomes</em> is a single value, that value’s count is decremented by one. If
<em>outcomes</em> is an iterable of values, those values’ outcomes are decremented by
one for each time that outcome appears. If <em>outcomes</em> is a mapping of outcomes
to counts, those outcomes are decremented by the respective counts.</p>
<p>Counts are not reduced and zero counts are preserved. To reduce, call the
<a class="autorefs autorefs-internal" href="#dyce.h.H.lowest_terms"><code>lowest_terms</code> method</a>.</p>
<!-- BEGIN MONKEY PATCH --
For deterministic outcomes.

>>> import random
>>> from dyce import rng
>>> rng.RNG = random.Random(1691413956)

  -- END MONKEY PATCH -->

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">accumulate</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="p">;</span> <span class="n">h</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span><span class="o">.</span><span class="n">draw</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="admonition tip">
<p class="admonition-title">Negative counts can be used to increase counts</p>
<p>Where <em>outcomes</em> is a mapping of outcomes to counts, negative counts can be
used to <em>increase</em> or “add” outcomes’ counts.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">({</span><span class="mi">5</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">})</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
</div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">draw</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">outcomes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">RealLike</span><span class="p">],</span> <span class="n">_MappingT</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Experimental&quot;</span>

<span class="sd">        This property should be considered experimental and may change or disappear</span>
<span class="sd">        in future versions.</span>

<span class="sd">    Returns a new [``H`` object][dyce.h.H] where the counts associated with</span>
<span class="sd">    *outcomes* has been updated. This may be useful for using histograms to model</span>
<span class="sd">    decks of cards (rather than dice). If *outcome* is ``#!python None``, this is</span>
<span class="sd">    equivalent to ``#!python self.draw(self.roll())``.</span>

<span class="sd">    If *outcomes* is a single value, that value’s count is decremented by one. If</span>
<span class="sd">    *outcomes* is an iterable of values, those values’ outcomes are decremented by</span>
<span class="sd">    one for each time that outcome appears. If *outcomes* is a mapping of outcomes</span>
<span class="sd">    to counts, those outcomes are decremented by the respective counts.</span>

<span class="sd">    Counts are not reduced and zero counts are preserved. To reduce, call the</span>
<span class="sd">    [``lowest_terms`` method][dyce.h.H.lowest_terms].</span>

<span class="sd">    &lt;!-- BEGIN MONKEY PATCH --</span>
<span class="sd">    For deterministic outcomes.</span>

<span class="sd">    &gt;&gt;&gt; import random</span>
<span class="sd">    &gt;&gt;&gt; from dyce import rng</span>
<span class="sd">    &gt;&gt;&gt; rng.RNG = random.Random(1691413956)</span>

<span class="sd">      -- END MONKEY PATCH --&gt;</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).draw()</span>
<span class="sd">    H({1: 1, 2: 1, 3: 1, 4: 0, 5: 1, 6: 1})</span>

<span class="sd">    &gt;&gt;&gt; H(6).draw(2)</span>
<span class="sd">    H({1: 1, 2: 0, 3: 1, 4: 1, 5: 1, 6: 1})</span>

<span class="sd">    &gt;&gt;&gt; H(6).draw((2, 3, 4, 5)).lowest_terms()</span>
<span class="sd">    H({1: 1, 6: 1})</span>

<span class="sd">    &gt;&gt;&gt; h = H(6).accumulate(H(4)) ; h</span>
<span class="sd">    H({1: 2, 2: 2, 3: 2, 4: 2, 5: 1, 6: 1})</span>
<span class="sd">    &gt;&gt;&gt; h.draw({1: 2, 4: 1, 6: 1})</span>
<span class="sd">    H({1: 0, 2: 2, 3: 2, 4: 1, 5: 1, 6: 0})</span>

<span class="sd">    ```</span>

<span class="sd">    !!! tip &quot;Negative counts can be used to increase counts&quot;</span>

<span class="sd">        Where *outcomes* is a mapping of outcomes to counts, negative counts can be</span>
<span class="sd">        used to *increase* or “add” outcomes’ counts.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; H(4).draw({5: -1})</span>
<span class="sd">        H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1})</span>

<span class="sd">        ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">outcomes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">roll</span><span class="p">())</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">):</span>
        <span class="n">outcomes</span> <span class="o">=</span> <span class="p">(</span><span class="n">outcomes</span><span class="p">,)</span>

    <span class="n">to_draw_outcome_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">outcomes</span><span class="p">)</span>
    <span class="n">self_outcome_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># This approach is necessary because Counter.__sub__ does not preserve negative</span>
    <span class="c1"># counts and Counter.subtract modifies the counter in-place</span>
    <span class="n">new_outcome_counts</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">self_outcome_counts</span><span class="p">)</span>
    <span class="n">new_outcome_counts</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">to_draw_outcome_counts</span><span class="p">)</span>
    <span class="n">would_go_negative</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="o">+</span><span class="n">to_draw_outcome_counts</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="o">+</span><span class="n">self_outcome_counts</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">would_go_negative</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;outcomes to be drawn </span><span class="si">{</span><span class="n">would_go_negative</span><span class="si">}</span><span class="s2"> not in </span><span class="si">{</span><span class="bp">self</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">zeros</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">self_outcome_counts</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">new_outcome_counts</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">zeros</span><span class="p">:</span>
        <span class="n">new_outcome_counts</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">new_outcome_counts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.eq" class="doc doc-heading">
<code class="highlight language-python"><span class="n">eq</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code></a> and <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code></a> methods.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">eq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python self.map(operator.__eq__, other).umap(bool)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).eq(3)</span>
<span class="sd">    H({False: 5, True: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__eq__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.exactly_k_times_in_n" class="doc doc-heading">
<code class="highlight language-python"><span class="n">exactly_k_times_in_n</span><span class="p">(</span><span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This method should be considered experimental and may change or disappear in
future versions.</p>
</div>
<p>Computes (in constant time) and returns the number of times <em>outcome</em> appears
exactly <em>k</em> times among <code class="highlight"><span class="n">n</span><span class="nd">@self</span></code>. This is a more efficient
alternative to <code class="highlight"><span class="p">(</span><span class="n">n</span><span class="o">@</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">outcome</span><span class="p">)))[</span><span class="n">k</span><span class="p">]</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">exactly_k_times_in_n</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="mi">150</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">exactly_k_times_in_n</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">exactly_k_times_in_n</span><span class="p">(</span><span class="n">outcome</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">8</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@experimental</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">exactly_k_times_in_n</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span>
    <span class="n">n</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span>
    <span class="n">k</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Experimental&quot;</span>

<span class="sd">        This method should be considered experimental and may change or disappear in</span>
<span class="sd">        future versions.</span>

<span class="sd">    Computes (in constant time) and returns the number of times *outcome* appears</span>
<span class="sd">    exactly *k* times among ``#!python n@self``. This is a more efficient</span>
<span class="sd">    alternative to ``#!python (n@(self.eq(outcome)))[k]``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).exactly_k_times_in_n(outcome=5, n=4, k=2)</span>
<span class="sd">    150</span>
<span class="sd">    &gt;&gt;&gt; H((2, 3, 3, 4, 4, 5)).exactly_k_times_in_n(outcome=2, n=3, k=3)</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; H((2, 3, 3, 4, 4, 5)).exactly_k_times_in_n(outcome=4, n=3, k=3)</span>
<span class="sd">    8</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">k</span> <span class="o">&lt;=</span> <span class="n">n</span>
    <span class="n">c_outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">comb</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="n">c_outcome</span><span class="o">**</span><span class="n">k</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">total</span> <span class="o">-</span> <span class="n">c_outcome</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.explode" class="doc doc-heading">
<code class="highlight language-python"><span class="n">explode</span><span class="p">(</span><span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IntegralLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>This method has been deprecated and will be removed in a future release. See
the <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.explode"><code>explode</code> function</a> for a more flexible
alternative.</p>
</div>
<p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="k">lambda</span> <span class="n">h</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">outcome</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="k">else</span> <span class="n">h</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">else</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="fm">__add__</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">,</span><span class="n">precision_limit</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">explode</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>This method guards against excessive recursion by returning <code class="highlight"><span class="n">outcome</span></code>
if the passed histogram has only one face. See the <span data-autorefs-identifier="dyce.h.H.substitute"><code>substitute</code>
method</span>.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">explode</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IntegralLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Deprecated&quot;</span>

<span class="sd">        This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">        the [``explode`` function][dyce.evaluation.explode] for a more flexible</span>
<span class="sd">        alternative.</span>

<span class="sd">    Shorthand for ``#!python self.substitute(lambda h, outcome: outcome if len(h) == 1</span>
<span class="sd">    else h if outcome == max(h) else outcome, operator.__add__, max_depth,</span>
<span class="sd">    precision_limit)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).explode(max_depth=2)</span>
<span class="sd">    H({1: 36, 2: 36, 3: 36, 4: 36, 5: 36, 7: 6, 8: 6, 9: 6, 10: 6, 11: 6, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    This method guards against excessive recursion by returning ``#!python outcome``</span>
<span class="sd">    if the passed histogram has only one face. See the [``substitute``</span>
<span class="sd">    method][dyce.h.H.substitute].</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">_explode</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HOrOutcomeT</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">outcome</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">h</span> <span class="k">if</span> <span class="n">outcome</span> <span class="o">==</span> <span class="nb">max</span><span class="p">(</span><span class="n">h</span><span class="p">)</span> <span class="k">else</span> <span class="n">outcome</span>

    <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;only one of max_depth and precision_limit is allowed&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">_explode</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">_explode</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">,</span> <span class="n">precision_limit</span><span class="o">=</span><span class="n">precision_limit</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">substitute</span><span class="p">(</span><span class="n">_explode</span><span class="p">,</span> <span class="fm">__add__</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.foreach" class="doc doc-heading">
<code class="highlight language-python"><span class="n">foreach</span><span class="p">(</span><span class="n">dependent_term</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">HOrOutcomeT</span><span class="p">],</span> <span class="o">**</span><span class="n">independent_sources</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>This method has been deprecated and will be removed in a future release. See
the <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.expandable"><code>expandable</code> decorator</a> and
<a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.foreach"><code>foreach</code> function</a> for more flexible
alternatives.</p>
</div>
<p>Calls <code class="highlight"><span class="n">dependent_term</span></code> for each set of outcomes from the product of
<code>independent_sources</code> and accumulates the results. This is useful for
resolving dependent probabilities. Returned histograms are always reduced to
their lowest terms.</p>
<p>For example rolling a d20, re-rolling a <code class="highlight"><span class="mi">1</span></code> if it comes up, and
keeping the result might be expressed as<sup id="dyce.h.H.foreach--fnref:1"><a class="footnote-ref" href="#dyce.h.H.foreach--fn:1">1</a></sup>:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d20</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">reroll_one_dependent_term</span><span class="p">(</span><span class="n">d20_outcome</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">if</span> <span class="n">d20_outcome</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">d20</span>
<span class="o">...</span>   <span class="k">else</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="n">d20_outcome</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">reroll_one_dependent_term</span><span class="p">,</span> <span class="n">d20_outcome</span><span class="o">=</span><span class="n">d20</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="mi">21</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>The <code class="highlight"><span class="n">foreach</span></code> class method merely wraps <em>dependent_term</em> and calls
<a class="autorefs autorefs-internal" href="#dyce.p.P.foreach"><code>P.foreach</code></a>. In doing so, it imposes a very modest
overhead that is negligible in most cases.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">dependent_term_p</span><span class="p">,</span> <span class="n">roll_1</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">roll_2</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">roll_3</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">roll_n</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="mi">101</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">223</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="n">H</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">dependent_term_h</span><span class="p">,</span> <span class="n">outcome_1</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">outcome_2</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">outcome_3</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">outcome_n</span><span class="o">=</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="mi">107</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">173</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<details>
<summary>Source: <a href="https://github.com/posita/dyce/blob/latest/docs/assets/perf_foreach.ipy"><code>perf_foreach.ipy</code></a></summary>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">P</span>

<span class="k">def</span> <span class="nf">dependent_term</span><span class="p">(</span>
  <span class="n">val_1</span><span class="p">,</span>
  <span class="n">val_2</span><span class="p">,</span>
  <span class="n">val_3</span><span class="p">,</span>
  <span class="n">val_n</span><span class="p">,</span>
<span class="p">):</span>
  <span class="kn">import</span> <span class="nn">math</span> <span class="p">;</span> <span class="n">math</span><span class="o">.</span><span class="n">gcd</span><span class="p">(</span><span class="mi">456</span><span class="o">**</span><span class="mi">123</span><span class="p">,</span> <span class="mi">123</span><span class="o">**</span><span class="mi">456</span><span class="p">)</span>  <span class="c1"># emulate an expensive calculation</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">val_1</span> <span class="o">==</span> <span class="n">val_2</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">val_2</span> <span class="o">==</span> <span class="n">val_3</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span><span class="n">val_1</span> <span class="o">==</span> <span class="n">val_3</span><span class="p">)</span> <span class="o">+</span>
    <span class="p">(</span>
      <span class="n">val_n</span> <span class="o">&gt;</span> <span class="n">val_1</span>
      <span class="ow">and</span> <span class="n">val_n</span> <span class="o">&gt;</span> <span class="n">val_2</span>
      <span class="ow">and</span> <span class="n">val_n</span> <span class="o">&gt;</span> <span class="n">val_3</span>
    <span class="p">)</span>
  <span class="p">)</span>

<span class="k">def</span> <span class="nf">dependent_term_h</span><span class="p">(</span>
  <span class="n">outcome_1</span><span class="p">,</span>
  <span class="n">outcome_2</span><span class="p">,</span>
  <span class="n">outcome_3</span><span class="p">,</span>
  <span class="n">outcome_n</span><span class="p">,</span>
<span class="p">):</span>
  <span class="k">return</span> <span class="n">dependent_term</span><span class="p">(</span><span class="n">outcome_1</span><span class="p">,</span> <span class="n">outcome_2</span><span class="p">,</span> <span class="n">outcome_3</span><span class="p">,</span> <span class="n">outcome_n</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">dependent_term_p</span><span class="p">(</span>
  <span class="n">roll_1</span><span class="p">,</span>
  <span class="n">roll_2</span><span class="p">,</span>
  <span class="n">roll_3</span><span class="p">,</span>
  <span class="n">roll_n</span><span class="p">,</span>
<span class="p">):</span>
  <span class="k">return</span> <span class="n">dependent_term</span><span class="p">(</span><span class="n">roll_1</span><span class="p">,</span> <span class="n">roll_2</span><span class="p">,</span> <span class="n">roll_3</span><span class="p">,</span> <span class="n">roll_n</span><span class="p">)</span>

<span class="n">source_1</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">source_2</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">source_3</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">source_n</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit P.foreach(</span><span class="si">{</span><span class="n">dependent_term_p</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, roll_1=</span><span class="si">{</span><span class="n">source_1</span><span class="si">}</span><span class="s2">, roll_2=</span><span class="si">{</span><span class="n">source_2</span><span class="si">}</span><span class="s2">, roll_3=</span><span class="si">{</span><span class="n">source_3</span><span class="si">}</span><span class="s2">, roll_n=</span><span class="si">{</span><span class="n">source_n</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">dependent_term_p</span><span class="p">,</span> <span class="n">roll_1</span><span class="o">=</span><span class="n">source_1</span><span class="p">,</span> <span class="n">roll_2</span><span class="o">=</span><span class="n">source_2</span><span class="p">,</span> <span class="n">roll_3</span><span class="o">=</span><span class="n">source_3</span><span class="p">,</span> <span class="n">roll_n</span><span class="o">=</span><span class="n">source_n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit H.foreach(</span><span class="si">{</span><span class="n">dependent_term_h</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, outcome_1=</span><span class="si">{</span><span class="n">source_1</span><span class="si">}</span><span class="s2">, outcome_2=</span><span class="si">{</span><span class="n">source_2</span><span class="si">}</span><span class="s2">, outcome_3=</span><span class="si">{</span><span class="n">source_3</span><span class="si">}</span><span class="s2">, outcome_n=</span><span class="si">{</span><span class="n">source_n</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">H</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">dependent_term_h</span><span class="p">,</span> <span class="n">outcome_1</span><span class="o">=</span><span class="n">source_1</span><span class="p">,</span> <span class="n">outcome_2</span><span class="o">=</span><span class="n">source_2</span><span class="p">,</span> <span class="n">outcome_3</span><span class="o">=</span><span class="n">source_3</span><span class="p">,</span> <span class="n">outcome_n</span><span class="o">=</span><span class="n">source_n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>

<div class="footnote">
<hr />
<ol>
<li id="dyce.h.H.foreach--fn:1">
<p>This is primarily for illustration. <a class="autorefs autorefs-internal" href="#dyce.h.H.substitute"><code>H.substitute</code></a>
is often better suited to cases involving re-rolling a single independent
term such as this one.&#160;<a class="footnote-backref" href="#dyce.h.H.foreach--fnref:1" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@deprecated</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">foreach</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">dependent_term</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">HOrOutcomeT</span><span class="p">],</span>
    <span class="o">**</span><span class="n">independent_sources</span><span class="p">:</span> <span class="n">_SourceT</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Deprecated&quot;</span>

<span class="sd">        This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">        the [``expandable`` decorator][dyce.evaluation.expandable] and</span>
<span class="sd">        [``foreach`` function][dyce.evaluation.foreach] for more flexible</span>
<span class="sd">        alternatives.</span>

<span class="sd">    Calls ``#!python dependent_term`` for each set of outcomes from the product of</span>
<span class="sd">    ``independent_sources`` and accumulates the results. This is useful for</span>
<span class="sd">    resolving dependent probabilities. Returned histograms are always reduced to</span>
<span class="sd">    their lowest terms.</span>

<span class="sd">    For example rolling a d20, re-rolling a ``#!python 1`` if it comes up, and</span>
<span class="sd">    keeping the result might be expressed as[^1]:</span>

<span class="sd">    [^1]:</span>

<span class="sd">        This is primarily for illustration. [``H.substitute``][dyce.h.H.substitute]</span>
<span class="sd">        is often better suited to cases involving re-rolling a single independent</span>
<span class="sd">        term such as this one.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d20 = H(20)</span>

<span class="sd">    &gt;&gt;&gt; def reroll_one_dependent_term(d20_outcome):</span>
<span class="sd">    ...   if d20_outcome == 1:</span>
<span class="sd">    ...     return d20</span>
<span class="sd">    ...   else:</span>
<span class="sd">    ...     return d20_outcome</span>

<span class="sd">    &gt;&gt;&gt; H.foreach(reroll_one_dependent_term, d20_outcome=d20)</span>
<span class="sd">    H({1: 1, 2: 21, 3: 21, ..., 19: 21, 20: 21})</span>

<span class="sd">    ```</span>

<span class="sd">    The ``#!python foreach`` class method merely wraps *dependent_term* and calls</span>
<span class="sd">    [``P.foreach``][dyce.p.P.foreach]. In doing so, it imposes a very modest</span>
<span class="sd">    overhead that is negligible in most cases.</span>

<span class="sd">    ``` python</span>
<span class="sd">    --8&lt;-- &quot;docs/assets/perf_foreach.txt&quot;</span>
<span class="sd">    ```</span>

<span class="sd">    &lt;details&gt;</span>
<span class="sd">    &lt;summary&gt;Source: &lt;a href=&quot;https://github.com/posita/dyce/blob/latest/docs/assets/perf_foreach.ipy&quot;&gt;&lt;code&gt;perf_foreach.ipy&lt;/code&gt;&lt;/a&gt;&lt;/summary&gt;</span>

<span class="sd">    ``` python</span>
<span class="sd">    --8&lt;-- &quot;docs/assets/perf_foreach.ipy&quot;</span>
<span class="sd">    ```</span>
<span class="sd">    &lt;/details&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">P</span>

    <span class="k">def</span> <span class="nf">_dependent_term</span><span class="p">(</span><span class="o">**</span><span class="n">roll_kw</span><span class="p">):</span>
        <span class="n">outcome_kw</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">roll</span> <span class="ow">in</span> <span class="n">roll_kw</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">roll</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">roll</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
            <span class="n">outcome_kw</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">roll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">dependent_term</span><span class="p">(</span><span class="o">**</span><span class="n">outcome_kw</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">P</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span><span class="n">_dependent_term</span><span class="p">,</span> <span class="o">**</span><span class="n">independent_sources</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.format" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">format</span><span class="p">(</span><span class="n">width</span><span class="p">:</span> <span class="n">SupportsInt</span> <span class="o">=</span> <span class="n">_ROW_WIDTH</span><span class="p">,</span> <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">tick</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a formatted string representation of the histogram. If <em>width</em> is
greater than zero, a horizontal bar ASCII graph is printed using <em>tick</em> and
<em>sep</em> (which are otherwise ignored if <em>width</em> is zero or less).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">{</span><span class="n">avg</span><span class="p">:</span> <span class="mf">3.50</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mf">16.67</span><span class="o">%</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">((</span><span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">zero_fill</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tick</span><span class="o">=</span><span class="s2">&quot;@&quot;</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">7.00</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">2.42</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">5.83</span>
  <span class="mi">1</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|@</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|@@</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|@@@@</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|@@@@@</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|@@@@@@</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|@@@@@@@@</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|@@@@@@</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">11.11</span><span class="o">%</span> <span class="o">|@@@@@</span>
 <span class="mi">10</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|@@@@</span>
 <span class="mi">11</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|@@</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|@</span>
 <span class="mi">13</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">14</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">15</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">16</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">17</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">18</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">19</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">20</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
</code></pre></div></td></tr></table></div>
<p>If <em>scaled</em> is <code class="highlight"><span class="kc">True</span></code>, horizontal bars are scaled to <em>width</em>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39; 65 chars wide --&gt;|&#39;</span><span class="si">:</span><span class="s2">-&gt;65</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="o">----------------------------------------------</span> <span class="mi">65</span> <span class="n">chars</span> <span class="n">wide</span> <span class="o">--&gt;|</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scaled</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">1.00</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.00</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.00</span>
  <span class="mi">1</span> <span class="o">|</span> <span class="mf">100.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">##################################################</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scaled</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.58</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.49</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.24</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">#############################</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.58</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.49</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.24</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">###################################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">58.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">##################################################</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">format</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">width</span><span class="p">:</span> <span class="n">SupportsInt</span> <span class="o">=</span> <span class="n">_ROW_WIDTH</span><span class="p">,</span>
    <span class="n">scaled</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">tick</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;#&quot;</span><span class="p">,</span>
    <span class="n">sep</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">linesep</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a formatted string representation of the histogram. If *width* is</span>
<span class="sd">    greater than zero, a horizontal bar ASCII graph is printed using *tick* and</span>
<span class="sd">    *sep* (which are otherwise ignored if *width* is zero or less).</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; print(H(6).format(width=0))</span>
<span class="sd">    {avg: 3.50, 1: 16.67%, 2: 16.67%, 3: 16.67%, 4: 16.67%, 5: 16.67%, 6: 16.67%}</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; print((2@H(6)).zero_fill(range(1, 21)).format(tick=&quot;@&quot;))</span>
<span class="sd">    avg |    7.00</span>
<span class="sd">    std |    2.42</span>
<span class="sd">    var |    5.83</span>
<span class="sd">      1 |   0.00% |</span>
<span class="sd">      2 |   2.78% |@</span>
<span class="sd">      3 |   5.56% |@@</span>
<span class="sd">      4 |   8.33% |@@@@</span>
<span class="sd">      5 |  11.11% |@@@@@</span>
<span class="sd">      6 |  13.89% |@@@@@@</span>
<span class="sd">      7 |  16.67% |@@@@@@@@</span>
<span class="sd">      8 |  13.89% |@@@@@@</span>
<span class="sd">      9 |  11.11% |@@@@@</span>
<span class="sd">     10 |   8.33% |@@@@</span>
<span class="sd">     11 |   5.56% |@@</span>
<span class="sd">     12 |   2.78% |@</span>
<span class="sd">     13 |   0.00% |</span>
<span class="sd">     14 |   0.00% |</span>
<span class="sd">     15 |   0.00% |</span>
<span class="sd">     16 |   0.00% |</span>
<span class="sd">     17 |   0.00% |</span>
<span class="sd">     18 |   0.00% |</span>
<span class="sd">     19 |   0.00% |</span>
<span class="sd">     20 |   0.00% |</span>

<span class="sd">    ```</span>

<span class="sd">    If *scaled* is ``#!python True``, horizontal bars are scaled to *width*.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; h = (2@H(6)).ge(7)</span>
<span class="sd">    &gt;&gt;&gt; print(f&quot;{&#39; 65 chars wide --&gt;|&#39;:-&gt;65}&quot;)</span>
<span class="sd">    ---------------------------------------------- 65 chars wide --&gt;|</span>
<span class="sd">    &gt;&gt;&gt; print(H(1).format(scaled=False))</span>
<span class="sd">    avg |    1.00</span>
<span class="sd">    std |    0.00</span>
<span class="sd">    var |    0.00</span>
<span class="sd">      1 | 100.00% |##################################################</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(scaled=False))</span>
<span class="sd">    avg |    0.58</span>
<span class="sd">    std |    0.49</span>
<span class="sd">    var |    0.24</span>
<span class="sd">      0 |  41.67% |####################</span>
<span class="sd">      1 |  58.33% |#############################</span>
<span class="sd">    &gt;&gt;&gt; print(h.format(scaled=True))</span>
<span class="sd">    avg |    0.58</span>
<span class="sd">    std |    0.49</span>
<span class="sd">    var |    0.24</span>
<span class="sd">      0 |  41.67% |###################################</span>
<span class="sd">      1 |  58.33% |##################################################</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">width</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">width</span><span class="p">)</span>

    <span class="c1"># We convert various values herein to native ints and floats because number</span>
    <span class="c1"># tower implementations sometimes neglect to implement __format__ properly (or</span>
    <span class="c1"># at all). (I&#39;m looking at you, sage.rings.…!)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">mu</span><span class="p">:</span> <span class="n">RealLike</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
        <span class="n">mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">width</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">_parts</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
            <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;avg: </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span>

            <span class="k">for</span> <span class="p">(</span>
                <span class="n">outcome</span><span class="p">,</span>
                <span class="n">probability</span><span class="p">,</span>
            <span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="p">():</span>
                <span class="n">probability_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">probability_f</span><span class="si">:</span><span class="s2">7.2%</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="s2">&quot;{&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_parts</span><span class="p">())</span> <span class="o">+</span> <span class="s2">&quot;}&quot;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="mi">15</span>

        <span class="k">def</span> <span class="nf">_lines</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;avg | </span><span class="si">{</span><span class="n">mu</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="n">std</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stdev</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
                <span class="n">var</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;std | </span><span class="si">{</span><span class="n">std</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;var | </span><span class="si">{</span><span class="n">var</span><span class="si">:</span><span class="s2">7.2f</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">OverflowError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">)</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">str</span><span class="p">(</span><span class="n">exc</span><span class="p">)</span><span class="si">}</span><span class="s2">; mu: </span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
                <span class="n">outcomes</span><span class="p">,</span> <span class="n">probabilities</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distribution_xy</span><span class="p">()</span>
                <span class="n">tick_scale</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">probabilities</span><span class="p">)</span> <span class="k">if</span> <span class="n">scaled</span> <span class="k">else</span> <span class="mf">1.0</span>

                <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">probability</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">outcomes</span><span class="p">,</span> <span class="n">probabilities</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">outcome_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome</span><span class="si">:</span><span class="s2"> 3</span><span class="si">}</span><span class="s2">&quot;</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                        <span class="n">outcome_str</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
                        <span class="n">outcome_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome_str</span><span class="si">:</span><span class="s2"> &gt;3</span><span class="si">}</span><span class="s2">&quot;</span>

                    <span class="n">ticks</span> <span class="o">=</span> <span class="n">tick</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">probability</span> <span class="o">/</span> <span class="n">tick_scale</span><span class="p">)</span>
                    <span class="n">probability_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">probability</span><span class="p">)</span>
                    <span class="k">yield</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outcome_str</span><span class="si">}</span><span class="s2"> | </span><span class="si">{</span><span class="n">probability_f</span><span class="si">:</span><span class="s2">7.2%</span><span class="si">}</span><span class="s2"> |</span><span class="si">{</span><span class="n">ticks</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="k">return</span> <span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_lines</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.ge" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ge</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__ge__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ge</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code></a> and <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code></a> methods.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">ge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python self.map(operator.__ge__, other).umap(bool)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).ge(3)</span>
<span class="sd">    H({False: 2, True: 4})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__ge__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.gt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">gt</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__gt__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code></a> and <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code></a> methods.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">gt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python self.map(operator.__gt__, other).umap(bool)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).gt(3)</span>
<span class="sd">    H({False: 3, True: 3})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__gt__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.is_even" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_even</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Equivalent to <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">dyce</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_even</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">is_even</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code> method</a>.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">is_even</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to ``#!python self.umap(dyce.types.is_even)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).is_even()</span>
<span class="sd">    H({False: 2, True: 4})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``umap`` method][dyce.h.H.umap].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_even</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.is_odd" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_odd</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Equivalent to <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">dyce</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_odd</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">is_odd</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code> method</a>.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">is_odd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equivalent to ``#!python self.umap(dyce.types.is_odd)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H((-4, -2, 0, 1, 2, 3)).is_odd()</span>
<span class="sd">    H({False: 4, True: 2})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``umap`` method][dyce.h.H.umap].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">is_odd</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.items" class="doc doc-heading">
<code class="highlight language-python"><span class="n">items</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ItemsView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">items</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ItemsView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.keys" class="doc doc-heading">
<code class="highlight language-python"><span class="n">keys</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">KeysView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">keys</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KeysView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.le" class="doc doc-heading">
<code class="highlight language-python"><span class="n">le</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__le__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">le</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code></a> and <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code></a> methods.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">le</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python self.map(operator.__le__, other).umap(bool)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).le(3)</span>
<span class="sd">    H({False: 3, True: 3})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__le__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.lowest_terms" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lowest_terms</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Computes and returns a histogram whose nonzero counts share a greatest
common divisor of 1.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">df_obscured</span> <span class="o">=</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">df_obscured</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">lowest_terms</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes and returns a histogram whose nonzero counts share a greatest</span>
<span class="sd">    common divisor of 1.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; df_obscured = H({-2: 0, -1: 2, 0: 2, 1: 2, 2: 0})</span>
<span class="sd">    &gt;&gt;&gt; df_obscured.lowest_terms()</span>
<span class="sd">    H({-1: 1, 0: 1, 1: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">counts_gcd</span> <span class="o">=</span> <span class="n">gcd</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">())</span>

        <span class="k">if</span> <span class="n">counts_gcd</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="mi">0</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
                <span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="o">//</span> <span class="n">counts_gcd</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">count</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_lowest_terms</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.lt" class="doc doc-heading">
<code class="highlight language-python"><span class="n">lt</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__lt__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code></a> and <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code></a> methods.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">lt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python self.map(operator.__lt__, other).umap(bool)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).lt(3)</span>
<span class="sd">    H({False: 4, True: 2})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__lt__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.map" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">map</span><span class="p">(</span><span class="n">bin_op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Applies <em>bin_op</em> to each outcome of the histogram as the left operand and
<em>right_operand</em> as the right. Shorthands exist for many arithmetic operators and
comparators.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__add__</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__add__</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">36</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">**</span> <span class="mi">2</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__gt__</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__gt__</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">gt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bin_op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies *bin_op* to each outcome of the histogram as the left operand and</span>
<span class="sd">    *right_operand* as the right. Shorthands exist for many arithmetic operators and</span>
<span class="sd">    comparators.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.__add__, d6)</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.__add__, d6) == d6 + d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.__pow__, 2)</span>
<span class="sd">    H({1: 1, 4: 1, 9: 1, 16: 1, 25: 1, 36: 1})</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.__pow__, 2) == d6 ** 2</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.__gt__, 3)</span>
<span class="sd">    H({False: 3, True: 3})</span>
<span class="sd">    &gt;&gt;&gt; d6.map(operator.__gt__, 3) == d6.gt(3)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_operand</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
        <span class="n">right_operand</span> <span class="o">=</span> <span class="n">right_operand</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">right_operand</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
            <span class="p">(</span><span class="n">bin_op</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">o</span><span class="p">),</span> <span class="bp">self</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="o">*</span> <span class="n">right_operand</span><span class="p">[</span><span class="n">o</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
            <span class="p">(</span><span class="n">bin_op</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.mean" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mean</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RealLike</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the mean of the weighted outcomes (or 0.0 if there are no outcomes).</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">mean</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the mean of the weighted outcomes (or 0.0 if there are no outcomes).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">numerator</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">denominator</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">numerator</span> <span class="o">+=</span> <span class="n">outcome</span> <span class="o">*</span> <span class="n">count</span>
        <span class="n">denominator</span> <span class="o">+=</span> <span class="n">count</span>

    <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">denominator</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.ne" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ne</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__ne__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">ne</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="kc">False</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code></a> and <a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>umap</code></a> methods.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">ne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python self.map(operator.__ne__, other).umap(bool)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).ne(3)</span>
<span class="sd">    H({False: 1, True: 5})</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``map``][dyce.h.H.map] and [``umap``][dyce.h.H.umap] methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="fm">__ne__</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.order_stat_for_n_at_pos" class="doc doc-heading">
<code class="highlight language-python"><span class="n">order_stat_for_n_at_pos</span><span class="p">(</span><span class="n">n</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This method should be considered experimental and may change or disappear in
future versions.</p>
</div>
<p>Computes the probability distribution for each outcome appearing in at <em>pos</em> for
<em>n</em> histograms. <em>pos</em> is a zero-based index.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6avg</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6avg</span><span class="o">.</span><span class="n">order_stat_for_n_at_pos</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># counts where outcome appears in the fourth of five positions</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1432</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">4792</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1526</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>The results show that, when rolling five six-sided “averaging” dice and sorting
each roll, there are 26 ways where <code class="highlight"><span class="mi">2</span></code> appears at the fourth (index
<code class="highlight"><span class="mi">3</span></code>) position, 1432 ways where <code class="highlight"><span class="mi">3</span></code> appears at the fourth
position, etc. This can be verified independently using the computationally
expensive method of enumerating rolls and counting those that meet the criteria.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">P</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_5d6avg</span> <span class="o">=</span> <span class="mi">5</span><span class="nd">@P</span><span class="p">(</span><span class="n">d6avg</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">count</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">p_5d6avg</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">()</span> <span class="k">if</span> <span class="n">roll</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span>
<span class="mi">1526</span>
</code></pre></div></td></tr></table></div>
<p>Negative values for <em>pos</em> follow Python index semantics:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">order_stat_for_n_at_pos</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">order_stat_for_n_at_pos</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">order_stat_for_n_at_pos</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">==</span> <span class="n">d6</span><span class="o">.</span><span class="n">order_stat_for_n_at_pos</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>This method caches computing the betas for <em>n</em> so they can be reused for varying
values of <em>pos</em> in subsequent calls.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@experimental</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">order_stat_for_n_at_pos</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">,</span> <span class="n">pos</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Experimental&quot;</span>

<span class="sd">        This method should be considered experimental and may change or disappear in</span>
<span class="sd">        future versions.</span>

<span class="sd">    Computes the probability distribution for each outcome appearing in at *pos* for</span>
<span class="sd">    *n* histograms. *pos* is a zero-based index.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6avg = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">    &gt;&gt;&gt; d6avg.order_stat_for_n_at_pos(5, 3)  # counts where outcome appears in the fourth of five positions</span>
<span class="sd">    H({2: 26, 3: 1432, 4: 4792, 5: 1526})</span>

<span class="sd">    ```</span>

<span class="sd">    The results show that, when rolling five six-sided “averaging” dice and sorting</span>
<span class="sd">    each roll, there are 26 ways where ``#!python 2`` appears at the fourth (index</span>
<span class="sd">    ``#!python 3``) position, 1432 ways where ``#!python 3`` appears at the fourth</span>
<span class="sd">    position, etc. This can be verified independently using the computationally</span>
<span class="sd">    expensive method of enumerating rolls and counting those that meet the criteria.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from dyce import P</span>
<span class="sd">    &gt;&gt;&gt; p_5d6avg = 5@P(d6avg)</span>
<span class="sd">    &gt;&gt;&gt; sum(count for roll, count in p_5d6avg.rolls_with_counts() if roll[3] == 5)</span>
<span class="sd">    1526</span>

<span class="sd">    ```</span>

<span class="sd">    Negative values for *pos* follow Python index semantics:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6.order_stat_for_n_at_pos(6, 0) == d6.order_stat_for_n_at_pos(6, -6)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; d6.order_stat_for_n_at_pos(6, 5) == d6.order_stat_for_n_at_pos(6, -1)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    This method caches computing the betas for *n* so they can be reused for varying</span>
<span class="sd">    values of *pos* in subsequent calls.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># See &lt;https://math.stackexchange.com/q/4173084/226394&gt; for motivation</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">n</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_func_for_n</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">n</span> <span class="o">+</span> <span class="n">pos</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_order_stat_funcs_by_n</span><span class="p">[</span><span class="n">n</span><span class="p">](</span><span class="n">pos</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.outcomes" class="doc doc-heading">
<code class="highlight language-python"><span class="n">outcomes</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">KeysView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>More descriptive synonym for the <a class="autorefs autorefs-internal" href="#dyce.h.H.keys"><code>keys</code> method</a>.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">outcomes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KeysView</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    More descriptive synonym for the [``keys`` method][dyce.h.H.keys].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_h</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.remove" class="doc doc-heading">
<code class="highlight language-python"><span class="n">remove</span><span class="p">(</span><span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">outcome</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
        <span class="p">(</span><span class="n">orig_outcome</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">orig_outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">orig_outcome</span> <span class="o">!=</span> <span class="n">outcome</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.reversed" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">reversed</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">reversed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.rmap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rmap</span><span class="p">(</span><span class="n">left_operand</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">bin_op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Analogous to the <a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code> method</a>, but where the caller supplies
<em>left_operand</em>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">d6</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The positions of <em>left_operand</em> and <em>bin_op</em> are different from
<a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>map</code> method</a>. This is intentional and serves as a reminder
of operand ordering.</p>
</div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">rmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_operand</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">bin_op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Analogous to the [``map`` method][dyce.h.H.map], but where the caller supplies</span>
<span class="sd">    *left_operand*.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6.rmap(2, operator.__pow__)</span>
<span class="sd">    H({2: 1, 4: 1, 8: 1, 16: 1, 32: 1, 64: 1})</span>
<span class="sd">    &gt;&gt;&gt; d6.rmap(2, operator.__pow__) == 2 ** d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    !!! note</span>

<span class="sd">        The positions of *left_operand* and *bin_op* are different from</span>
<span class="sd">        [``map`` method][dyce.h.H.map]. This is intentional and serves as a reminder</span>
<span class="sd">        of operand ordering.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span>
        <span class="p">(</span><span class="n">bin_op</span><span class="p">(</span><span class="n">left_operand</span><span class="p">,</span> <span class="n">outcome</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.roll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">roll</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RealLike</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns a (weighted) random outcome.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a (weighted) random outcome.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">rng</span><span class="o">.</span><span class="n">RNG</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span>
            <span class="n">population</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outcomes</span><span class="p">()),</span>
            <span class="n">weights</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">()),</span>
            <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span>
        <span class="k">else</span> <span class="mi">0</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.stdev" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stdev</span><span class="p">(</span><span class="n">mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span></code>.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">stdev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python math.sqrt(self.variance(mu))``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.substitute" class="doc doc-heading">
<code class="highlight language-python"><span class="n">substitute</span><span class="p">(</span><span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span> <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span> <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IntegralLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>This method has been deprecated and will be removed in a future release. See
the <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.expandable"><code>expandable</code> decorator</a> and
<a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.foreach"><code>foreach</code> function</a> for more flexible
alternatives.</p>
</div>
<p>Calls <em>expand</em> on each outcome. If <em>expand</em> returns a single outcome, it
replaces the existing outcome. If it returns an <a class="autorefs autorefs-internal" href="#dyce.h.H"><code>H</code> object</a>,
evaluation is performed again (recursively) on that object until a limit (either
<em>max_depth</em> or <em>precision_limit</em>) is exhausted. <em>coalesce</em> is called on the
original outcome and the expanded histogram or outcome and the returned
histogram is “folded” into result. The default behavior for <em>coalesce</em> is to
replace the outcome with the expanded histogram. Returned histograms are always
reduced to their lowest terms.</p>
<div class="admonition note">
<p class="admonition-title"><em>coalesce</em> is not called unless <em>expand</em> returns a histogram</p>
<p>If <em>expand</em> returns a single outcome, it <em>always</em> replaces the existing
outcome. This is intentional. To return a single outcome, but trigger
<em>coalesce</em>, characterize that outcome as a single-sided die (e.g.,
<code class="highlight"><span class="n">H</span><span class="p">({</span><span class="n">outcome</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span></code>.</p>
</div>
<p>See the <a class="autorefs autorefs-internal" href="../dyce.h/#dyce.h.coalesce_replace"><code>coalesce_replace</code></a> and
<a class="autorefs autorefs-internal" href="#dyce.h.H.lowest_terms"><code>lowest_terms</code></a> methods.</p>
<div class="admonition tip">
<p class="admonition-title">Precision limits</p>
<p>The <em>max_depth</em> parameter is similar to an
<a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.expandable"><code>expandable</code></a>-decorated function’s limit
argument when given a whole number. The <em>precision_limit</em> parameter is
similar to an <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.expandable"><code>expandable</code></a>-decorated
function’s limit argument being provided a fractional value. It is an error
to provide values for both <em>max_depth</em> and <em>precision_limit</em>.</p>
</div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@deprecated</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">substitute</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">expand</span><span class="p">:</span> <span class="n">_SubstituteExpandCallbackT</span><span class="p">,</span>
    <span class="n">coalesce</span><span class="p">:</span> <span class="n">_SubstituteCoalesceCallbackT</span> <span class="o">=</span> <span class="n">coalesce_replace</span><span class="p">,</span>
    <span class="n">max_depth</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">IntegralLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">precision_limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">RationalLikeMixedU</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Deprecated&quot;</span>

<span class="sd">        This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">        the [``expandable`` decorator][dyce.evaluation.expandable] and</span>
<span class="sd">        [``foreach`` function][dyce.evaluation.foreach] for more flexible</span>
<span class="sd">        alternatives.</span>

<span class="sd">    Calls *expand* on each outcome. If *expand* returns a single outcome, it</span>
<span class="sd">    replaces the existing outcome. If it returns an [``H`` object][dyce.h.H],</span>
<span class="sd">    evaluation is performed again (recursively) on that object until a limit (either</span>
<span class="sd">    *max_depth* or *precision_limit*) is exhausted. *coalesce* is called on the</span>
<span class="sd">    original outcome and the expanded histogram or outcome and the returned</span>
<span class="sd">    histogram is “folded” into result. The default behavior for *coalesce* is to</span>
<span class="sd">    replace the outcome with the expanded histogram. Returned histograms are always</span>
<span class="sd">    reduced to their lowest terms.</span>

<span class="sd">    !!! note &quot;*coalesce* is not called unless *expand* returns a histogram&quot;</span>

<span class="sd">        If *expand* returns a single outcome, it *always* replaces the existing</span>
<span class="sd">        outcome. This is intentional. To return a single outcome, but trigger</span>
<span class="sd">        *coalesce*, characterize that outcome as a single-sided die (e.g.,</span>
<span class="sd">        ``#!python H({outcome: 1})``.</span>

<span class="sd">    See the [``coalesce_replace``][dyce.h.coalesce_replace] and</span>
<span class="sd">    [``lowest_terms``][dyce.h.H.lowest_terms] methods.</span>

<span class="sd">    !!! tip &quot;Precision limits&quot;</span>

<span class="sd">        The *max_depth* parameter is similar to an</span>
<span class="sd">        [``expandable``][dyce.evaluation.expandable]-decorated function’s limit</span>
<span class="sd">        argument when given a whole number. The *precision_limit* parameter is</span>
<span class="sd">        similar to an [``expandable``][dyce.evaluation.expandable]-decorated</span>
<span class="sd">        function’s limit argument being provided a fractional value. It is an error</span>
<span class="sd">        to provide values for both *max_depth* and *precision_limit*.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">.evaluation</span> <span class="kn">import</span> <span class="n">HResult</span><span class="p">,</span> <span class="n">LimitT</span><span class="p">,</span> <span class="n">expandable</span>

    <span class="k">if</span> <span class="n">max_depth</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;only one of max_depth and precision_limit is allowed&quot;</span><span class="p">)</span>

    <span class="n">limit</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">LimitT</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">max_depth</span> <span class="k">if</span> <span class="n">precision_limit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">precision_limit</span>
    <span class="p">)</span>

    <span class="nd">@expandable</span><span class="p">(</span><span class="n">sentinel</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_expand</span><span class="p">(</span><span class="n">result</span><span class="p">:</span> <span class="n">HResult</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">HOrOutcomeT</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">expand</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">h</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">outcome</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">coalesce</span><span class="p">(</span><span class="n">_expand</span><span class="p">(</span><span class="n">res</span><span class="p">),</span> <span class="n">result</span><span class="o">.</span><span class="n">outcome</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">H</span><span class="p">)</span> <span class="k">else</span> <span class="n">res</span>

    <span class="k">return</span> <span class="n">_expand</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.umap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">umap</span><span class="p">(</span><span class="n">un_op</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Applies <em>un_op</em> to each outcome of the histogram.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">outcome</span><span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="n">outcome</span><span class="p">)</span> <span class="o">**</span> <span class="n">outcome</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">27</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">256</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">umap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">un_op</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Applies *un_op* to each outcome of the histogram.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; H(6).umap(operator.__neg__)</span>
<span class="sd">    H({-6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(4).umap(lambda outcome: (-outcome) ** outcome)</span>
<span class="sd">    H({-27: 1, -1: 1, 4: 1, 256: 1})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)((</span><span class="n">un_op</span><span class="p">(</span><span class="n">outcome</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.values" class="doc doc-heading">
<code class="highlight language-python"><span class="n">values</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">ValuesView</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">values</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ValuesView</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.variance" class="doc doc-heading">
<code class="highlight language-python"><span class="n">variance</span><span class="p">(</span><span class="n">mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns the variance of the weighted outcomes. If provided, <em>mu</em> is used as the mean
(to avoid duplicate computation).</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">variance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mu</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RealLike</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the variance of the weighted outcomes. If provided, *mu* is used as the mean</span>
<span class="sd">    (to avoid duplicate computation).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">mu</span> <span class="k">if</span> <span class="n">mu</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">numerator</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">denominator</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">numerator</span> <span class="o">=</span> <span class="n">denominator</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">numerator</span> <span class="o">+=</span> <span class="n">outcome</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">count</span>
        <span class="n">denominator</span> <span class="o">+=</span> <span class="n">count</span>

    <span class="c1"># While floating point overflow is impossible to eliminate, we avoid it under</span>
    <span class="c1"># some circumstances by exploiting the equivalence of E[(X - E[X])**2] and the</span>
    <span class="c1"># more efficient E[X**2] - E[X]**2. See</span>
    <span class="c1"># &lt;https://dlsun.github.io/probability/variance.html&gt;.</span>
    <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="p">(</span><span class="n">denominator</span> <span class="ow">or</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">mu</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.vs" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vs</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Compares the histogram with <em>other</em>. -1 represents where <em>other</em> is greater. 0
represents where they are equal. 1 represents where <em>other</em> is less.</p>
<p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">vs</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">vs</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>See the <a class="autorefs autorefs-internal" href="#dyce.h.H.within"><code>within</code> method</a>.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">vs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compares the histogram with *other*. -1 represents where *other* is greater. 0</span>
<span class="sd">    represents where they are equal. 1 represents where *other* is less.</span>

<span class="sd">    Shorthand for ``#!python self.within(0, 0, other)``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(6).vs(H(4))</span>
<span class="sd">    H({-1: 6, 0: 4, 1: 14})</span>
<span class="sd">    &gt;&gt;&gt; H(6).vs(H(4)) == H(6).within(0, 0, H(4))</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    See the [``within`` method][dyce.h.H.within].</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.within" class="doc doc-heading">
<code class="highlight language-python"><span class="n">within</span><span class="p">(</span><span class="n">lo</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Computes the difference between the histogram and <em>other</em>. -1 represents where that
difference is less than <em>lo</em>. 0 represents where that difference between <em>lo</em>
and <em>hi</em> (inclusive). 1 represents where that difference is greater than <em>hi</em>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6_2</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6_2</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6_2</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>   <span class="o">-</span><span class="mf">0.25</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.72</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.52</span>
 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">41.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">####################</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6_3</span><span class="p">,</span> <span class="n">d8_2</span> <span class="o">=</span> <span class="mi">3</span><span class="nd">@H</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="nd">@H</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6_3</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d8_2</span><span class="p">)</span>  <span class="c1"># 3d6 w/in 1 of 2d8</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3500</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">3412</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">6912</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">d6_3</span><span class="o">.</span><span class="n">within</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">d8_2</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">0.25</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.83</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.69</span>
 <span class="o">-</span><span class="mi">1</span> <span class="o">|</span>  <span class="mf">25.32</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">0</span> <span class="o">|</span>  <span class="mf">24.68</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">1</span> <span class="o">|</span>  <span class="mf">50.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########################</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">within</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lo</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">hi</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">_OperandT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the difference between the histogram and *other*. -1 represents where that</span>
<span class="sd">    difference is less than *lo*. 0 represents where that difference between *lo*</span>
<span class="sd">    and *hi* (inclusive). 1 represents where that difference is greater than *hi*.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6_2 = 2@H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6_2.within(7, 9)</span>
<span class="sd">    H({-1: 15, 0: 15, 1: 6})</span>
<span class="sd">    &gt;&gt;&gt; print(d6_2.within(7, 9).format())</span>
<span class="sd">    avg |   -0.25</span>
<span class="sd">    std |    0.72</span>
<span class="sd">    var |    0.52</span>
<span class="sd">     -1 |  41.67% |####################</span>
<span class="sd">      0 |  41.67% |####################</span>
<span class="sd">      1 |  16.67% |########</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6_3, d8_2 = 3@H(6), 2@H(8)</span>
<span class="sd">    &gt;&gt;&gt; d6_3.within(-1, 1, d8_2)  # 3d6 w/in 1 of 2d8</span>
<span class="sd">    H({-1: 3500, 0: 3412, 1: 6912})</span>
<span class="sd">    &gt;&gt;&gt; print(d6_3.within(-1, 1, d8_2).format())</span>
<span class="sd">    avg |    0.25</span>
<span class="sd">    std |    0.83</span>
<span class="sd">    var |    0.69</span>
<span class="sd">     -1 |  25.32% |############</span>
<span class="sd">      0 |  24.68% |############</span>
<span class="sd">      1 |  50.00% |#########################</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_within</span><span class="p">(</span><span class="n">lo</span><span class="p">,</span> <span class="n">hi</span><span class="p">),</span> <span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.h.H.zero_fill" class="doc doc-heading">
<code class="highlight language-python"><span class="n">zero_fill</span><span class="p">(</span><span class="n">outcomes</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">RealLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="bp">self</span><span class="o">.</span><span class="n">accumulate</span><span class="p">({</span><span class="n">outcome</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span><span class="n">outcomes</span><span class="p">})</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">zero_fill</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">outcomes</span><span class="p">())</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">0</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/h.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">zero_fill</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcomes</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">RealLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="s2">&quot;H&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python self.accumulate({outcome: 0 for outcome in</span>
<span class="sd">    outcomes})``.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; H(4).zero_fill(H(8).outcomes())</span>
<span class="sd">    H({1: 1, 2: 1, 3: 1, 4: 1, 5: 0, 6: 0, 7: 0, 8: 0})</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">accumulate</span><span class="p">({</span><span class="n">outcome</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">outcome</span> <span class="ow">in</span> <span class="n">outcomes</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="dyce.p.P" class="doc doc-heading">
          <code>P</code>


</h2>


  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="dyce.h.H" href="#dyce.h.H">H</a>]</code>, <code><a class="autorefs autorefs-internal" title="dyce.h.HableOpsMixin" href="../dyce.h/#dyce.h.HableOpsMixin">HableOpsMixin</a></code></p>

  
      <p>An immutable pool (ordered sequence) supporting group operations for zero or more
<a class="autorefs autorefs-internal" href="#dyce.h.H"><code>H</code> objects</a> (provided or created from the
<a class="autorefs autorefs-internal" href="#dyce.p.P.__init__">initializer</a>’s <em>args</em> parameter).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">P</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="p">;</span> <span class="n">p_d6</span>  <span class="c1"># shorthand for P(H(6))</span>
<span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="n">p_d6</span><span class="p">,</span> <span class="n">p_d6</span><span class="p">)</span>  <span class="c1"># 2d6</span>
<span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="nd">@p_d6</span>  <span class="c1"># also 2d6</span>
<span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span><span class="o">@</span><span class="p">(</span><span class="mi">2</span><span class="nd">@p_d6</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="nd">@p_d6</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">P</span><span class="p">(</span><span class="mi">20</span><span class="p">))))))</span> <span class="p">;</span> <span class="n">p</span>
<span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">18</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">19</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">roll</span><span class="p">())</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>This class implements the <a class="autorefs autorefs-internal" href="../dyce.h/#dyce.h.HableT"><code>HableT</code> protocol</a> and derives from the
<a class="autorefs autorefs-internal" href="../dyce.h/#dyce.h.HableOpsMixin"><code>HableOpsMixin</code> class</a>, which means it can be
“flattened” into a single histogram, either explicitly via the
<a class="autorefs autorefs-internal" href="#dyce.p.P.h"><code>h</code> method</a>, or implicitly by using arithmetic operations.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="o">-</span><span class="n">p_d6</span>
<span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_d6</span> <span class="o">+</span> <span class="n">p_d6</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>To perform arithmetic on individual <a class="autorefs autorefs-internal" href="#dyce.h.H"><code>H</code> objects</a> in a pool without
flattening, use the <a class="autorefs autorefs-internal" href="#dyce.p.P.map"><code>map</code></a>, <a class="autorefs autorefs-internal" href="#dyce.p.P.rmap"><code>rmap</code></a>, and
<a class="autorefs autorefs-internal" href="#dyce.p.P.umap"><code>umap</code></a> methods.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">)</span>
<span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">36</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="fm">__pow__</span><span class="p">)</span>
<span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>
<p>Comparisons with <a class="autorefs autorefs-internal" href="#dyce.h.H"><code>H</code> objects</a> work as expected.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@p_d6</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">+</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>Indexing selects a contained histogram.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>Note that pools are opinionated about ordering.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>In an extension to (departure from) the <a class="autorefs autorefs-internal" href="../dyce.h/#dyce.h.HableT"><code>HableT</code> protocol</a>, the
<a class="autorefs autorefs-internal" href="#dyce.p.P.h"><code>h</code> method</a>’s implementation also affords subsets of outcomes to be
“taken” (selected) by passing in selection criteria. Values are indexed from least
to greatest. Negative indexes are supported and retain their idiomatic meaning.
Modeling the sum of the greatest two faces of three six-sided dice (<code>3d6</code>) can be
expressed as:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span> <span class="o">=</span> <span class="mi">3</span><span class="nd">@p_d6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">16</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p_3d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">8.46</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">2.21</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">4.91</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">0.46</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">3</span> <span class="o">|</span>   <span class="mf">1.39</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">3.24</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">5</span> <span class="o">|</span>   <span class="mf">5.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">##</span>
  <span class="mi">6</span> <span class="o">|</span>   <span class="mf">8.80</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">7</span> <span class="o">|</span>  <span class="mf">12.50</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">8</span> <span class="o">|</span>  <span class="mf">15.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">#######</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">16.67</span><span class="o">%</span> <span class="o">|</span><span class="c1">########</span>
 <span class="mi">10</span> <span class="o">|</span>  <span class="mf">15.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">#######</span>
 <span class="mi">11</span> <span class="o">|</span>  <span class="mf">12.50</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">7.41</span><span class="o">%</span> <span class="o">|</span><span class="c1">###</span>
</code></pre></div></td></tr></table></div>

            <details class="quote">
              <summary>Source code in <code>dyce/p.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">P</span><span class="p">(</span><span class="n">Sequence</span><span class="p">[</span><span class="n">H</span><span class="p">],</span> <span class="n">HableOpsMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An immutable pool (ordered sequence) supporting group operations for zero or more</span>
<span class="sd">    [``H`` objects][dyce.h.H] (provided or created from the</span>
<span class="sd">    [initializer][dyce.p.P.__init__]’s *args* parameter).</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from dyce import P</span>
<span class="sd">    &gt;&gt;&gt; p_d6 = P(6) ; p_d6  # shorthand for P(H(6))</span>
<span class="sd">    P(H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1}))</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; P(p_d6, p_d6)  # 2d6</span>
<span class="sd">    2@P(H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1}))</span>
<span class="sd">    &gt;&gt;&gt; 2@p_d6  # also 2d6</span>
<span class="sd">    2@P(H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1}))</span>
<span class="sd">    &gt;&gt;&gt; 2@(2@p_d6) == 4@p_d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p = P(4, P(6, P(8, P(10, P(12, P(20)))))) ; p</span>
<span class="sd">    P(H({1: 1, 2: 1, 3: 1, 4: 1}), H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1}), H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1}), H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1}), H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1, 11: 1, 12: 1}), H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1, 9: 1, 10: 1, 11: 1, 12: 1, 13: 1, 14: 1, 15: 1, 16: 1, 17: 1, 18: 1, 19: 1, 20: 1}))</span>
<span class="sd">    &gt;&gt;&gt; sum(p.roll()) in p.h()</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    This class implements the [``HableT`` protocol][dyce.h.HableT] and derives from the</span>
<span class="sd">    [``HableOpsMixin`` class][dyce.h.HableOpsMixin], which means it can be</span>
<span class="sd">    “flattened” into a single histogram, either explicitly via the</span>
<span class="sd">    [``h`` method][dyce.p.P.h], or implicitly by using arithmetic operations.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; -p_d6</span>
<span class="sd">    H({-6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p_d6 + p_d6</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; 2 * P(8) - 1</span>
<span class="sd">    H({1: 1, 3: 1, 5: 1, 7: 1, 9: 1, 11: 1, 13: 1, 15: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    To perform arithmetic on individual [``H`` objects][dyce.h.H] in a pool without</span>
<span class="sd">    flattening, use the [``map``][dyce.p.P.map], [``rmap``][dyce.p.P.rmap], and</span>
<span class="sd">    [``umap``][dyce.p.P.umap] methods.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; P(4, 6, 8).umap(operator.__neg__)</span>
<span class="sd">    P(H({-8: 1, -7: 1, -6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1}), H({-6: 1, -5: 1, -4: 1, -3: 1, -2: 1, -1: 1}), H({-4: 1, -3: 1, -2: 1, -1: 1}))</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; P(4, 6).map(operator.__pow__, 2)</span>
<span class="sd">    P(H({1: 1, 4: 1, 9: 1, 16: 1}), H({1: 1, 4: 1, 9: 1, 16: 1, 25: 1, 36: 1}))</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; P(4, 6).rmap(2, operator.__pow__)</span>
<span class="sd">    P(H({2: 1, 4: 1, 8: 1, 16: 1}), H({2: 1, 4: 1, 8: 1, 16: 1, 32: 1, 64: 1}))</span>

<span class="sd">    ```</span>

<span class="sd">    Comparisons with [``H`` objects][dyce.h.H] work as expected.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from dyce import H</span>
<span class="sd">    &gt;&gt;&gt; 3@p_d6 == H(6) + H(6) + H(6)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    Indexing selects a contained histogram.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; P(4, 6, 8)[0]</span>
<span class="sd">    H({1: 1, 2: 1, 3: 1, 4: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    Note that pools are opinionated about ordering.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; P(8, 6, 4)</span>
<span class="sd">    P(H({1: 1, 2: 1, 3: 1, 4: 1}), H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1}), H({1: 1, 2: 1, 3: 1, 4: 1, 5: 1, 6: 1, 7: 1, 8: 1}))</span>
<span class="sd">    &gt;&gt;&gt; P(8, 6, 4)[0] == P(8, 4, 6)[0] == H(4)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    In an extension to (departure from) the [``HableT`` protocol][dyce.h.HableT], the</span>
<span class="sd">    [``h`` method][dyce.p.P.h]’s implementation also affords subsets of outcomes to be</span>
<span class="sd">    “taken” (selected) by passing in selection criteria. Values are indexed from least</span>
<span class="sd">    to greatest. Negative indexes are supported and retain their idiomatic meaning.</span>
<span class="sd">    Modeling the sum of the greatest two faces of three six-sided dice (``3d6``) can be</span>
<span class="sd">    expressed as:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p_3d6 = 3@p_d6</span>
<span class="sd">    &gt;&gt;&gt; p_3d6.h(-2, -1)</span>
<span class="sd">    H({2: 1, 3: 3, 4: 7, 5: 12, 6: 19, 7: 27, 8: 34, 9: 36, 10: 34, 11: 27, 12: 16})</span>
<span class="sd">    &gt;&gt;&gt; print(p_3d6.h(-2, -1).format())</span>
<span class="sd">    avg |    8.46</span>
<span class="sd">    std |    2.21</span>
<span class="sd">    var |    4.91</span>
<span class="sd">      2 |   0.46% |</span>
<span class="sd">      3 |   1.39% |</span>
<span class="sd">      4 |   3.24% |#</span>
<span class="sd">      5 |   5.56% |##</span>
<span class="sd">      6 |   8.80% |####</span>
<span class="sd">      7 |  12.50% |######</span>
<span class="sd">      8 |  15.74% |#######</span>
<span class="sd">      9 |  16.67% |########</span>
<span class="sd">     10 |  15.74% |#######</span>
<span class="sd">     11 |  12.50% |######</span>
<span class="sd">     12 |   7.41% |###</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="vm">__slots__</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="p">(</span>
        <span class="s2">&quot;_hs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_total&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># ---- Initializer -----------------------------------------------------------------</span>

    <span class="nd">@beartype</span>
    <span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_gen_hs</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">H</span><span class="p">]:</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">a</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">_hs</span><span class="p">:</span>
                        <span class="k">yield</span> <span class="n">h</span>
                <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
                    <span class="k">yield</span> <span class="n">H</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unrecognized initializer type </span><span class="si">{</span><span class="n">a</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">hs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">_gen_hs</span><span class="p">()</span> <span class="k">if</span> <span class="n">h</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">hs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="c1"># This is for outcomes that don&#39;t support direct comparisons, like symbolic</span>
            <span class="c1"># representations</span>
            <span class="n">hs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">hs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">total</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>

    <span class="c1"># ---- Properties ------------------------------------------------------------------</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">total</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            This method should be considered experimental and may change or disappear in</span>
<span class="sd">            future versions.</span>

<span class="sd">        Equivalent to ``#!python prod(h.total for h in self)``. Note that—consistent</span>
<span class="sd">        with the empty product—this is ``#!python 1`` for an empty pool.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_total</span>

    <span class="c1"># ---- Overrides -------------------------------------------------------------------</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">group_counters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">)</span>
            <span class="n">group_counters</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>

        <span class="k">def</span> <span class="nf">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_counters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">h</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">group_counters</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">group_counters</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">group_counters</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">group_counters</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
            <span class="k">return</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
            <span class="k">return</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">SupportsIndex</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="nb">slice</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">[</span><span class="fm">__index__</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">H</span><span class="p">]:</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="k">if</span> <span class="n">other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;argument cannot be negative&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)))</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="fm">__rmatmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__matmul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Roughly equivalent to ``#!python H((sum(roll), count) for roll, count in</span>
<span class="sd">        self.rolls_with_counts(*which))`` with some short-circuit optimizations.</span>

<span class="sd">        When provided no arguments, ``#!python h`` combines (or “flattens”) contained</span>
<span class="sd">        histograms in accordance with the [``HableT`` protocol][dyce.h.HableT].</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; (2@P(6)).h()</span>
<span class="sd">        H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        If one or more arguments are provided, this method sums subsets of outcomes</span>
<span class="sd">        those arguments identify for each roll. Outcomes are ordered from least (index</span>
<span class="sd">        ``#!python 0``) to greatest (index ``#!python -1`` or ``#!python len(self) -</span>
<span class="sd">        1``). Identifiers can be ``#!python int``s or ``#!python slice``s, and can be</span>
<span class="sd">        mixed.</span>

<span class="sd">        Taking the greatest of two six-sided dice can be modeled as:</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; p_2d6 = 2@P(6)</span>
<span class="sd">        &gt;&gt;&gt; p_2d6.h(-1)</span>
<span class="sd">        H({1: 1, 2: 3, 3: 5, 4: 7, 5: 9, 6: 11})</span>
<span class="sd">        &gt;&gt;&gt; print(p_2d6.h(-1).format())</span>
<span class="sd">        avg |    4.47</span>
<span class="sd">        std |    1.40</span>
<span class="sd">        var |    1.97</span>
<span class="sd">          1 |   2.78% |#</span>
<span class="sd">          2 |   8.33% |####</span>
<span class="sd">          3 |  13.89% |######</span>
<span class="sd">          4 |  19.44% |#########</span>
<span class="sd">          5 |  25.00% |############</span>
<span class="sd">          6 |  30.56% |###############</span>

<span class="sd">        ```</span>

<span class="sd">        Taking the greatest two and least two faces of ten four-sided dice (``10d4``)</span>
<span class="sd">        can be modeled as:</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; p_10d4 = 10@P(4)</span>
<span class="sd">        &gt;&gt;&gt; p_10d4.h(slice(2), slice(-2, None))</span>
<span class="sd">        H({4: 1, 5: 10, 6: 1012, 7: 5030, 8: 51973, 9: 168760, 10: 595004, 11: 168760, 12: 51973, 13: 5030, 14: 1012, 15: 10, 16: 1})</span>
<span class="sd">        &gt;&gt;&gt; print(p_10d4.h(slice(2), slice(-2, None)).format(scaled=True))</span>
<span class="sd">        avg |   10.00</span>
<span class="sd">        std |    0.91</span>
<span class="sd">        var |    0.84</span>
<span class="sd">          4 |   0.00% |</span>
<span class="sd">          5 |   0.00% |</span>
<span class="sd">          6 |   0.10% |</span>
<span class="sd">          7 |   0.48% |</span>
<span class="sd">          8 |   4.96% |####</span>
<span class="sd">          9 |  16.09% |##############</span>
<span class="sd">         10 |  56.74% |##################################################</span>
<span class="sd">         11 |  16.09% |##############</span>
<span class="sd">         12 |   4.96% |####</span>
<span class="sd">         13 |   0.48% |</span>
<span class="sd">         14 |   0.10% |</span>
<span class="sd">         15 |   0.00% |</span>
<span class="sd">         16 |   0.00% |</span>

<span class="sd">        ```</span>

<span class="sd">        Taking all outcomes exactly once is equivalent to summing the histograms in the</span>
<span class="sd">        pool.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">        &gt;&gt;&gt; d6avg = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">        &gt;&gt;&gt; p = 2@P(d6, d6avg)</span>
<span class="sd">        &gt;&gt;&gt; p.h(slice(None)) == p.h() == d6 + d6 + d6avg + d6avg</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">_analyze_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
                <span class="c1"># The caller selected all dice in the pool exactly i // n times, so we</span>
                <span class="c1"># can short-circuit roll enumeration</span>
                <span class="k">assert</span> <span class="n">i</span> <span class="o">%</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span>

                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">H</span><span class="p">(</span>
                    <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="n">which</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># The caller offered no selection</span>
            <span class="k">return</span> <span class="n">sum_h</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="c1"># ---- Methods ---------------------------------------------------------------------</span>

    <span class="nd">@classmethod</span>
    <span class="nd">@deprecated</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">foreach</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">dependent_term</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]],</span>
        <span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
        <span class="o">**</span><span class="n">independent_sources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">HableT</span><span class="p">,</span> <span class="n">_SourceT</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Deprecated&quot;</span>

<span class="sd">            This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">            the [``expandable`` decorator][dyce.evaluation.expandable] and</span>
<span class="sd">            [``foreach`` function][dyce.evaluation.foreach] for more flexible</span>
<span class="sd">            alternatives.</span>

<span class="sd">        Calls ``#!python dependent_term`` for each unique set of rolls from the product</span>
<span class="sd">        of ``independent_sources`` and accumulates the results. This is useful for</span>
<span class="sd">        resolving dependent probabilities. Rolls are sorted least to greatest. Returned</span>
<span class="sd">        histograms are always reduced to their lowest terms.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; from dyce.p import RollT</span>

<span class="sd">        &gt;&gt;&gt; def three_way_vs(first: RollT, second: RollT, third: RollT):</span>
<span class="sd">        ...   first_reversed = first[::-1]</span>
<span class="sd">        ...   second_reversed = second[::-1]</span>
<span class="sd">        ...   third_reversed = third[::-1]</span>
<span class="sd">        ...   if first_reversed &gt; second_reversed and first_reversed &gt; third_reversed:</span>
<span class="sd">        ...     return 1  # first is the clear winner</span>
<span class="sd">        ...   elif second_reversed &gt; first_reversed and second_reversed &gt; third_reversed:</span>
<span class="sd">        ...     return 2  # second is the clear winner</span>
<span class="sd">        ...   elif third_reversed &gt; first_reversed and third_reversed &gt; second_reversed:</span>
<span class="sd">        ...     return 3  # third is the clear winner</span>
<span class="sd">        ...   else:</span>
<span class="sd">        ...     return 0  # there was a tie somewhere</span>

<span class="sd">        &gt;&gt;&gt; P.foreach(</span>
<span class="sd">        ...   three_way_vs,</span>
<span class="sd">        ...   first=P(6, 6),  # first has pool of two d6s</span>
<span class="sd">        ...   second=P(6, 6),  # second has pool of two d6s</span>
<span class="sd">        ...   third=P(4, 8),  # third has pool of one d4 and one d8</span>
<span class="sd">        ... )</span>
<span class="sd">        H({0: 1103, 1: 5783, 2: 5783, 3: 8067})</span>

<span class="sd">        ```</span>

<span class="sd">        When all of ``#!python foreach``’s arguments are [``P`` objects][dyce.p.P] of</span>
<span class="sd">        size 1 or anything other than a ``P`` object, this function behaves similarly to</span>
<span class="sd">        [``H.foreach``][dyce.h.H] (although the signature of the *dependent_term*</span>
<span class="sd">        callback function differs slightly between the two interfaces).</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; from itertools import chain</span>
<span class="sd">        &gt;&gt;&gt; P.foreach(</span>
<span class="sd">        ...   lambda **kw: sum(chain(*kw.values())),  # receives single-element rolls</span>
<span class="sd">        ...   src1=P(6),  # pool of size 1</span>
<span class="sd">        ...   src2=H(6),  # histogram</span>
<span class="sd">        ...   src3=range(6, 0, -1),  # histogram source</span>
<span class="sd">        ... ) == H.foreach(</span>
<span class="sd">        ...   lambda **kw: sum(kw.values()),  # receives outcomes</span>
<span class="sd">        ...   src1=P(6).h(),  # histogram</span>
<span class="sd">        ...   src2=H(6),  # histogram</span>
<span class="sd">        ...   src3={1, 2, 3, 4, 5, 6},  # histogram source</span>
<span class="sd">        ... )</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        The ``#!python foreach`` class method is equivalent to nesting loops iterating</span>
<span class="sd">        over [``P.rolls_with_counts``][dyce.p.P.rolls_with_counts] for each independent</span>
<span class="sd">        term and then aggregating the results.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; def dependent_term(</span>
<span class="sd">        ...   *,</span>
<span class="sd">        ...   roll_1,</span>
<span class="sd">        ...   roll_2,</span>
<span class="sd">        ...   # ...</span>
<span class="sd">        ...   roll_n,</span>
<span class="sd">        ... ):</span>
<span class="sd">        ...   return (</span>
<span class="sd">        ...     (roll_2[-1] &gt; roll_1[-1])</span>
<span class="sd">        ...     + (roll_n[-1] &gt; roll_2[-1])</span>
<span class="sd">        ...     # ...</span>
<span class="sd">        ...   )</span>

<span class="sd">        &gt;&gt;&gt; source_1 = P(8)</span>
<span class="sd">        &gt;&gt;&gt; source_2 = P(6, 6)</span>
<span class="sd">        &gt;&gt;&gt; # ...</span>
<span class="sd">        &gt;&gt;&gt; source_n = P(4, 4, 4)</span>

<span class="sd">        &gt;&gt;&gt; h = P.foreach(</span>
<span class="sd">        ...   dependent_term,</span>
<span class="sd">        ...   roll_1=source_1,</span>
<span class="sd">        ...   roll_2=source_2,</span>
<span class="sd">        ...   # ...</span>
<span class="sd">        ...   roll_n=source_n,</span>
<span class="sd">        ... ) ; h</span>
<span class="sd">        H({0: 3821, 1: 5126, 2: 269})</span>

<span class="sd">        &gt;&gt;&gt; def resolve():</span>
<span class="sd">        ...   for roll_1, count_1 in source_1.rolls_with_counts():</span>
<span class="sd">        ...     for roll_2, count_2 in source_2.rolls_with_counts():</span>
<span class="sd">        ...       # ...</span>
<span class="sd">        ...       for roll_n, count_n in source_n.rolls_with_counts():</span>
<span class="sd">        ...         # ...</span>
<span class="sd">        ...           yield dependent_term(</span>
<span class="sd">        ...             roll_1=roll_1,</span>
<span class="sd">        ...             roll_2=roll_2,</span>
<span class="sd">        ...             # ...</span>
<span class="sd">        ...             roll_n=roll_n,</span>
<span class="sd">        ...         ), (</span>
<span class="sd">        ...           count_1</span>
<span class="sd">        ...           * count_2</span>
<span class="sd">        ...           # * ...</span>
<span class="sd">        ...           * count_n</span>
<span class="sd">        ...         )</span>

<span class="sd">        &gt;&gt;&gt; from dyce.evaluation import aggregate_weighted</span>
<span class="sd">        &gt;&gt;&gt; aggregate_weighted(resolve()) == h</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">dyce.evaluation</span> <span class="kn">import</span> <span class="n">aggregate_weighted</span>

        <span class="n">pools_by_kw</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">P</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">for</span> <span class="n">source_name</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">independent_sources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
                <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
                <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
                <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>

        <span class="k">def</span> <span class="nf">_kw_roll_count_tuples</span><span class="p">(</span>
            <span class="n">pool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RollT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
            <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">pool_name</span><span class="p">]</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">():</span>
                <span class="k">yield</span> <span class="n">pool_name</span><span class="p">,</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span>

        <span class="k">def</span> <span class="nf">_resolve_dependent_term_for_rolls</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
            <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span>
        <span class="p">):</span>
            <span class="k">for</span> <span class="n">kw_roll_count_tuples</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span>
                <span class="o">*</span><span class="p">(</span><span class="n">_kw_roll_count_tuples</span><span class="p">(</span><span class="n">pool_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">pool_name</span> <span class="ow">in</span> <span class="n">pools_by_kw</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">combined_count</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">count</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">kw_roll_count_tuples</span><span class="p">)</span>
                <span class="n">rolls_by_name</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">roll</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">roll</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kw_roll_count_tuples</span><span class="p">}</span>
                <span class="k">yield</span> <span class="n">dependent_term</span><span class="p">(</span><span class="o">**</span><span class="n">rolls_by_name</span><span class="p">),</span> <span class="n">combined_count</span>

        <span class="k">return</span> <span class="n">aggregate_weighted</span><span class="p">(</span><span class="n">_resolve_dependent_term_for_rolls</span><span class="p">())</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>

    <span class="nd">@experimental</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">is_homogeneous</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            This property should be considered experimental and may change or disappear</span>
<span class="sd">            in future versions.</span>

<span class="sd">        Returns whether the pool’s population of histograms is homogeneous.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; P(6, 6).is_homogeneous()</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; P(4, 6, 8).is_homogeneous()</span>
<span class="sd">        False</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span>

    <span class="nd">@experimental</span>
    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">appearances_in_rolls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        !!! warning &quot;Experimental&quot;</span>

<span class="sd">            This method should be considered experimental and may change or disappear in</span>
<span class="sd">            future versions. While it does provide a performance improvement over other</span>
<span class="sd">            techniques, it is not significant for most applications, and rarely</span>
<span class="sd">            justifies the corresponding reduction in readability.</span>

<span class="sd">        Returns a histogram where the outcomes (keys) are the number of times *outcome*</span>
<span class="sd">        appears, and the counts are the number of rolls where *outcome* appears</span>
<span class="sd">        precisely that number of times. Equivalent to ``#!python H((sum(1 for v in roll</span>
<span class="sd">        if v == outcome), count) for roll, count in self.rolls_with_counts())``, but</span>
<span class="sd">        much more efficient.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; p_2d6 = P(6, 6)</span>
<span class="sd">        &gt;&gt;&gt; sorted(p_2d6.rolls_with_counts())</span>
<span class="sd">        [((1, 1), 1), ((1, 2), 2), ((1, 3), 2), ((1, 4), 2), ((1, 5), 2), ((1, 6), 2), ...]</span>
<span class="sd">        &gt;&gt;&gt; p_2d6.appearances_in_rolls(1)</span>
<span class="sd">        H({0: 25, 1: 10, 2: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; # Least efficient, by far</span>
<span class="sd">        &gt;&gt;&gt; d4, d6 = H(4), H(6)</span>
<span class="sd">        &gt;&gt;&gt; p_3d4_2d6 = P(d4, d4, d4, d6, d6)</span>
<span class="sd">        &gt;&gt;&gt; H((sum(1 for v in roll if v == 3), count) for roll, count in p_3d4_2d6.rolls_with_counts())</span>
<span class="sd">        H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; # Pretty darned efficient, generalizable to other boolean inquiries, and</span>
<span class="sd">        &gt;&gt;&gt; # arguably the most readable</span>
<span class="sd">        &gt;&gt;&gt; d4_eq3, d6_eq3 = d4.eq(3), d6.eq(3)</span>
<span class="sd">        &gt;&gt;&gt; 3@d4_eq3 + 2@d6_eq3</span>
<span class="sd">        H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; # Most efficient for large sets of dice</span>
<span class="sd">        &gt;&gt;&gt; p_3d4_2d6.appearances_in_rolls(3)</span>
<span class="sd">        H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">        ```</span>

<span class="sd">        Based on some rudimentary testing, this method appears to converge on being</span>
<span class="sd">        about twice as fast as the boolean accumulation technique for larger sets.</span>

<span class="sd">        ``` python</span>
<span class="sd">        --8&lt;-- &quot;docs/assets/perf_appearances_in_rolls.txt&quot;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;details&gt;</span>
<span class="sd">        &lt;summary&gt;Source: &lt;a href=&quot;https://github.com/posita/dyce/blob/latest/docs/assets/perf_appearances_in_rolls.ipy&quot;&gt;&lt;code&gt;perf_appearances_in_rolls.ipy&lt;/code&gt;&lt;/a&gt;&lt;/summary&gt;</span>

<span class="sd">        ``` python</span>
<span class="sd">        --8&lt;-- &quot;docs/assets/perf_appearances_in_rolls.ipy&quot;</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/details&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">group_counters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Counter</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">group_counter</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
            <span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">exactly_k_times_in_n</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                    <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
                <span class="p">)</span>

            <span class="n">group_counters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_counter</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sum_h</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">group_counter</span><span class="p">)</span> <span class="k">for</span> <span class="n">group_counter</span> <span class="ow">in</span> <span class="n">group_counters</span><span class="p">)</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RollT</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns (weighted) random outcomes from contained histograms.</span>

<span class="sd">        !!! note &quot;On ordering&quot;</span>

<span class="sd">            This method “works” (i.e., falls back to a “natural” ordering of string</span>
<span class="sd">            representations) for outcomes whose relative values cannot be known (e.g.,</span>
<span class="sd">            symbolic expressions). This is deliberate to allow random roll functionality</span>
<span class="sd">            where symbolic resolution is not needed or will happen later.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">sorted_outcomes</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">roll</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">rolls_with_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns an iterator yielding two-tuples (pairs) that, collectively, enumerate all</span>
<span class="sd">        possible outcomes for the pool. The first item in the two-tuple is a sorted</span>
<span class="sd">        sequence of the outcomes for a distinct roll. The second is the count for that</span>
<span class="sd">        roll. Outcomes in each roll are ordered least to greatest.</span>

<span class="sd">        If one or more arguments are provided, this methods selects subsets of outcomes</span>
<span class="sd">        for each roll. Outcomes in each roll are ordered from least (index ``#!python</span>
<span class="sd">        0``) to greatest (index ``#!python -1`` or ``#!python len(self) - 1``).</span>
<span class="sd">        Identifiers can be ``#!python int``s or ``#!python slice``s, and can be mixed</span>
<span class="sd">        for more flexible selections.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; from collections import Counter</span>

<span class="sd">        &gt;&gt;&gt; def accumulate_roll_counts(counter, roll_counts):</span>
<span class="sd">        ...   for roll, count in roll_counts:</span>
<span class="sd">        ...     counter[roll] += count</span>
<span class="sd">        ...   return counter</span>

<span class="sd">        &gt;&gt;&gt; p_6d6 = 6@P(6)</span>
<span class="sd">        &gt;&gt;&gt; every_other_d6 = accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(slice(None, None, -2))) ; every_other_d6</span>
<span class="sd">        Counter({(6, 4, 2): 4110, (6, 5, 3): 3390, (6, 4, 3): 3330, ..., (3, 3, 3): 13, (2, 2, 2): 7, (1, 1, 1): 1})</span>
<span class="sd">        &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(5, 3, 1)) == every_other_d6</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(*range(5, 0, -2))) == every_other_d6</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(*(i for i in range(6, 0, -1) if i % 2 == 1))) == every_other_d6</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        One way to model the likelihood of achieving a “Yhatzee” (i.e., where five</span>
<span class="sd">        six-sided dice show the same face) on a single roll by checking rolls for where</span>
<span class="sd">        the least and greatest outcomes are the same.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; p_5d6 = 5@P(6)</span>
<span class="sd">        &gt;&gt;&gt; yhatzee_on_single_roll = H(</span>
<span class="sd">        ...   (1 if roll[0] == roll[-1] else 0, count)</span>
<span class="sd">        ...   for roll, count</span>
<span class="sd">        ...   in p_5d6.rolls_with_counts()</span>
<span class="sd">        ... )</span>
<span class="sd">        &gt;&gt;&gt; print(yhatzee_on_single_roll.format(width=0))</span>
<span class="sd">        {..., 0: 99.92%, 1:  0.08%}</span>

<span class="sd">        ```</span>

<span class="sd">        !!! note &quot;In the general case, rolls may appear more than once.&quot;</span>

<span class="sd">            ``` python</span>
<span class="sd">            &gt;&gt;&gt; sorted(P(H(2), H(3)).rolls_with_counts())</span>
<span class="sd">            [((1, 1), 1), ((1, 2), 1), ((1, 2), 1), ((1, 3), 1), ((2, 2), 1), ((2, 3), 1)]</span>

<span class="sd">            ```</span>

<span class="sd">            In the above, ``#!python (1, 2)`` appears a total of two times, each with</span>
<span class="sd">            counts of one.</span>

<span class="sd">            However, if the pool is homogeneous (meaning it only contains identical</span>
<span class="sd">            histograms), rolls (before selection) are not repeated. (See the note on</span>
<span class="sd">            implementation below.)</span>

<span class="sd">            ``` python</span>
<span class="sd">            &gt;&gt;&gt; sorted((2@P(H((-1, 0, 1)))).rolls_with_counts())</span>
<span class="sd">            [((-1, -1), 1), ((-1, 0), 2), ((-1, 1), 2), ((0, 0), 1), ((0, 1), 2), ((1, 1), 1)]</span>

<span class="sd">            ```</span>

<span class="sd">            Either way, by summing and counting all rolls, we can confirm identity.</span>

<span class="sd">            ``` python</span>
<span class="sd">            &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">            &gt;&gt;&gt; d6avg = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">            &gt;&gt;&gt; p = 2@P(d6, d6avg)</span>
<span class="sd">            &gt;&gt;&gt; H((sum(roll), count) for roll, count in p.rolls_with_counts()) == p.h() == d6 + d6 + d6avg + d6avg</span>
<span class="sd">            True</span>

<span class="sd">            ```</span>

<span class="sd">        This method does not try to outsmart callers by (mis)interpreting selection</span>
<span class="sd">        arguments. It honors selection identifier order and any redundancy.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; p_d3_d4 = P(H(3), H(4))</span>
<span class="sd">        &gt;&gt;&gt; # Select the second, first, then second (again) elements</span>
<span class="sd">        &gt;&gt;&gt; sorted(p_d3_d4.rolls_with_counts(-1, 0, 1))</span>
<span class="sd">        [((1, 1, 1), 1), ((2, 1, 2), 1), ((2, 1, 2), 1), ..., ((4, 1, 4), 1), ((4, 2, 4), 1), ((4, 3, 4), 1)]</span>

<span class="sd">        ```</span>

<span class="sd">        Selecting the same outcomes, but in a different order is not immediately</span>
<span class="sd">        comparable.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; select_0_1 = sorted(p_d3_d4.rolls_with_counts(0, 1))</span>
<span class="sd">        &gt;&gt;&gt; select_1_0 = sorted(p_d3_d4.rolls_with_counts(1, 0))</span>
<span class="sd">        &gt;&gt;&gt; select_0_1 == select_1_0</span>
<span class="sd">        False</span>

<span class="sd">        ```</span>

<span class="sd">        Equivalence can be tested when selected outcomes are sorted.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; sorted_0_1 = sorted((sorted(roll), count) for roll, count in select_0_1)</span>
<span class="sd">        &gt;&gt;&gt; sorted_1_0 = sorted((sorted(roll), count) for roll, count in select_1_0)</span>
<span class="sd">        &gt;&gt;&gt; sorted_0_1 == sorted_1_0</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        They can also be summed and counted which is equivalent to calling the</span>
<span class="sd">        [``h`` method][dyce.p.P.h] with identical selection arguments.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; summed_0_1 = H((sum(roll), count) for roll, count in select_0_1)</span>
<span class="sd">        &gt;&gt;&gt; summed_1_0 = H((sum(roll), count) for roll, count in select_1_0)</span>
<span class="sd">        &gt;&gt;&gt; summed_0_1 == summed_1_0 == p_d3_d4.h(0, 1) == p_d3_d4.h(1, 0)</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">        !!! info &quot;About the implementation&quot;</span>

<span class="sd">            Enumeration is substantially more efficient for homogeneous pools than</span>
<span class="sd">            heterogeneous ones, because we are able to avoid the expensive enumeration</span>
<span class="sd">            of the Cartesian product using several techniques.</span>

<span class="sd">            Taking $k$ outcomes, where $k$ selects fewer than all $n$ outcomes a</span>
<span class="sd">            homogeneous pool benefits from [Ilmari Karonen’s</span>
<span class="sd">            optimization](https://rpg.stackexchange.com/a/166663/71245), which appears</span>
<span class="sd">            to scale geometrically with $k$ times some factor of $n$ (e.g., $\log n$,</span>
<span class="sd">            but I haven’t bothered to figure that out yet), such that—in observed</span>
<span class="sd">            testing, at least—it is generally the fastest approach for $k &lt; n$.</span>

<span class="sd">            Where $k = n$, we leverage the [*multinomial</span>
<span class="sd">            coefficient*](https://en.wikipedia.org/wiki/Permutation#Permutations_of_multisets),</span>
<span class="sd">            which appears to scale generally with $n$.</span>

<span class="sd">            $$</span>
<span class="sd">            {{n} \choose {{{k}_{1}},{{k}_{2}},\ldots,{{k}_{m}}}}</span>
<span class="sd">            = {\frac {{n}!} {{{k}_{1}}! {{k}_{2}}! \cdots {{k}_{m}}!}}</span>
<span class="sd">            $$</span>

<span class="sd">            We enumerate combinations with replacements, and then the compute the number</span>
<span class="sd">            of permutations with repetitions for each combination. Consider ``#!python</span>
<span class="sd">            n@P(H(m))``. Enumerating combinations with replacements would yield all</span>
<span class="sd">            unique rolls.</span>

<span class="sd">            ``#!python ((1, 1, …, 1), (1, 1, …, 2), …, (1, 1, …, m), …, (m - 1, m, …,</span>
<span class="sd">            m), (m, m, …, m))``</span>

<span class="sd">            To determine the count for a particular roll ``#!python (a, b, …, n)``, we</span>
<span class="sd">            compute the multinomial coefficient for that roll and multiply by the scalar</span>
<span class="sd">            ``#!python H(m)[a] * H(m)[b] * … * H(m)[n]``. (See</span>
<span class="sd">            [this](https://www.lucamoroni.it/the-dice-roll-sum-problem/) for an in-depth</span>
<span class="sd">            exploration of the topic.)</span>

<span class="sd">            Further, this implementation attempts to optimize heterogeneous pools by</span>
<span class="sd">            breaking them into homogeneous groups before computing the Cartesian product</span>
<span class="sd">            of those sub-results. This approach allows homogeneous pools to be ordered</span>
<span class="sd">            without duplicates, where heterogeneous ones offer no such guarantees.</span>

<span class="sd">            As expected, this optimization allows the performance of arbitrary selection</span>
<span class="sd">            from mixed pools to sit between that of purely homogeneous and purely</span>
<span class="sd">            heterogeneous ones. Note, however, that all three appear to scale</span>
<span class="sd">            geometrically in some way.</span>

<span class="sd">            ``` python</span>
<span class="sd">            --8&lt;-- &quot;docs/assets/perf_rolls_with_counts.txt&quot;</span>
<span class="sd">            ```</span>

<span class="sd">            &lt;details&gt;</span>
<span class="sd">            &lt;summary&gt;Source: &lt;a href=&quot;https://github.com/posita/dyce/blob/latest/docs/assets/perf_rolls_with_counts.ipy&quot;&gt;&lt;code&gt;perf_rolls_with_counts.ipy&lt;/code&gt;&lt;/a&gt;&lt;/summary&gt;</span>

<span class="sd">            ``` python</span>
<span class="sd">            --8&lt;-- &quot;docs/assets/perf_rolls_with_counts.ipy&quot;</span>
<span class="sd">            ```</span>
<span class="sd">            &lt;/details&gt;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">i</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">_analyze_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">rolls_with_counts_iter</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">groups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">))</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Based on cursory performance analysis, calling the homogeneous</span>
                <span class="c1"># implementation directly provides about a 15% performance savings over</span>
                <span class="c1"># merely falling through to _rwc_heterogeneous_h_groups. Maybe</span>
                <span class="c1"># itertools.product adds significant overhead?</span>
                <span class="n">h</span><span class="p">,</span> <span class="n">hn</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">assert</span> <span class="n">hn</span> <span class="o">==</span> <span class="n">n</span>

                <span class="c1"># Still in search of a better (i.e., more efficient) way:</span>
                <span class="c1"># &lt;https://math.stackexchange.com/questions/4173084/probability-distribution-of-k-1-k-2-cdots-k-m-selections-of-arbitrary-posi&gt;</span>
                <span class="k">if</span> <span class="n">i</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                    <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="n">_rwc_homogeneous_n_h_using_partial_selection</span><span class="p">(</span>
                        <span class="n">n</span><span class="p">,</span>
                        <span class="n">h</span><span class="p">,</span>
                        <span class="n">i</span><span class="p">,</span>
                        <span class="c1"># This is just padding to allow for consistent indexing. They</span>
                        <span class="c1"># are deselected (i.e., not returned) below.</span>
                        <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">_rwc_homogeneous_n_h_using_partial_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="n">_rwc_heterogeneous_h_groups</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">sorted_outcomes_for_roll</span><span class="p">,</span> <span class="n">roll_count</span> <span class="ow">in</span> <span class="n">rolls_with_counts_iter</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
                <span class="n">taken_outcomes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">getitems</span><span class="p">(</span><span class="n">sorted_outcomes_for_roll</span><span class="p">,</span> <span class="n">which</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">taken_outcomes</span> <span class="o">=</span> <span class="n">sorted_outcomes_for_roll</span>

            <span class="k">yield</span> <span class="n">taken_outcomes</span><span class="p">,</span> <span class="n">roll_count</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python P(*(h.map(op, right_operand) for h in self))``. See the</span>
<span class="sd">        [``H.map`` method][dyce.h.H.map].</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import operator</span>
<span class="sd">        &gt;&gt;&gt; p_3d6 = 3@P(H((-3, -1, 2, 4)))</span>
<span class="sd">        &gt;&gt;&gt; p_3d6.map(operator.__mul__, -1)</span>
<span class="sd">        3@P(H({-4: 1, -2: 1, 1: 1, 3: 1}))</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">rmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_operand</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python P(*(h.rmap(left_operand, op) for h in self))``. See the</span>
<span class="sd">        [``H.rmap`` method][dyce.h.H.rmap].</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import operator</span>
<span class="sd">        &gt;&gt;&gt; from fractions import Fraction</span>
<span class="sd">        &gt;&gt;&gt; p_3d6 = 2@P(H((-3, -1, 2, 4)))</span>
<span class="sd">        &gt;&gt;&gt; p_3d6.umap(Fraction).rmap(1, operator.__truediv__)</span>
<span class="sd">        2@P(H({Fraction(-1, 1): 1, Fraction(-1, 3): 1, Fraction(1, 4): 1, Fraction(1, 2): 1}))</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">left_operand</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>

    <span class="nd">@beartype</span>
    <span class="k">def</span> <span class="nf">umap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Shorthand for ``#!python P(*(h.umap(op) for h in self))``. See the</span>
<span class="sd">        [``H.umap`` method][dyce.h.H.umap].</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; import operator</span>
<span class="sd">        &gt;&gt;&gt; p_3d6 = 3@P(H((-3, -1, 2, 4)))</span>
<span class="sd">        &gt;&gt;&gt; p_3d6.umap(operator.__neg__)</span>
<span class="sd">        3@P(H({-4: 1, -2: 1, 1: 1, 3: 1}))</span>
<span class="sd">        &gt;&gt;&gt; p_3d6.umap(operator.__abs__)</span>
<span class="sd">        3@P(H({1: 1, 2: 1, 3: 1, 4: 1}))</span>

<span class="sd">        ```</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="dyce.p.P.__slots__" class="doc doc-heading">
<code class="highlight language-python"><span class="vm">__slots__</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;_hs&#39;</span><span class="p">,</span> <span class="s1">&#39;_total&#39;</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-class-attribute"><code>class-attribute</code></small>
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="dyce.p.P.total" class="doc doc-heading">
<code class="highlight language-python"><span class="n">total</span><span class="p">:</span> <span class="nb">int</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This method should be considered experimental and may change or disappear in
future versions.</p>
</div>
<p>Equivalent to <code class="highlight"><span class="n">prod</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">total</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span></code>. Note that—consistent
with the empty product—this is <code class="highlight"><span class="mi">1</span></code> for an empty pool.</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__eq__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__getitem__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__getitem__</span><span class="p">(</span><span class="n">key</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">P</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">]:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">[</span><span class="fm">__index__</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">H</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Initializer.</p>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">SupportsInt</span><span class="p">,</span> <span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="sa">r</span><span class="s2">&quot;Initializer.&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_gen_hs</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">H</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">a</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">a</span><span class="o">.</span><span class="n">_hs</span><span class="p">:</span>
                    <span class="k">yield</span> <span class="n">h</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">SupportsInt</span><span class="p">):</span>
                <span class="k">yield</span> <span class="n">H</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;unrecognized initializer type </span><span class="si">{</span><span class="n">a</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">hs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">h</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="n">_gen_hs</span><span class="p">()</span> <span class="k">if</span> <span class="n">h</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">hs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">()))</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="c1"># This is for outcomes that don&#39;t support direct comparisons, like symbolic</span>
        <span class="c1"># representations</span>
        <span class="n">hs</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">items</span><span class="p">())))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">hs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_total</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">total</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__iter__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__iter__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">H</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">H</span><span class="p">]:</span>
    <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__len__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__len__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">int</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__matmul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__matmul__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">P</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__matmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">as_int</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">if</span> <span class="n">other</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;argument cannot be negative&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__ne__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__ne__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
        <span class="k">return</span> <span class="fm">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">_hs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="n">group_counters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">)</span>
        <span class="n">group_counters</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">:</span> <span class="n">H</span><span class="p">,</span> <span class="n">n</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">h</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_counters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">h</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">group_counters</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">group_counters</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">group_counters</span><span class="p">[</span><span class="n">h</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_n_at</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">group_counters</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.__rmatmul__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__rmatmul__</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">P</span></code>

</h3>


  <div class="doc doc-contents ">

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="fm">__rmatmul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">SupportsInt</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__matmul__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.appearances_in_rolls" class="doc doc-heading">
<code class="highlight language-python"><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This method should be considered experimental and may change or disappear in
future versions. While it does provide a performance improvement over other
techniques, it is not significant for most applications, and rarely
justifies the corresponding reduction in readability.</p>
</div>
<p>Returns a histogram where the outcomes (keys) are the number of times <em>outcome</em>
appears, and the counts are the number of rolls where <em>outcome</em> appears
precisely that number of times. Equivalent to <code class="highlight"><span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">roll</span><span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="n">outcome</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span></code>, but
much more efficient.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">p_2d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Least efficient, by far</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d4_2d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">d4</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d6</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">roll</span> <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="mi">3</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">p_3d4_2d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">675</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">945</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">522</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Pretty darned efficient, generalizable to other boolean inquiries, and</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># arguably the most readable</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d4_eq3</span><span class="p">,</span> <span class="n">d6_eq3</span> <span class="o">=</span> <span class="n">d4</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">d6</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mi">3</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">2</span><span class="nd">@d6_eq3</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">675</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">945</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">522</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="c1"># Most efficient for large sets of dice</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d4_2d6</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">675</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">945</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">522</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">142</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>Based on some rudimentary testing, this method appears to converge on being
about twice as fast as the boolean accumulation technique for larger sets.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">%</span><span class="n">timeit</span> <span class="mi">3</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">2</span><span class="nd">@d6_eq3</span>
<span class="mi">30</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">111</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mf">64.7</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">570</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="mi">9</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">6</span><span class="nd">@d6_eq3</span>
<span class="mi">134</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">2.24</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">9</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">120</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">670</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="mi">27</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">18</span><span class="nd">@d6_eq3</span>
<span class="mi">803</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">2.62</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">27</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">18</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">426</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">1.8</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="mi">81</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">54</span><span class="nd">@d6_eq3</span>
<span class="mf">6.36</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">20</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">81</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">54</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="mf">2.61</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">5.41</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<details>
<summary>Source: <a href="https://github.com/posita/dyce/blob/latest/docs/assets/perf_appearances_in_rolls.ipy"><code>perf_appearances_in_rolls.ipy</code></a></summary>

<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">P</span>

<span class="n">p_2d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="n">d4</span><span class="p">,</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="n">p_3d4_2d6</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">d4</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d4</span><span class="p">,</span> <span class="n">d6</span><span class="p">,</span> <span class="n">d6</span><span class="p">)</span>
<span class="n">d4_eq3</span><span class="p">,</span> <span class="n">d6_eq3</span> <span class="o">=</span> <span class="n">d4</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">d6</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit 3@d4_eq3 + 2@d6_eq3&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="mi">3</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">2</span><span class="nd">@d6_eq3</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit P(3@P(4), 2@P(6)).appearances_in_rolls(3)&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit 9@d4_eq3 + 6@d6_eq3&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="mi">9</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">6</span><span class="nd">@d6_eq3</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit P(9@P(4), 6@P(6)).appearances_in_rolls(3)&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">9</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit 27@d4_eq3 + 18@d6_eq3&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="mi">27</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">18</span><span class="nd">@d6_eq3</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit P(27@P(4), 18@P(6)).appearances_in_rolls(3)&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">27</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">18</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit 81@d4_eq3 + 54@d6_eq3&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="mi">81</span><span class="nd">@d4_eq3</span> <span class="o">+</span> <span class="mi">54</span><span class="nd">@d6_eq3</span>
<span class="nb">print</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;%timeit P(81@P(4), 54@P(6)).appearances_in_rolls(3)&quot;</span><span class="p">)</span>
<span class="o">%</span><span class="n">timeit</span> <span class="n">P</span><span class="p">(</span><span class="mi">81</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">54</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">appearances_in_rolls</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@experimental</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">appearances_in_rolls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outcome</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Experimental&quot;</span>

<span class="sd">        This method should be considered experimental and may change or disappear in</span>
<span class="sd">        future versions. While it does provide a performance improvement over other</span>
<span class="sd">        techniques, it is not significant for most applications, and rarely</span>
<span class="sd">        justifies the corresponding reduction in readability.</span>

<span class="sd">    Returns a histogram where the outcomes (keys) are the number of times *outcome*</span>
<span class="sd">    appears, and the counts are the number of rolls where *outcome* appears</span>
<span class="sd">    precisely that number of times. Equivalent to ``#!python H((sum(1 for v in roll</span>
<span class="sd">    if v == outcome), count) for roll, count in self.rolls_with_counts())``, but</span>
<span class="sd">    much more efficient.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p_2d6 = P(6, 6)</span>
<span class="sd">    &gt;&gt;&gt; sorted(p_2d6.rolls_with_counts())</span>
<span class="sd">    [((1, 1), 1), ((1, 2), 2), ((1, 3), 2), ((1, 4), 2), ((1, 5), 2), ((1, 6), 2), ...]</span>
<span class="sd">    &gt;&gt;&gt; p_2d6.appearances_in_rolls(1)</span>
<span class="sd">    H({0: 25, 1: 10, 2: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; # Least efficient, by far</span>
<span class="sd">    &gt;&gt;&gt; d4, d6 = H(4), H(6)</span>
<span class="sd">    &gt;&gt;&gt; p_3d4_2d6 = P(d4, d4, d4, d6, d6)</span>
<span class="sd">    &gt;&gt;&gt; H((sum(1 for v in roll if v == 3), count) for roll, count in p_3d4_2d6.rolls_with_counts())</span>
<span class="sd">    H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; # Pretty darned efficient, generalizable to other boolean inquiries, and</span>
<span class="sd">    &gt;&gt;&gt; # arguably the most readable</span>
<span class="sd">    &gt;&gt;&gt; d4_eq3, d6_eq3 = d4.eq(3), d6.eq(3)</span>
<span class="sd">    &gt;&gt;&gt; 3@d4_eq3 + 2@d6_eq3</span>
<span class="sd">    H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; # Most efficient for large sets of dice</span>
<span class="sd">    &gt;&gt;&gt; p_3d4_2d6.appearances_in_rolls(3)</span>
<span class="sd">    H({0: 675, 1: 945, 2: 522, 3: 142, 4: 19, 5: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    Based on some rudimentary testing, this method appears to converge on being</span>
<span class="sd">    about twice as fast as the boolean accumulation technique for larger sets.</span>

<span class="sd">    ``` python</span>
<span class="sd">    --8&lt;-- &quot;docs/assets/perf_appearances_in_rolls.txt&quot;</span>
<span class="sd">    ```</span>

<span class="sd">    &lt;details&gt;</span>
<span class="sd">    &lt;summary&gt;Source: &lt;a href=&quot;https://github.com/posita/dyce/blob/latest/docs/assets/perf_appearances_in_rolls.ipy&quot;&gt;&lt;code&gt;perf_appearances_in_rolls.ipy&lt;/code&gt;&lt;/a&gt;&lt;/summary&gt;</span>

<span class="sd">    ``` python</span>
<span class="sd">    --8&lt;-- &quot;docs/assets/perf_appearances_in_rolls.ipy&quot;</span>
<span class="sd">    ```</span>
<span class="sd">    &lt;/details&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">group_counters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Counter</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">group_counter</span><span class="p">:</span> <span class="n">Counter</span><span class="p">[</span><span class="n">RealLike</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">exactly_k_times_in_n</span><span class="p">(</span><span class="n">outcome</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
                <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">group_counter</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="p">)</span>

        <span class="n">group_counters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_counter</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sum_h</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">group_counter</span><span class="p">)</span> <span class="k">for</span> <span class="n">group_counter</span> <span class="ow">in</span> <span class="n">group_counters</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.foreach" class="doc doc-heading">
<code class="highlight language-python"><span class="n">foreach</span><span class="p">(</span><span class="n">dependent_term</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]],</span> <span class="o">**</span><span class="n">independent_sources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">P</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">HableT</span><span class="p">,</span> <span class="n">_SourceT</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">H</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>This method has been deprecated and will be removed in a future release. See
the <a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.expandable"><code>expandable</code> decorator</a> and
<a class="autorefs autorefs-internal" href="../dyce.evaluation/#dyce.evaluation.foreach"><code>foreach</code> function</a> for more flexible
alternatives.</p>
</div>
<p>Calls <code class="highlight"><span class="n">dependent_term</span></code> for each unique set of rolls from the product
of <code>independent_sources</code> and accumulates the results. This is useful for
resolving dependent probabilities. Rolls are sorted least to greatest. Returned
histograms are always reduced to their lowest terms.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce.p</span> <span class="kn">import</span> <span class="n">RollT</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">three_way_vs</span><span class="p">(</span><span class="n">first</span><span class="p">:</span> <span class="n">RollT</span><span class="p">,</span> <span class="n">second</span><span class="p">:</span> <span class="n">RollT</span><span class="p">,</span> <span class="n">third</span><span class="p">:</span> <span class="n">RollT</span><span class="p">):</span>
<span class="o">...</span>   <span class="n">first_reversed</span> <span class="o">=</span> <span class="n">first</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>   <span class="n">second_reversed</span> <span class="o">=</span> <span class="n">second</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>   <span class="n">third_reversed</span> <span class="o">=</span> <span class="n">third</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="o">...</span>   <span class="k">if</span> <span class="n">first_reversed</span> <span class="o">&gt;</span> <span class="n">second_reversed</span> <span class="ow">and</span> <span class="n">first_reversed</span> <span class="o">&gt;</span> <span class="n">third_reversed</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># first is the clear winner</span>
<span class="o">...</span>   <span class="k">elif</span> <span class="n">second_reversed</span> <span class="o">&gt;</span> <span class="n">first_reversed</span> <span class="ow">and</span> <span class="n">second_reversed</span> <span class="o">&gt;</span> <span class="n">third_reversed</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">2</span>  <span class="c1"># second is the clear winner</span>
<span class="o">...</span>   <span class="k">elif</span> <span class="n">third_reversed</span> <span class="o">&gt;</span> <span class="n">first_reversed</span> <span class="ow">and</span> <span class="n">third_reversed</span> <span class="o">&gt;</span> <span class="n">second_reversed</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">3</span>  <span class="c1"># third is the clear winner</span>
<span class="o">...</span>   <span class="k">else</span><span class="p">:</span>
<span class="o">...</span>     <span class="k">return</span> <span class="mi">0</span>  <span class="c1"># there was a tie somewhere</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span>
<span class="o">...</span>   <span class="n">three_way_vs</span><span class="p">,</span>
<span class="o">...</span>   <span class="n">first</span><span class="o">=</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>  <span class="c1"># first has pool of two d6s</span>
<span class="o">...</span>   <span class="n">second</span><span class="o">=</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span>  <span class="c1"># second has pool of two d6s</span>
<span class="o">...</span>   <span class="n">third</span><span class="o">=</span><span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>  <span class="c1"># third has pool of one d4 and one d8</span>
<span class="o">...</span> <span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1103</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5783</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">5783</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">8067</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>When all of <code class="highlight"><span class="n">foreach</span></code>’s arguments are <a class="autorefs autorefs-internal" href="#dyce.p.P"><code>P</code> objects</a> of
size 1 or anything other than a <code>P</code> object, this function behaves similarly to
<a class="autorefs autorefs-internal" href="#dyce.h.H"><code>H.foreach</code></a> (although the signature of the <em>dependent_term</em>
callback function differs slightly between the two interfaces).</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span>
<span class="o">...</span>   <span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">kw</span><span class="o">.</span><span class="n">values</span><span class="p">())),</span>  <span class="c1"># receives single-element rolls</span>
<span class="o">...</span>   <span class="n">src1</span><span class="o">=</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>  <span class="c1"># pool of size 1</span>
<span class="o">...</span>   <span class="n">src2</span><span class="o">=</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>  <span class="c1"># histogram</span>
<span class="o">...</span>   <span class="n">src3</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span>  <span class="c1"># histogram source</span>
<span class="o">...</span> <span class="p">)</span> <span class="o">==</span> <span class="n">H</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span>
<span class="o">...</span>   <span class="k">lambda</span> <span class="o">**</span><span class="n">kw</span><span class="p">:</span> <span class="nb">sum</span><span class="p">(</span><span class="n">kw</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span>  <span class="c1"># receives outcomes</span>
<span class="o">...</span>   <span class="n">src1</span><span class="o">=</span><span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">h</span><span class="p">(),</span>  <span class="c1"># histogram</span>
<span class="o">...</span>   <span class="n">src2</span><span class="o">=</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>  <span class="c1"># histogram</span>
<span class="o">...</span>   <span class="n">src3</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">},</span>  <span class="c1"># histogram source</span>
<span class="o">...</span> <span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>The <code class="highlight"><span class="n">foreach</span></code> class method is equivalent to nesting loops iterating
over <a class="autorefs autorefs-internal" href="#dyce.p.P.rolls_with_counts"><code>P.rolls_with_counts</code></a> for each independent
term and then aggregating the results.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">dependent_term</span><span class="p">(</span>
<span class="o">...</span>   <span class="o">*</span><span class="p">,</span>
<span class="o">...</span>   <span class="n">roll_1</span><span class="p">,</span>
<span class="o">...</span>   <span class="n">roll_2</span><span class="p">,</span>
<span class="o">...</span>   <span class="c1"># ...</span>
<span class="o">...</span>   <span class="n">roll_n</span><span class="p">,</span>
<span class="o">...</span> <span class="p">):</span>
<span class="o">...</span>   <span class="k">return</span> <span class="p">(</span>
<span class="o">...</span>     <span class="p">(</span><span class="n">roll_2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">roll_1</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="o">...</span>     <span class="o">+</span> <span class="p">(</span><span class="n">roll_n</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">roll_2</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="o">...</span>     <span class="c1"># ...</span>
<span class="o">...</span>   <span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">source_1</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">source_2</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># ...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">source_n</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">h</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">foreach</span><span class="p">(</span>
<span class="o">...</span>   <span class="n">dependent_term</span><span class="p">,</span>
<span class="o">...</span>   <span class="n">roll_1</span><span class="o">=</span><span class="n">source_1</span><span class="p">,</span>
<span class="o">...</span>   <span class="n">roll_2</span><span class="o">=</span><span class="n">source_2</span><span class="p">,</span>
<span class="o">...</span>   <span class="c1"># ...</span>
<span class="o">...</span>   <span class="n">roll_n</span><span class="o">=</span><span class="n">source_n</span><span class="p">,</span>
<span class="o">...</span> <span class="p">)</span> <span class="p">;</span> <span class="n">h</span>
<span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">3821</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">5126</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">269</span><span class="p">})</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">resolve</span><span class="p">():</span>
<span class="o">...</span>   <span class="k">for</span> <span class="n">roll_1</span><span class="p">,</span> <span class="n">count_1</span> <span class="ow">in</span> <span class="n">source_1</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">():</span>
<span class="o">...</span>     <span class="k">for</span> <span class="n">roll_2</span><span class="p">,</span> <span class="n">count_2</span> <span class="ow">in</span> <span class="n">source_2</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">():</span>
<span class="o">...</span>       <span class="c1"># ...</span>
<span class="o">...</span>       <span class="k">for</span> <span class="n">roll_n</span><span class="p">,</span> <span class="n">count_n</span> <span class="ow">in</span> <span class="n">source_n</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">():</span>
<span class="o">...</span>         <span class="c1"># ...</span>
<span class="o">...</span>           <span class="k">yield</span> <span class="n">dependent_term</span><span class="p">(</span>
<span class="o">...</span>             <span class="n">roll_1</span><span class="o">=</span><span class="n">roll_1</span><span class="p">,</span>
<span class="o">...</span>             <span class="n">roll_2</span><span class="o">=</span><span class="n">roll_2</span><span class="p">,</span>
<span class="o">...</span>             <span class="c1"># ...</span>
<span class="o">...</span>             <span class="n">roll_n</span><span class="o">=</span><span class="n">roll_n</span><span class="p">,</span>
<span class="o">...</span>         <span class="p">),</span> <span class="p">(</span>
<span class="o">...</span>           <span class="n">count_1</span>
<span class="o">...</span>           <span class="o">*</span> <span class="n">count_2</span>
<span class="o">...</span>           <span class="c1"># * ...</span>
<span class="o">...</span>           <span class="o">*</span> <span class="n">count_n</span>
<span class="o">...</span>         <span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">dyce.evaluation</span> <span class="kn">import</span> <span class="n">aggregate_weighted</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">aggregate_weighted</span><span class="p">(</span><span class="n">resolve</span><span class="p">())</span> <span class="o">==</span> <span class="n">h</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="nd">@deprecated</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">foreach</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">dependent_term</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">]],</span>
    <span class="c1"># TODO(posita): See &lt;https://github.com/beartype/beartype/issues/152&gt;</span>
    <span class="o">**</span><span class="n">independent_sources</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s2">&quot;P&quot;</span><span class="p">,</span> <span class="n">H</span><span class="p">,</span> <span class="n">HableT</span><span class="p">,</span> <span class="n">_SourceT</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Deprecated&quot;</span>

<span class="sd">        This method has been deprecated and will be removed in a future release. See</span>
<span class="sd">        the [``expandable`` decorator][dyce.evaluation.expandable] and</span>
<span class="sd">        [``foreach`` function][dyce.evaluation.foreach] for more flexible</span>
<span class="sd">        alternatives.</span>

<span class="sd">    Calls ``#!python dependent_term`` for each unique set of rolls from the product</span>
<span class="sd">    of ``independent_sources`` and accumulates the results. This is useful for</span>
<span class="sd">    resolving dependent probabilities. Rolls are sorted least to greatest. Returned</span>
<span class="sd">    histograms are always reduced to their lowest terms.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from dyce.p import RollT</span>

<span class="sd">    &gt;&gt;&gt; def three_way_vs(first: RollT, second: RollT, third: RollT):</span>
<span class="sd">    ...   first_reversed = first[::-1]</span>
<span class="sd">    ...   second_reversed = second[::-1]</span>
<span class="sd">    ...   third_reversed = third[::-1]</span>
<span class="sd">    ...   if first_reversed &gt; second_reversed and first_reversed &gt; third_reversed:</span>
<span class="sd">    ...     return 1  # first is the clear winner</span>
<span class="sd">    ...   elif second_reversed &gt; first_reversed and second_reversed &gt; third_reversed:</span>
<span class="sd">    ...     return 2  # second is the clear winner</span>
<span class="sd">    ...   elif third_reversed &gt; first_reversed and third_reversed &gt; second_reversed:</span>
<span class="sd">    ...     return 3  # third is the clear winner</span>
<span class="sd">    ...   else:</span>
<span class="sd">    ...     return 0  # there was a tie somewhere</span>

<span class="sd">    &gt;&gt;&gt; P.foreach(</span>
<span class="sd">    ...   three_way_vs,</span>
<span class="sd">    ...   first=P(6, 6),  # first has pool of two d6s</span>
<span class="sd">    ...   second=P(6, 6),  # second has pool of two d6s</span>
<span class="sd">    ...   third=P(4, 8),  # third has pool of one d4 and one d8</span>
<span class="sd">    ... )</span>
<span class="sd">    H({0: 1103, 1: 5783, 2: 5783, 3: 8067})</span>

<span class="sd">    ```</span>

<span class="sd">    When all of ``#!python foreach``’s arguments are [``P`` objects][dyce.p.P] of</span>
<span class="sd">    size 1 or anything other than a ``P`` object, this function behaves similarly to</span>
<span class="sd">    [``H.foreach``][dyce.h.H] (although the signature of the *dependent_term*</span>
<span class="sd">    callback function differs slightly between the two interfaces).</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from itertools import chain</span>
<span class="sd">    &gt;&gt;&gt; P.foreach(</span>
<span class="sd">    ...   lambda **kw: sum(chain(*kw.values())),  # receives single-element rolls</span>
<span class="sd">    ...   src1=P(6),  # pool of size 1</span>
<span class="sd">    ...   src2=H(6),  # histogram</span>
<span class="sd">    ...   src3=range(6, 0, -1),  # histogram source</span>
<span class="sd">    ... ) == H.foreach(</span>
<span class="sd">    ...   lambda **kw: sum(kw.values()),  # receives outcomes</span>
<span class="sd">    ...   src1=P(6).h(),  # histogram</span>
<span class="sd">    ...   src2=H(6),  # histogram</span>
<span class="sd">    ...   src3={1, 2, 3, 4, 5, 6},  # histogram source</span>
<span class="sd">    ... )</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    The ``#!python foreach`` class method is equivalent to nesting loops iterating</span>
<span class="sd">    over [``P.rolls_with_counts``][dyce.p.P.rolls_with_counts] for each independent</span>
<span class="sd">    term and then aggregating the results.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; def dependent_term(</span>
<span class="sd">    ...   *,</span>
<span class="sd">    ...   roll_1,</span>
<span class="sd">    ...   roll_2,</span>
<span class="sd">    ...   # ...</span>
<span class="sd">    ...   roll_n,</span>
<span class="sd">    ... ):</span>
<span class="sd">    ...   return (</span>
<span class="sd">    ...     (roll_2[-1] &gt; roll_1[-1])</span>
<span class="sd">    ...     + (roll_n[-1] &gt; roll_2[-1])</span>
<span class="sd">    ...     # ...</span>
<span class="sd">    ...   )</span>

<span class="sd">    &gt;&gt;&gt; source_1 = P(8)</span>
<span class="sd">    &gt;&gt;&gt; source_2 = P(6, 6)</span>
<span class="sd">    &gt;&gt;&gt; # ...</span>
<span class="sd">    &gt;&gt;&gt; source_n = P(4, 4, 4)</span>

<span class="sd">    &gt;&gt;&gt; h = P.foreach(</span>
<span class="sd">    ...   dependent_term,</span>
<span class="sd">    ...   roll_1=source_1,</span>
<span class="sd">    ...   roll_2=source_2,</span>
<span class="sd">    ...   # ...</span>
<span class="sd">    ...   roll_n=source_n,</span>
<span class="sd">    ... ) ; h</span>
<span class="sd">    H({0: 3821, 1: 5126, 2: 269})</span>

<span class="sd">    &gt;&gt;&gt; def resolve():</span>
<span class="sd">    ...   for roll_1, count_1 in source_1.rolls_with_counts():</span>
<span class="sd">    ...     for roll_2, count_2 in source_2.rolls_with_counts():</span>
<span class="sd">    ...       # ...</span>
<span class="sd">    ...       for roll_n, count_n in source_n.rolls_with_counts():</span>
<span class="sd">    ...         # ...</span>
<span class="sd">    ...           yield dependent_term(</span>
<span class="sd">    ...             roll_1=roll_1,</span>
<span class="sd">    ...             roll_2=roll_2,</span>
<span class="sd">    ...             # ...</span>
<span class="sd">    ...             roll_n=roll_n,</span>
<span class="sd">    ...         ), (</span>
<span class="sd">    ...           count_1</span>
<span class="sd">    ...           * count_2</span>
<span class="sd">    ...           # * ...</span>
<span class="sd">    ...           * count_n</span>
<span class="sd">    ...         )</span>

<span class="sd">    &gt;&gt;&gt; from dyce.evaluation import aggregate_weighted</span>
<span class="sd">    &gt;&gt;&gt; aggregate_weighted(resolve()) == h</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">dyce.evaluation</span> <span class="kn">import</span> <span class="n">aggregate_weighted</span>

    <span class="n">pools_by_kw</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">P</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">source_name</span><span class="p">,</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">independent_sources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">H</span><span class="p">):</span>
            <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">P</span><span class="p">):</span>
            <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">source</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">HableT</span><span class="p">):</span>
            <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">source</span><span class="o">.</span><span class="n">h</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">source_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">source</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_kw_roll_count_tuples</span><span class="p">(</span>
        <span class="n">pool_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">RollT</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
        <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">pools_by_kw</span><span class="p">[</span><span class="n">pool_name</span><span class="p">]</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">():</span>
            <span class="k">yield</span> <span class="n">pool_name</span><span class="p">,</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span>

    <span class="k">def</span> <span class="nf">_resolve_dependent_term_for_rolls</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="p">(</span>
        <span class="n">Iterator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">H</span><span class="p">,</span> <span class="n">RealLike</span><span class="p">],</span> <span class="nb">int</span><span class="p">]]</span>
    <span class="p">):</span>
        <span class="k">for</span> <span class="n">kw_roll_count_tuples</span> <span class="ow">in</span> <span class="n">product</span><span class="p">(</span>
            <span class="o">*</span><span class="p">(</span><span class="n">_kw_roll_count_tuples</span><span class="p">(</span><span class="n">pool_name</span><span class="p">)</span> <span class="k">for</span> <span class="n">pool_name</span> <span class="ow">in</span> <span class="n">pools_by_kw</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="n">combined_count</span> <span class="o">=</span> <span class="n">prod</span><span class="p">(</span><span class="n">count</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">kw_roll_count_tuples</span><span class="p">)</span>
            <span class="n">rolls_by_name</span> <span class="o">=</span> <span class="p">{</span><span class="n">name</span><span class="p">:</span> <span class="n">roll</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">roll</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">kw_roll_count_tuples</span><span class="p">}</span>
            <span class="k">yield</span> <span class="n">dependent_term</span><span class="p">(</span><span class="o">**</span><span class="n">rolls_by_name</span><span class="p">),</span> <span class="n">combined_count</span>

    <span class="k">return</span> <span class="n">aggregate_weighted</span><span class="p">(</span><span class="n">_resolve_dependent_term_for_rolls</span><span class="p">())</span><span class="o">.</span><span class="n">lowest_terms</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.h" class="doc doc-heading">
<code class="highlight language-python"><span class="n">h</span><span class="p">(</span><span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Roughly equivalent to <code class="highlight"><span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span><span class="bp">self</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="n">which</span><span class="p">))</span></code> with some short-circuit optimizations.</p>
<p>When provided no arguments, <code class="highlight"><span class="n">h</span></code> combines (or “flattens”) contained
histograms in accordance with the <a class="autorefs autorefs-internal" href="../dyce.h/#dyce.h.HableT"><code>HableT</code> protocol</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">.</span><span class="n">h</span><span class="p">()</span>
<span class="n">H</span><span class="p">({</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
</code></pre></div></td></tr></table></div>
<p>If one or more arguments are provided, this method sums subsets of outcomes
those arguments identify for each roll. Outcomes are ordered from least (index
<code class="highlight"><span class="mi">0</span></code>) to greatest (index <code class="highlight"><span class="o">-</span><span class="mi">1</span></code> or <code class="highlight"><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span></code>). Identifiers can be <code class="highlight"><span class="nb">int</span></code>s or <code class="highlight"><span class="nb">slice</span></code>s, and can be
mixed.</p>
<p>Taking the greatest of two six-sided dice can be modeled as:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_2d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">11</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p_2d6</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">())</span>
<span class="n">avg</span> <span class="o">|</span>    <span class="mf">4.47</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">1.40</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">1.97</span>
  <span class="mi">1</span> <span class="o">|</span>   <span class="mf">2.78</span><span class="o">%</span> <span class="o">|</span><span class="c1">#</span>
  <span class="mi">2</span> <span class="o">|</span>   <span class="mf">8.33</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">3</span> <span class="o">|</span>  <span class="mf">13.89</span><span class="o">%</span> <span class="o">|</span><span class="c1">######</span>
  <span class="mi">4</span> <span class="o">|</span>  <span class="mf">19.44</span><span class="o">%</span> <span class="o">|</span><span class="c1">#########</span>
  <span class="mi">5</span> <span class="o">|</span>  <span class="mf">25.00</span><span class="o">%</span> <span class="o">|</span><span class="c1">############</span>
  <span class="mi">6</span> <span class="o">|</span>  <span class="mf">30.56</span><span class="o">%</span> <span class="o">|</span><span class="c1">###############</span>
</code></pre></div></td></tr></table></div>
<p>Taking the greatest two and least two faces of ten four-sided dice (<code>10d4</code>)
can be modeled as:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_10d4</span> <span class="o">=</span> <span class="mi">10</span><span class="nd">@P</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_10d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="n">H</span><span class="p">({</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1012</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">5030</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="mi">51973</span><span class="p">,</span> <span class="mi">9</span><span class="p">:</span> <span class="mi">168760</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span> <span class="mi">595004</span><span class="p">,</span> <span class="mi">11</span><span class="p">:</span> <span class="mi">168760</span><span class="p">,</span> <span class="mi">12</span><span class="p">:</span> <span class="mi">51973</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">5030</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">1012</span><span class="p">,</span> <span class="mi">15</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">p_10d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">scaled</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">avg</span> <span class="o">|</span>   <span class="mf">10.00</span>
<span class="n">std</span> <span class="o">|</span>    <span class="mf">0.91</span>
<span class="n">var</span> <span class="o">|</span>    <span class="mf">0.84</span>
  <span class="mi">4</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">5</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">6</span> <span class="o">|</span>   <span class="mf">0.10</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">7</span> <span class="o">|</span>   <span class="mf">0.48</span><span class="o">%</span> <span class="o">|</span>
  <span class="mi">8</span> <span class="o">|</span>   <span class="mf">4.96</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
  <span class="mi">9</span> <span class="o">|</span>  <span class="mf">16.09</span><span class="o">%</span> <span class="o">|</span><span class="c1">##############</span>
 <span class="mi">10</span> <span class="o">|</span>  <span class="mf">56.74</span><span class="o">%</span> <span class="o">|</span><span class="c1">##################################################</span>
 <span class="mi">11</span> <span class="o">|</span>  <span class="mf">16.09</span><span class="o">%</span> <span class="o">|</span><span class="c1">##############</span>
 <span class="mi">12</span> <span class="o">|</span>   <span class="mf">4.96</span><span class="o">%</span> <span class="o">|</span><span class="c1">####</span>
 <span class="mi">13</span> <span class="o">|</span>   <span class="mf">0.48</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">14</span> <span class="o">|</span>   <span class="mf">0.10</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">15</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
 <span class="mi">16</span> <span class="o">|</span>   <span class="mf">0.00</span><span class="o">%</span> <span class="o">|</span>
</code></pre></div></td></tr></table></div>
<p>Taking all outcomes exactly once is equivalent to summing the histograms in the
pool.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6avg</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">d6</span><span class="p">,</span> <span class="n">d6avg</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6avg</span> <span class="o">+</span> <span class="n">d6avg</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">H</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Roughly equivalent to ``#!python H((sum(roll), count) for roll, count in</span>
<span class="sd">    self.rolls_with_counts(*which))`` with some short-circuit optimizations.</span>

<span class="sd">    When provided no arguments, ``#!python h`` combines (or “flattens”) contained</span>
<span class="sd">    histograms in accordance with the [``HableT`` protocol][dyce.h.HableT].</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; (2@P(6)).h()</span>
<span class="sd">    H({2: 1, 3: 2, 4: 3, 5: 4, 6: 5, 7: 6, 8: 5, 9: 4, 10: 3, 11: 2, 12: 1})</span>

<span class="sd">    ```</span>

<span class="sd">    If one or more arguments are provided, this method sums subsets of outcomes</span>
<span class="sd">    those arguments identify for each roll. Outcomes are ordered from least (index</span>
<span class="sd">    ``#!python 0``) to greatest (index ``#!python -1`` or ``#!python len(self) -</span>
<span class="sd">    1``). Identifiers can be ``#!python int``s or ``#!python slice``s, and can be</span>
<span class="sd">    mixed.</span>

<span class="sd">    Taking the greatest of two six-sided dice can be modeled as:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p_2d6 = 2@P(6)</span>
<span class="sd">    &gt;&gt;&gt; p_2d6.h(-1)</span>
<span class="sd">    H({1: 1, 2: 3, 3: 5, 4: 7, 5: 9, 6: 11})</span>
<span class="sd">    &gt;&gt;&gt; print(p_2d6.h(-1).format())</span>
<span class="sd">    avg |    4.47</span>
<span class="sd">    std |    1.40</span>
<span class="sd">    var |    1.97</span>
<span class="sd">      1 |   2.78% |#</span>
<span class="sd">      2 |   8.33% |####</span>
<span class="sd">      3 |  13.89% |######</span>
<span class="sd">      4 |  19.44% |#########</span>
<span class="sd">      5 |  25.00% |############</span>
<span class="sd">      6 |  30.56% |###############</span>

<span class="sd">    ```</span>

<span class="sd">    Taking the greatest two and least two faces of ten four-sided dice (``10d4``)</span>
<span class="sd">    can be modeled as:</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p_10d4 = 10@P(4)</span>
<span class="sd">    &gt;&gt;&gt; p_10d4.h(slice(2), slice(-2, None))</span>
<span class="sd">    H({4: 1, 5: 10, 6: 1012, 7: 5030, 8: 51973, 9: 168760, 10: 595004, 11: 168760, 12: 51973, 13: 5030, 14: 1012, 15: 10, 16: 1})</span>
<span class="sd">    &gt;&gt;&gt; print(p_10d4.h(slice(2), slice(-2, None)).format(scaled=True))</span>
<span class="sd">    avg |   10.00</span>
<span class="sd">    std |    0.91</span>
<span class="sd">    var |    0.84</span>
<span class="sd">      4 |   0.00% |</span>
<span class="sd">      5 |   0.00% |</span>
<span class="sd">      6 |   0.10% |</span>
<span class="sd">      7 |   0.48% |</span>
<span class="sd">      8 |   4.96% |####</span>
<span class="sd">      9 |  16.09% |##############</span>
<span class="sd">     10 |  56.74% |##################################################</span>
<span class="sd">     11 |  16.09% |##############</span>
<span class="sd">     12 |   4.96% |####</span>
<span class="sd">     13 |   0.48% |</span>
<span class="sd">     14 |   0.10% |</span>
<span class="sd">     15 |   0.00% |</span>
<span class="sd">     16 |   0.00% |</span>

<span class="sd">    ```</span>

<span class="sd">    Taking all outcomes exactly once is equivalent to summing the histograms in the</span>
<span class="sd">    pool.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">    &gt;&gt;&gt; d6avg = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">    &gt;&gt;&gt; p = 2@P(d6, d6avg)</span>
<span class="sd">    &gt;&gt;&gt; p.h(slice(None)) == p.h() == d6 + d6 + d6avg + d6avg</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_analyze_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">i</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="n">n</span><span class="p">:</span>
            <span class="c1"># The caller selected all dice in the pool exactly i // n times, so we</span>
            <span class="c1"># can short-circuit roll enumeration</span>
            <span class="k">assert</span> <span class="n">i</span> <span class="o">%</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">//</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">H</span><span class="p">(</span>
                <span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="n">which</span><span class="p">)</span>
            <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># The caller offered no selection</span>
        <span class="k">return</span> <span class="n">sum_h</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.is_homogeneous" class="doc doc-heading">
<code class="highlight language-python"><span class="n">is_homogeneous</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">bool</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <div class="admonition warning">
<p class="admonition-title">Experimental</p>
<p>This property should be considered experimental and may change or disappear
in future versions.</p>
</div>
<p>Returns whether the pool’s population of histograms is homogeneous.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">()</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">P</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">is_homogeneous</span><span class="p">()</span>
<span class="kc">False</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@experimental</span>
<span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">is_homogeneous</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    !!! warning &quot;Experimental&quot;</span>

<span class="sd">        This property should be considered experimental and may change or disappear</span>
<span class="sd">        in future versions.</span>

<span class="sd">    Returns whether the pool’s population of histograms is homogeneous.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; P(6, 6).is_homogeneous()</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; P(4, 6, 8).is_homogeneous()</span>
<span class="sd">    False</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_hs</span><span class="p">))</span> <span class="o">&lt;=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.map" class="doc doc-heading">
<code class="highlight language-python"><span class="nb">map</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">P</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span></code>. See the
<a class="autorefs autorefs-internal" href="#dyce.h.H.map"><code>H.map</code> method</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span> <span class="o">=</span> <span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__mul__</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">:</span> <span class="n">_OperandT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python P(*(h.map(op, right_operand) for h in self))``. See the</span>
<span class="sd">    [``H.map`` method][dyce.h.H.map].</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; p_3d6 = 3@P(H((-3, -1, 2, 4)))</span>
<span class="sd">    &gt;&gt;&gt; p_3d6.map(operator.__mul__, -1)</span>
<span class="sd">    3@P(H({-4: 1, -2: 1, 1: 1, 3: 1}))</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">right_operand</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.rmap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rmap</span><span class="p">(</span><span class="n">left_operand</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">P</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">left_operand</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span></code>. See the
<a class="autorefs autorefs-internal" href="#dyce.h.H.rmap"><code>H.rmap</code> method</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">fractions</span> <span class="kn">import</span> <span class="n">Fraction</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">Fraction</span><span class="p">)</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="fm">__truediv__</span><span class="p">)</span>
<span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="n">Fraction</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Fraction</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">1</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">rmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">left_operand</span><span class="p">:</span> <span class="n">RealLike</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">_BinaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python P(*(h.rmap(left_operand, op) for h in self))``. See the</span>
<span class="sd">    [``H.rmap`` method][dyce.h.H.rmap].</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; from fractions import Fraction</span>
<span class="sd">    &gt;&gt;&gt; p_3d6 = 2@P(H((-3, -1, 2, 4)))</span>
<span class="sd">    &gt;&gt;&gt; p_3d6.umap(Fraction).rmap(1, operator.__truediv__)</span>
<span class="sd">    2@P(H({Fraction(-1, 1): 1, Fraction(-1, 3): 1, Fraction(1, 4): 1, Fraction(1, 2): 1}))</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">rmap</span><span class="p">(</span><span class="n">left_operand</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.roll" class="doc doc-heading">
<code class="highlight language-python"><span class="n">roll</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">RollT</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns (weighted) random outcomes from contained histograms.</p>
<div class="admonition note">
<p class="admonition-title">On ordering</p>
<p>This method “works” (i.e., falls back to a “natural” ordering of string
representations) for outcomes whose relative values cannot be known (e.g.,
symbolic expressions). This is deliberate to allow random roll functionality
where symbolic resolution is not needed or will happen later.</p>
</div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">roll</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">RollT</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns (weighted) random outcomes from contained histograms.</span>

<span class="sd">    !!! note &quot;On ordering&quot;</span>

<span class="sd">        This method “works” (i.e., falls back to a “natural” ordering of string</span>
<span class="sd">        representations) for outcomes whose relative values cannot be known (e.g.,</span>
<span class="sd">        symbolic expressions). This is deliberate to allow random roll functionality</span>
<span class="sd">        where symbolic resolution is not needed or will happen later.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">sorted_outcomes</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">roll</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.rolls_with_counts" class="doc doc-heading">
<code class="highlight language-python"><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns an iterator yielding two-tuples (pairs) that, collectively, enumerate all
possible outcomes for the pool. The first item in the two-tuple is a sorted
sequence of the outcomes for a distinct roll. The second is the count for that
roll. Outcomes in each roll are ordered least to greatest.</p>
<p>If one or more arguments are provided, this methods selects subsets of outcomes
for each roll. Outcomes in each roll are ordered from least (index <code class="highlight"><span class="mi">0</span></code>) to greatest (index <code class="highlight"><span class="o">-</span><span class="mi">1</span></code> or <code class="highlight"><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span></code>).
Identifiers can be <code class="highlight"><span class="nb">int</span></code>s or <code class="highlight"><span class="nb">slice</span></code>s, and can be mixed
for more flexible selections.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="o">&gt;&gt;&gt;</span> <span class="k">def</span> <span class="nf">accumulate_roll_counts</span><span class="p">(</span><span class="n">counter</span><span class="p">,</span> <span class="n">roll_counts</span><span class="p">):</span>
<span class="o">...</span>   <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">roll_counts</span><span class="p">:</span>
<span class="o">...</span>     <span class="n">counter</span><span class="p">[</span><span class="n">roll</span><span class="p">]</span> <span class="o">+=</span> <span class="n">count</span>
<span class="o">...</span>   <span class="k">return</span> <span class="n">counter</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">p_6d6</span> <span class="o">=</span> <span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">every_other_d6</span> <span class="o">=</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)))</span> <span class="p">;</span> <span class="n">every_other_d6</span>
<span class="n">Counter</span><span class="p">({(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">4110</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">3390</span><span class="p">,</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">3330</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="mi">13</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="mi">7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> <span class="mi">1</span><span class="p">})</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">accumulate_roll_counts</span><span class="p">(</span><span class="n">Counter</span><span class="p">(),</span> <span class="n">p_6d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">==</span> <span class="n">every_other_d6</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>One way to model the likelihood of achieving a “Yhatzee” (i.e., where five
six-sided dice show the same face) on a single roll by checking rolls for where
the least and greatest outcomes are the same.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_5d6</span> <span class="o">=</span> <span class="mi">5</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">yhatzee_on_single_roll</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span>
<span class="o">...</span>   <span class="p">(</span><span class="mi">1</span> <span class="k">if</span> <span class="n">roll</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">roll</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
<span class="o">...</span>   <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span>
<span class="o">...</span>   <span class="ow">in</span> <span class="n">p_5d6</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">()</span>
<span class="o">...</span> <span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">yhatzee_on_single_roll</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
<span class="p">{</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mf">99.92</span><span class="o">%</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span>  <span class="mf">0.08</span><span class="o">%</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition note">
<p class="admonition-title">In the general case, rolls may appear more than once.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<p>In the above, <code class="highlight"><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span></code> appears a total of two times, each with
counts of one.</p>
<p>However, if the pool is homogeneous (meaning it only contains identical
histograms), rolls (before selection) are not repeated. (See the note on
implementation below.)</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">((</span><span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))))</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span>
<span class="p">[((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<p>Either way, by summing and counting all rolls, we can confirm identity.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">d6</span> <span class="o">=</span> <span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">d6avg</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p</span> <span class="o">=</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">d6</span><span class="p">,</span> <span class="n">d6avg</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">p</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">())</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">()</span> <span class="o">==</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6</span> <span class="o">+</span> <span class="n">d6avg</span> <span class="o">+</span> <span class="n">d6avg</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
</div>
<p>This method does not try to outsmart callers by (mis)interpreting selection
arguments. It honors selection identifier order and any redundancy.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">p_d3_d4</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">H</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># Select the second, first, then second (again) elements</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">p_d3_d4</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="p">[((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="o">...</span><span class="p">,</span> <span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="mi">1</span><span class="p">)]</span>
</code></pre></div></td></tr></table></div>
<p>Selecting the same outcomes, but in a different order is not immediately
comparable.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">select_0_1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">p_d3_d4</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">select_1_0</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">p_d3_d4</span><span class="o">.</span><span class="n">rolls_with_counts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">select_0_1</span> <span class="o">==</span> <span class="n">select_1_0</span>
<span class="kc">False</span>
</code></pre></div></td></tr></table></div>
<p>Equivalence can be tested when selected outcomes are sorted.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">sorted_0_1</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="nb">sorted</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_0_1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sorted_1_0</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">((</span><span class="nb">sorted</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_1_0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sorted_0_1</span> <span class="o">==</span> <span class="n">sorted_1_0</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<p>They can also be summed and counted which is equivalent to calling the
<a class="autorefs autorefs-internal" href="#dyce.p.P.h"><code>h</code> method</a> with identical selection arguments.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="n">summed_0_1</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_0_1</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">summed_1_0</span> <span class="o">=</span> <span class="n">H</span><span class="p">((</span><span class="nb">sum</span><span class="p">(</span><span class="n">roll</span><span class="p">),</span> <span class="n">count</span><span class="p">)</span> <span class="k">for</span> <span class="n">roll</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">select_1_0</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">summed_0_1</span> <span class="o">==</span> <span class="n">summed_1_0</span> <span class="o">==</span> <span class="n">p_d3_d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">p_d3_d4</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="kc">True</span>
</code></pre></div></td></tr></table></div>
<div class="admonition info">
<p class="admonition-title">About the implementation</p>
<p>Enumeration is substantially more efficient for homogeneous pools than
heterogeneous ones, because we are able to avoid the expensive enumeration
of the Cartesian product using several techniques.</p>
<p>Taking <span class="arithmatex">\(k\)</span> outcomes, where <span class="arithmatex">\(k\)</span> selects fewer than all <span class="arithmatex">\(n\)</span> outcomes a
homogeneous pool benefits from <a href="https://rpg.stackexchange.com/a/166663/71245">Ilmari Karonen’s
optimization</a>, which appears
to scale geometrically with <span class="arithmatex">\(k\)</span> times some factor of <span class="arithmatex">\(n\)</span> (e.g., <span class="arithmatex">\(\log n\)</span>,
but I haven’t bothered to figure that out yet), such that—in observed
testing, at least—it is generally the fastest approach for <span class="arithmatex">\(k &lt; n\)</span>.</p>
<p>Where <span class="arithmatex">\(k = n\)</span>, we leverage the <a href="https://en.wikipedia.org/wiki/Permutation#Permutations_of_multisets"><em>multinomial
coefficient</em></a>,
which appears to scale generally with <span class="arithmatex">\(n\)</span>.</p>
<div class="arithmatex">\[
{{n} \choose {{{k}_{1}},{{k}_{2}},\ldots,{{k}_{m}}}}
= {\frac {{n}!} {{{k}_{1}}! {{k}_{2}}! \cdots {{k}_{m}}!}}
\]</div>
<p>We enumerate combinations with replacements, and then the compute the number
of permutations with repetitions for each combination. Consider <code class="highlight"><span class="n">n</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">(</span><span class="n">m</span><span class="p">))</span></code>. Enumerating combinations with replacements would yield all
unique rolls.</p>
<p><code class="highlight"><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="err">…</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="err">…</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="err">…</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="err">…</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="err">…</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="err">…</span><span class="p">,</span><span class="n">m</span><span class="p">),</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="err">…</span><span class="p">,</span> <span class="n">m</span><span class="p">))</span></code></p>
<p>To determine the count for a particular roll <code class="highlight"><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="err">…</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></code>, we
compute the multinomial coefficient for that roll and multiply by the scalar
<code class="highlight"><span class="n">H</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">H</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="err">…</span> <span class="o">*</span> <span class="n">H</span><span class="p">(</span><span class="n">m</span><span class="p">)[</span><span class="n">n</span><span class="p">]</span></code>. (See
<a href="https://www.lucamoroni.it/the-dice-roll-sum-problem/">this</a> for an in-depth
exploration of the topic.)</p>
<p>Further, this implementation attempts to optimize heterogeneous pools by
breaking them into homogeneous groups before computing the Cartesian product
of those sub-results. This approach allows homogeneous pools to be ordered
without duplicates, where heterogeneous ones offer no such guarantees.</p>
<p>As expected, this optimization allows the performance of arbitrary selection
from mixed pools to sit between that of purely homogeneous and purely
heterogeneous ones. Note, however, that all three appear to scale
geometrically in some way.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(</span><span class="mi">4</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="mf">4.32</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">74.6</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="mi">4</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
<span class="mf">12.9</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">27.4</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="mi">4</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mf">24.7</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">167</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="mi">4</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mf">53.2</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">187</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mf">25.9</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">94.9</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mi">56</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">111</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mi">117</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">637</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="mi">6</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mi">227</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">1.62</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="mf">4.2</span> <span class="n">µs</span> <span class="err">±</span> <span class="mi">14</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
<span class="mi">276</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">3.62</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mi">912</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">4.45</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">2</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mi">922</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">3.03</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mf">6.02</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">29.7</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mf">15.9</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">51.4</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mi">16</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">39</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mf">16.2</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">44.7</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>

<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="mf">4.23</span> <span class="n">µs</span> <span class="err">±</span> <span class="mf">20.4</span> <span class="n">ns</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">1</span><span class="p">)):</span>
<span class="mf">1.61</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">3.55</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mf">1.64</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">2.83</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mf">1.63</span> <span class="n">ms</span> <span class="err">±</span> <span class="mf">2.74</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="mi">000</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">2</span><span class="p">)):</span>
<span class="mf">61.2</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">122</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)):</span>
<span class="mf">65.1</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">271</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">4</span><span class="p">)):</span>
<span class="mf">67.2</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">233</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
<span class="p">(</span><span class="n">P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}),</span> <span class="n">H</span><span class="p">({</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">:</span> <span class="mi">1</span><span class="p">})))</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">5</span><span class="p">)):</span>
<span class="mf">70.4</span> <span class="n">ms</span> <span class="err">±</span> <span class="mi">533</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span> <span class="p">(</span><span class="n">mean</span> <span class="err">±</span> <span class="n">std</span><span class="o">.</span> <span class="n">dev</span><span class="o">.</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">runs</span><span class="p">,</span> <span class="mi">10</span> <span class="n">loops</span> <span class="n">each</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<p><details>
<summary>Source: <a href="https://github.com/posita/dyce/blob/latest/docs/assets/perf_rolls_with_counts.ipy"><code>perf_rolls_with_counts.ipy</code></a></summary></p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">from</span> <span class="nn">dyce</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">P</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">n</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">).h(slice(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)):&quot;</span><span class="p">)</span>
    <span class="o">%</span><span class="n">timeit</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="nb">print</span><span class="p">()</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="n">n</span><span class="nd">@P</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="o">*</span><span class="p">[</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">).h(slice(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)):&quot;</span><span class="p">)</span>
    <span class="o">%</span><span class="n">timeit</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="nb">print</span><span class="p">()</span>

<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
  <span class="n">p</span> <span class="o">=</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">H</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)])</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">-</span> <span class="mi">4</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">p</span><span class="si">}</span><span class="s2">).h(slice(</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">)):&quot;</span><span class="p">)</span>
    <span class="o">%</span><span class="n">timeit</span> <span class="n">p</span><span class="o">.</span><span class="n">h</span><span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

<span class="nb">print</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
</details></p>
</div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">rolls_with_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">which</span><span class="p">:</span> <span class="n">_GetItemT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an iterator yielding two-tuples (pairs) that, collectively, enumerate all</span>
<span class="sd">    possible outcomes for the pool. The first item in the two-tuple is a sorted</span>
<span class="sd">    sequence of the outcomes for a distinct roll. The second is the count for that</span>
<span class="sd">    roll. Outcomes in each roll are ordered least to greatest.</span>

<span class="sd">    If one or more arguments are provided, this methods selects subsets of outcomes</span>
<span class="sd">    for each roll. Outcomes in each roll are ordered from least (index ``#!python</span>
<span class="sd">    0``) to greatest (index ``#!python -1`` or ``#!python len(self) - 1``).</span>
<span class="sd">    Identifiers can be ``#!python int``s or ``#!python slice``s, and can be mixed</span>
<span class="sd">    for more flexible selections.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; from collections import Counter</span>

<span class="sd">    &gt;&gt;&gt; def accumulate_roll_counts(counter, roll_counts):</span>
<span class="sd">    ...   for roll, count in roll_counts:</span>
<span class="sd">    ...     counter[roll] += count</span>
<span class="sd">    ...   return counter</span>

<span class="sd">    &gt;&gt;&gt; p_6d6 = 6@P(6)</span>
<span class="sd">    &gt;&gt;&gt; every_other_d6 = accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(slice(None, None, -2))) ; every_other_d6</span>
<span class="sd">    Counter({(6, 4, 2): 4110, (6, 5, 3): 3390, (6, 4, 3): 3330, ..., (3, 3, 3): 13, (2, 2, 2): 7, (1, 1, 1): 1})</span>
<span class="sd">    &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(5, 3, 1)) == every_other_d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(*range(5, 0, -2))) == every_other_d6</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; accumulate_roll_counts(Counter(), p_6d6.rolls_with_counts(*(i for i in range(6, 0, -1) if i % 2 == 1))) == every_other_d6</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    One way to model the likelihood of achieving a “Yhatzee” (i.e., where five</span>
<span class="sd">    six-sided dice show the same face) on a single roll by checking rolls for where</span>
<span class="sd">    the least and greatest outcomes are the same.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p_5d6 = 5@P(6)</span>
<span class="sd">    &gt;&gt;&gt; yhatzee_on_single_roll = H(</span>
<span class="sd">    ...   (1 if roll[0] == roll[-1] else 0, count)</span>
<span class="sd">    ...   for roll, count</span>
<span class="sd">    ...   in p_5d6.rolls_with_counts()</span>
<span class="sd">    ... )</span>
<span class="sd">    &gt;&gt;&gt; print(yhatzee_on_single_roll.format(width=0))</span>
<span class="sd">    {..., 0: 99.92%, 1:  0.08%}</span>

<span class="sd">    ```</span>

<span class="sd">    !!! note &quot;In the general case, rolls may appear more than once.&quot;</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; sorted(P(H(2), H(3)).rolls_with_counts())</span>
<span class="sd">        [((1, 1), 1), ((1, 2), 1), ((1, 2), 1), ((1, 3), 1), ((2, 2), 1), ((2, 3), 1)]</span>

<span class="sd">        ```</span>

<span class="sd">        In the above, ``#!python (1, 2)`` appears a total of two times, each with</span>
<span class="sd">        counts of one.</span>

<span class="sd">        However, if the pool is homogeneous (meaning it only contains identical</span>
<span class="sd">        histograms), rolls (before selection) are not repeated. (See the note on</span>
<span class="sd">        implementation below.)</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; sorted((2@P(H((-1, 0, 1)))).rolls_with_counts())</span>
<span class="sd">        [((-1, -1), 1), ((-1, 0), 2), ((-1, 1), 2), ((0, 0), 1), ((0, 1), 2), ((1, 1), 1)]</span>

<span class="sd">        ```</span>

<span class="sd">        Either way, by summing and counting all rolls, we can confirm identity.</span>

<span class="sd">        ``` python</span>
<span class="sd">        &gt;&gt;&gt; d6 = H(6)</span>
<span class="sd">        &gt;&gt;&gt; d6avg = H((2, 3, 3, 4, 4, 5))</span>
<span class="sd">        &gt;&gt;&gt; p = 2@P(d6, d6avg)</span>
<span class="sd">        &gt;&gt;&gt; H((sum(roll), count) for roll, count in p.rolls_with_counts()) == p.h() == d6 + d6 + d6avg + d6avg</span>
<span class="sd">        True</span>

<span class="sd">        ```</span>

<span class="sd">    This method does not try to outsmart callers by (mis)interpreting selection</span>
<span class="sd">    arguments. It honors selection identifier order and any redundancy.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; p_d3_d4 = P(H(3), H(4))</span>
<span class="sd">    &gt;&gt;&gt; # Select the second, first, then second (again) elements</span>
<span class="sd">    &gt;&gt;&gt; sorted(p_d3_d4.rolls_with_counts(-1, 0, 1))</span>
<span class="sd">    [((1, 1, 1), 1), ((2, 1, 2), 1), ((2, 1, 2), 1), ..., ((4, 1, 4), 1), ((4, 2, 4), 1), ((4, 3, 4), 1)]</span>

<span class="sd">    ```</span>

<span class="sd">    Selecting the same outcomes, but in a different order is not immediately</span>
<span class="sd">    comparable.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; select_0_1 = sorted(p_d3_d4.rolls_with_counts(0, 1))</span>
<span class="sd">    &gt;&gt;&gt; select_1_0 = sorted(p_d3_d4.rolls_with_counts(1, 0))</span>
<span class="sd">    &gt;&gt;&gt; select_0_1 == select_1_0</span>
<span class="sd">    False</span>

<span class="sd">    ```</span>

<span class="sd">    Equivalence can be tested when selected outcomes are sorted.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; sorted_0_1 = sorted((sorted(roll), count) for roll, count in select_0_1)</span>
<span class="sd">    &gt;&gt;&gt; sorted_1_0 = sorted((sorted(roll), count) for roll, count in select_1_0)</span>
<span class="sd">    &gt;&gt;&gt; sorted_0_1 == sorted_1_0</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    They can also be summed and counted which is equivalent to calling the</span>
<span class="sd">    [``h`` method][dyce.p.P.h] with identical selection arguments.</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; summed_0_1 = H((sum(roll), count) for roll, count in select_0_1)</span>
<span class="sd">    &gt;&gt;&gt; summed_1_0 = H((sum(roll), count) for roll, count in select_1_0)</span>
<span class="sd">    &gt;&gt;&gt; summed_0_1 == summed_1_0 == p_d3_d4.h(0, 1) == p_d3_d4.h(1, 0)</span>
<span class="sd">    True</span>

<span class="sd">    ```</span>

<span class="sd">    !!! info &quot;About the implementation&quot;</span>

<span class="sd">        Enumeration is substantially more efficient for homogeneous pools than</span>
<span class="sd">        heterogeneous ones, because we are able to avoid the expensive enumeration</span>
<span class="sd">        of the Cartesian product using several techniques.</span>

<span class="sd">        Taking $k$ outcomes, where $k$ selects fewer than all $n$ outcomes a</span>
<span class="sd">        homogeneous pool benefits from [Ilmari Karonen’s</span>
<span class="sd">        optimization](https://rpg.stackexchange.com/a/166663/71245), which appears</span>
<span class="sd">        to scale geometrically with $k$ times some factor of $n$ (e.g., $\log n$,</span>
<span class="sd">        but I haven’t bothered to figure that out yet), such that—in observed</span>
<span class="sd">        testing, at least—it is generally the fastest approach for $k &lt; n$.</span>

<span class="sd">        Where $k = n$, we leverage the [*multinomial</span>
<span class="sd">        coefficient*](https://en.wikipedia.org/wiki/Permutation#Permutations_of_multisets),</span>
<span class="sd">        which appears to scale generally with $n$.</span>

<span class="sd">        $$</span>
<span class="sd">        {{n} \choose {{{k}_{1}},{{k}_{2}},\ldots,{{k}_{m}}}}</span>
<span class="sd">        = {\frac {{n}!} {{{k}_{1}}! {{k}_{2}}! \cdots {{k}_{m}}!}}</span>
<span class="sd">        $$</span>

<span class="sd">        We enumerate combinations with replacements, and then the compute the number</span>
<span class="sd">        of permutations with repetitions for each combination. Consider ``#!python</span>
<span class="sd">        n@P(H(m))``. Enumerating combinations with replacements would yield all</span>
<span class="sd">        unique rolls.</span>

<span class="sd">        ``#!python ((1, 1, …, 1), (1, 1, …, 2), …, (1, 1, …, m), …, (m - 1, m, …,</span>
<span class="sd">        m), (m, m, …, m))``</span>

<span class="sd">        To determine the count for a particular roll ``#!python (a, b, …, n)``, we</span>
<span class="sd">        compute the multinomial coefficient for that roll and multiply by the scalar</span>
<span class="sd">        ``#!python H(m)[a] * H(m)[b] * … * H(m)[n]``. (See</span>
<span class="sd">        [this](https://www.lucamoroni.it/the-dice-roll-sum-problem/) for an in-depth</span>
<span class="sd">        exploration of the topic.)</span>

<span class="sd">        Further, this implementation attempts to optimize heterogeneous pools by</span>
<span class="sd">        breaking them into homogeneous groups before computing the Cartesian product</span>
<span class="sd">        of those sub-results. This approach allows homogeneous pools to be ordered</span>
<span class="sd">        without duplicates, where heterogeneous ones offer no such guarantees.</span>

<span class="sd">        As expected, this optimization allows the performance of arbitrary selection</span>
<span class="sd">        from mixed pools to sit between that of purely homogeneous and purely</span>
<span class="sd">        heterogeneous ones. Note, however, that all three appear to scale</span>
<span class="sd">        geometrically in some way.</span>

<span class="sd">        ``` python</span>
<span class="sd">        --8&lt;-- &quot;docs/assets/perf_rolls_with_counts.txt&quot;</span>
<span class="sd">        ```</span>

<span class="sd">        &lt;details&gt;</span>
<span class="sd">        &lt;summary&gt;Source: &lt;a href=&quot;https://github.com/posita/dyce/blob/latest/docs/assets/perf_rolls_with_counts.ipy&quot;&gt;&lt;code&gt;perf_rolls_with_counts.ipy&lt;/code&gt;&lt;/a&gt;&lt;/summary&gt;</span>

<span class="sd">        ``` python</span>
<span class="sd">        --8&lt;-- &quot;docs/assets/perf_rolls_with_counts.ipy&quot;</span>
<span class="sd">        ```</span>
<span class="sd">        &lt;/details&gt;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">which</span><span class="p">:</span>
        <span class="n">i</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">_analyze_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">which</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rolls_with_counts_iter</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">_RollCountT</span><span class="p">]</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">((</span><span class="n">h</span><span class="p">,</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">hs</span><span class="p">))</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">hs</span> <span class="ow">in</span> <span class="n">groupby</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># Based on cursory performance analysis, calling the homogeneous</span>
            <span class="c1"># implementation directly provides about a 15% performance savings over</span>
            <span class="c1"># merely falling through to _rwc_heterogeneous_h_groups. Maybe</span>
            <span class="c1"># itertools.product adds significant overhead?</span>
            <span class="n">h</span><span class="p">,</span> <span class="n">hn</span> <span class="o">=</span> <span class="n">groups</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">assert</span> <span class="n">hn</span> <span class="o">==</span> <span class="n">n</span>

            <span class="c1"># Still in search of a better (i.e., more efficient) way:</span>
            <span class="c1"># &lt;https://math.stackexchange.com/questions/4173084/probability-distribution-of-k-1-k-2-cdots-k-m-selections-of-arbitrary-posi&gt;</span>
            <span class="k">if</span> <span class="n">i</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">:</span>
                <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="n">_rwc_homogeneous_n_h_using_partial_selection</span><span class="p">(</span>
                    <span class="n">n</span><span class="p">,</span>
                    <span class="n">h</span><span class="p">,</span>
                    <span class="n">i</span><span class="p">,</span>
                    <span class="c1"># This is just padding to allow for consistent indexing. They</span>
                    <span class="c1"># are deselected (i.e., not returned) below.</span>
                    <span class="n">fill</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">_rwc_homogeneous_n_h_using_partial_selection</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rolls_with_counts_iter</span> <span class="o">=</span> <span class="n">_rwc_heterogeneous_h_groups</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">sorted_outcomes_for_roll</span><span class="p">,</span> <span class="n">roll_count</span> <span class="ow">in</span> <span class="n">rolls_with_counts_iter</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">which</span><span class="p">:</span>
            <span class="n">taken_outcomes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">getitems</span><span class="p">(</span><span class="n">sorted_outcomes_for_roll</span><span class="p">,</span> <span class="n">which</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">taken_outcomes</span> <span class="o">=</span> <span class="n">sorted_outcomes_for_roll</span>

        <span class="k">yield</span> <span class="n">taken_outcomes</span><span class="p">,</span> <span class="n">roll_count</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="dyce.p.P.umap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">umap</span><span class="p">(</span><span class="n">op</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">P</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Shorthand for <code class="highlight"><span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span></code>. See the
<a class="autorefs autorefs-internal" href="#dyce.h.H.umap"><code>H.umap</code> method</a>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">&gt;&gt;&gt;</span> <span class="kn">import</span> <span class="nn">operator</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span> <span class="o">=</span> <span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">((</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__neg__</span><span class="p">)</span>
<span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">p_3d6</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="fm">__abs__</span><span class="p">)</span>
<span class="mi">3</span><span class="nd">@P</span><span class="p">(</span><span class="n">H</span><span class="p">({</span><span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</code></pre></div></td></tr></table></div>

          <details class="quote">
            <summary>Source code in <code>dyce/p.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@beartype</span>
<span class="k">def</span> <span class="nf">umap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="n">_UnaryOperatorT</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;P&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Shorthand for ``#!python P(*(h.umap(op) for h in self))``. See the</span>
<span class="sd">    [``H.umap`` method][dyce.h.H.umap].</span>

<span class="sd">    ``` python</span>
<span class="sd">    &gt;&gt;&gt; import operator</span>
<span class="sd">    &gt;&gt;&gt; p_3d6 = 3@P(H((-3, -1, 2, 4)))</span>
<span class="sd">    &gt;&gt;&gt; p_3d6.umap(operator.__neg__)</span>
<span class="sd">    3@P(H({-4: 1, -2: 1, 1: 1, 3: 1}))</span>
<span class="sd">    &gt;&gt;&gt; p_3d6.umap(operator.__abs__)</span>
<span class="sd">    3@P(H({1: 1, 2: 1, 3: 1, 4: 1}))</span>

<span class="sd">    ```</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">P</span><span class="p">(</span><span class="o">*</span><span class="p">(</span><span class="n">h</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">op</span><span class="p">)</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      <i>Copyright and other protections apply. Please see the accompanying <tt>LICENSE</tt> file for rights and restrictions governing use of this software. All rights not expressly waived or licensed are reserved. If that file is missing or appears to be modified from its original, then please contact the author before viewing or using this software in any capacity.</i>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.tabs.link", "navigation.foreach", "navigation.sections", "toc.integrate"], "search": "../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../assets/javascripts/bundle.220ee61c.min.js"></script>
      
        
          <script src="../js/site.js"></script>
        
      
        
          <script src="../js/mathjax.js"></script>
        
      
        
          <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        
      
        
          <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
      
    
  </body>
</html>